{"version":3,"file":"app.js","sources":["text.js","finder/templates/campaign.tpl.html!text","finder/Campaign.js","text!finder/templates/no-results.tpl.html","finder/ResultsView.js","finder/SolrAdapter.js","finder/templates/error.tpl.html!text","finder/FormView.js","finder/Finder.js","StripeForm.js","donate/Donate.js","revealer/Revealer.js","swapper/Swapper.js","../../bower_components/dosomething-modal/js/events.js","../../bower_components/dosomething-modal/js/modal.js","../../bower_components/dosomething-validation/js/events.js","../../bower_components/dosomething-validation/js/validation.js","images/ImageCrop.js","images/ImageCropPreview.js","images/ImageUploadBeta.js","text!images/templates/fallback-upload-interface.tpl.html","images/ImageUploadFallback.js","reportback/templates/reportback.tpl.html!text","reportback/Reportback.js","../../bower_components/neue/js/carousel.js","../../bower_components/neue/js/footnote.js","../../bower_components/neue/js/jump-scroll.js","../../bower_components/neue/js/menu.js","../../bower_components/neue/js/messages.js","../../bower_components/neue/js/scroll-indicator.js","../../bower_components/neue/js/tabs.js","../../bower_components/neue/js/main.js","campaign/SchoolFinder.js","campaign/ImageUploader.js","validators/auth.js","validators/reportback.js","validators/address.js","validators/donate.js","Analytics.js","tiles.js"],"names":["define","load","id","Error","require","$","_","campaignTplSrc","Campaign","data","defaults","title","description","url","staffPick","featured","extend","this","convert","prototype","newData","map","label","sm_field_call_to_action","bs_field_staff_pick","bs_sticky","ss_field_search_image_400x400","i","undefined","render","$wrapper","template","image","noResultsTplSrc","ResultsView","$container","$gallery","$blankSlateDiv","slots","maxSlots","start","init","paginateAction","clearFormAction","hide","$paginationLink","Drupal","t","on","event","preventDefault","showBlankSlate","show","showEmptyState","message","append","parseResults","clear","retrieved","result","response","docs","add","showPaginationLink","numFound","loading","showLink","remove","appendResults","setTo","toggleClass","checkInit","empty","campaign","find","unveil","style","opacity","window","solrResponse","SolrAdapter","throttleTimeout","baseURL","settings","dosomethingSearch","solrURL","collection","throttle","defaultQuery","fieldMap","cause","time","action-type","fieldMapInverse","responseData","invert","throttledQuery","checkedFields","offset","responseCallback","clearTimeout","setTimeout","query","clone","push","q","forOwn","fields","fieldGroup","isEmpty","param","join","powerset","generatePowerset","length","encodeURIComponent","xhr","abort","ajax","dataType","cache","jsonpCallback","buildQuery","success","error","errorType","jsonp","pos","bubble","params","ary","ps","j","len","concat","variations","errorTplSrc","FormView","$div","$searchButton","$fields","lastChanged","cssBreakpoint","queryCallback","click","$this","$parent","parents","$siblings","siblings","outerWidth","hasClass","addClass","removeClass","each","idx","element","field","prop","val","change","is","attr","animate","scrollTop","showErrorMessage","after","hasCheckedFields","hasChecked","filter","getCheckedFields","groupName","checked","index","e","disableFields","results","key","keyArr","split","value","$checkboxes","disabled","$checkbox","Finder","$formContainer","$resultsContainer","$blankSlate","queryOffset","displayResults","Stripe","StripeForm","$form","publishKey","parent","_this","setPublishableKey","ev","isValid","card","createToken","status","onFormSubmit","text","token","get","submit","$donateForm","Donate","stripeAPIPublishKey","dosomethingPayment","stripeAPIPublish","html","Revealer","$content","category","initialItems","stepItems","$button","step","steps","items","count","prepGalleryItems","detachContent","enableButton","detach","reattachContent","content","insertAfter","shift","slice","makeArray","splice","Swapper","$image","srcLarge","exchange","topics","subUid","publish","topic","args","subscribers","func","subscribe","toString","unsubscribe","m","jQuery","Modernizr","Events","modalReady","queuedModal","$document","document","$chrome","$modalContainer","$skipLink","$closeLink","$modal","closeable","isOpen","_addCloseButton","$el","type","skipForm","prepend","open","options","animated","closeButton","offsetTop","css","cssanimations","_cleanup","scrollOffset","close","parseInt","location","hash","one","_openHandler","href","_closeHandler","target","ready","$body","appendTo","DS","Modal","main","validations","prepareFields","$field","prepareLabel","validateField","$label","$innerLabel","force","callback","showValidationMessage","validation","validationTrigger","isFormField","fieldValue","matchFieldValue","fn","$matchField","registerValidation","name","registerValidationFunction","v","fieldMessageHeight","$fieldLabel","$fieldValidation","$fieldMessage","fieldLabelHeight","height","suggestion","full","domain","closest","trigger","disableFormSubmit","$submitButton","enableFormSubmit","tag","isValidated","$validationFields","validatedFields","validatedResults","scrolledToError","top","string","secondString","done","Validation","Validations","xInitPos","yInitPos","offsetLeft","initialCropBoxHeight","initialCropBoxWidth","previewImageWidth","previewImageHeight","$previewImage","origImage","resizeState","dragState","$cropBox","resizeClickPositionX","resizeClickPositionY","scale","degrees","minThreshold","getCoords","coords","eventType","originalEvent","targetTouches","pageX","pageY","getMinimumSize","getCropBoxSize","width","minimum","cropBoxSize","orientation","halfWidth","halfHeight","getTranslateDifference","translateDiff","dragCropBoxInit","resizeCropBoxInit","croppingReset","off","cropBoxHeight","cropBoxWidth","cropBoxTop","cropBoxLeft","moveRight","moveDown","withinTopBounds","withinLeftBounds","resizeHorizontal","resizeVertical","withinHeightBounds","withinWidthBounds","cropBoxSizeAllowed","increasingSize","decreasingSize","setupCrop","$cropContainer","insertBefore","left","Math","floor","rotateImage","transform","populateFields","$cropX","$cropY","$cropWidth","$cropHeight","$cropRotation","$captionField","caption","cropValues","round","outerHeight","dsCropperInit","wrap","$rotateButton","$cropPreview","$reportbackSubmissions","$reportbackUploadBtn","firstSubmission","getCropPreviewValues","imageWidth","imageHeight","cropPreviewSize","horizontalScale","verticalScale","newWidth","newHeight","x","y","setUpCropPreview","$lastestSubmission","$reportbackSubmissionsList","submissionCount","cropPreview","src","prependTo","cropPreviewValues","$reportbackCaption","ImageCrop","ImageCropPreview","ImageUploadBeta","$uploadButton","$cropModal","$reportbackForm","$imageForm","$imageCaption","$cropButton","$imagePreview","imageValues","cropEnabled","dsReportback","readyToSave","files","FileReader","fr","readAsArrayBuffer","onload","blob","getStrippedBlob","urlCreator","URL","webkitURL","imageUrl","createObjectURL","Image","validImage","$errorMsg","openModal","previewImage","validateCaption","engageImageCrop","$error","resetFileField","getCropValues","createEditButton","enableSubmit","$input","replaceWith","$editButton","before","resizeImage","containerMaxWidth","$imageContainer","$preview","fileReaderResult","generatedBlob","dataView","DataView","recess","pieces","getUint16","app1","byteLength","newPieces","forEach","Blob","fallbackUploadTplSrc","ImageUploadFallback","component","$fileInterface","$indicator","fileName","classes","container","activateInput","getFileName","updateFileSelection","buildUpatedComponent","emptyContainer","path","indexOf","substring","file","$markup","insertUpdatedComponent","reportbackTplSrc","Reportback","$initialGallery","$extendedGallery","$viewMoreContainer","$viewMoreButton","$spinner","apiUrl","nid","itemsPrefetched","itemsTotal","bundleSize","requestSize","inventory","currentIndex","galleryInDom","reportbackContainer","$reportbackWrapper","buildApiUrl","enableViewMore","enableResponsive","filereader","imageUploadInit","appendEntries","inventoryIndex","end","$cluster","$images","outOfStock","insertGallery","disableViewMore","isLargerMedia","evaluateInventory","debounce","lowInventory","request","quantity","beforeSend","templatize","fail","always","rbid","isListItem","markup","decrementCounter","counter","totalCount","incrementCounter","showCurrentSlide","direction","$buttons","wrapInner","slideToggle","$collapsible","matchMedia","matches","messageClose","attachCloseButton","$messages","slideUp","sortedIndex","array","low","high","mid","binarySearch","prepareIndicator","$link","$linkTarget","links","link","preparePage","updateScrollIndicators","newIndicator","newIndicatorParents","parentsUntil","oldIndicatorParents","oldIndicator","not","wait","context","timeout","previous","later","Date","apply","now","leading","remaining","arguments","trailing","throttledScroll","$tabs","$tabMenuLinks","first","selection","tab","NEUE","Carousel","Footnote","JumpScroll","Menu","Messages","ScrollIndicator","Tabs","shouldValidateForm","resultTpl","getResults","state","limit","endpoint","dosomethingUser","schoolFinderAPIEndpoint","meta","more_results","canShowMore","initializeSchoolFinder","$schoolSignupForm","$stateField","$schoolIDField","$schoolSearchField","$schoolSearchResults","$notAffiliatedField","$notAffiliatedConfirmationMessage","savedStateFieldState","getResultsThrottled","stateSelected","toggle","focus","res","moreAvailable","$schoolID","prepareImageUploadUI","$context","$imageUploads","$caption","submittedImage","el","$uploadBtn","$imgPreview","$fileName","replace","test","reader","readAsDataURL","onloadend","$proveItSection","isValidEmailSyntax","email","toUpperCase","match","lastChar","validateNotBlank","failure","mailcheck","@name","birthday","birthMonth","birthDay","birthYear","format","dsValidation","dateFormat","endDates","birthDate","age","getFullYear","getMonth","getDate","@age","run","domains","suggested","s","numberWithoutFormatting","isValidFormat","sanitizedNumber","allRepeatingDigits","trimmedString","requiredValidator","@fname","@lname","@state","$sorryError","$networkError","addressFieldData","serializeArray","sorry","slideDown","hasFieldErrors","hasOwnProperty","$fieldEl","$checked","isDigit","isValidCVV","isValidMonth","isValidYear","validateDigit","validateCreditCardNumber","found","cardTypes","numberPattern","validateCvv","validateExpMonth","validateExpYear","Visa","Mastercard","AmericanExpress","DinersClub","Discover","JCB","_gaq","replaceVideoWithImage","poster","navigator","userAgent","fixedsticky","$campaignFinderForm","$results","$revealGalleries","galleryList","gallery","$tiles","isMosaicGallery","$mosaicGalleries","swappedImagesList","$featureTile","$reportback"],"mappings":"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","sourcesContent":["define('text',{load: function(id){throw new Error(\"Dynamic load not allowed: \" + id);}});\n","\ndefine('text!finder/templates/campaign.tpl.html',[],function () { return '<li>\\n<article class=\"tile\">\\n  <a class=\"wrapper\" href=\"<%= url %>\">\\n    <% if(staffPick) {  %><div class=\"tile__flag -staff-pick\"><%= Drupal.t(\"Staff Pick\") %></div><% } %>\\n    <div class=\"tile__meta\">\\n      <h1 class=\"tile__title\"><%= title %></h1>\\n      <p class=\"tile__tagline\"><%= description %></p>\\n    </div>\\n    <img src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"<%= image %>\">\\n  </a>\\n</article>\\n</li>\\n';});\n\n","define('finder/Campaign',['require','jquery','lodash','text!finder/templates/campaign.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n  var campaignTplSrc =  require(\"text!finder/templates/campaign.tpl.html\");\n\n  /**\n   * Campaign JS object representation\n   * @param {Object} data The raw campaign data\n   */\n  var Campaign = function (data) {\n    // Default values for a newly created campaign\n    var defaults = {\n      title: \"\",\n      description: \"\",\n      url: \"#\",\n      staffPick: false,\n      featured: false\n    };\n\n    // Merge the campaign object from data with the defaults into\n    // this campaign object\n    $.extend(this, defaults, this.convert(data));\n  };\n\n  /**\n   * Convert fields from the Solr results to relevant local, friendlier\n   * field names.\n   *\n   * @param  {Object} data The raw campaign object\n   *\n   * @return {Object} The new data translated and ignoring\n   */\n  Campaign.prototype.convert = function (data) {\n    var newData = {};\n    var map = {\n      \"label\": \"title\",\n      \"sm_field_call_to_action\": \"description\",\n      \"url\": \"url\",\n      \"bs_field_staff_pick\": \"staffPick\",\n      \"bs_sticky\": \"featured\",\n      \"ss_field_search_image_400x400\": \"image\"\n    };\n\n    // Only populate fields that we care about from the map.\n    for (var i in data) {\n      if (map[i] !== undefined) {\n        newData[map[i]] = data[i];\n      }\n    }\n\n    return newData;\n  };\n\n  /**\n   * Render a campaign\n   * @return {jQuery} The jQuery object that is the rendered representation of this Campaign\n   */\n  Campaign.prototype.render = function () {\n    var $wrapper = _.template(campaignTplSrc, {\n      \"image\": this.image,\n      \"staffPick\": this.staffPick,\n      \"featured\": this.featured,\n      \"title\": this.title,\n      \"description\": this.description,\n      \"url\": this.url\n    });\n\n    return $wrapper;\n  };\n\n  return Campaign;\n});\n\n","\ndefine('text!finder/templates/no-results.tpl.html',[],function () { return '<div class=\"no-result\">\\n  <div class=\"wrapper\">\\n    <p class=\"message\"><%= Drupal.t(\"Oh snap! We\\'ll work on that.\") %></p>\\n    <p>\\n      <a id=\"reset-filters\" href=\"/\">\\n        <%= Drupal.t(\"Want to try another combo?\") %>\\n      </a>\\n    </p>\\n  </div>\\n</div>\\n';});\n\n","define('finder/ResultsView',['require','jquery','lodash','finder/Campaign','text!finder/templates/no-results.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n  var Campaign = require(\"finder/Campaign\");\n  var noResultsTplSrc = require(\"text!finder/templates/no-results.tpl.html\");\n\n  /**\n   * ResultsView manages search results from Finder\n   * @type {Object}\n   */\n  var ResultsView = {\n    // The container element where the results go\n    $container: null,\n\n    // The gallery located in the container\n    $gallery: $(\"<ul class='gallery -quartet -mosaic'></ul>\"),\n\n    // The div that is shown if no filters are selected\n    $blankSlateDiv: null,\n\n    // How many slots are currently used. Full-height = 2, half-height = 1\n    slots: 0,\n\n    // How many slots are we allowing\n    maxSlots: 8,\n\n    // For tracking what page we're on\n    start: 0,\n\n    /**\n     * Construct the cloneables and set the parent div where the results go\n     * @param  {jQuery} $container        The container element where the results will live\n     * @param  {jQuery} $blankSlateDiv    The div containing initial pre-filtered state\n     * @param  {function} paginateAction  Function to query next page of results.\n     */\n    init: function ($container, $blankSlateDiv, paginateAction, clearFormAction) {\n      ResultsView.$container = $container;\n      ResultsView.$container.hide();\n\n\n      ResultsView.$paginationLink = $(\n        \"<div class='pagination-link'><a href='#' class='secondary js-finder-show-more'>\" +\n          Drupal.t(\"Show More\") +\n        \"</a></div>\"\n      );\n\n      $(\"body\").on(\"click\", \".js-finder-show-more\", function(event) {\n        event.preventDefault();\n        paginateAction(ResultsView.start);\n      });\n\n      ResultsView.$blankSlateDiv = $blankSlateDiv;\n\n      ResultsView.$container.on(\"click\", \"#reset-filters\", function(event) {\n        event.preventDefault();\n\n        ResultsView.showBlankSlate();\n\n        // TODO: Maybe allow for FormView.clear() to be called from ResultsView so\n        // it doesn't have to be passed in as an argument to the init().\n        clearFormAction();\n      });\n    },\n\n    /**\n     * Shows the blank slate div (initial state).\n     */\n    showBlankSlate: function() {\n      ResultsView.$container.hide();\n      ResultsView.$blankSlateDiv.show();\n    },\n\n    /**\n     * Shows the empty slate div (no results state).\n     */\n    showEmptyState: function() {\n      var message = _.template(noResultsTplSrc);\n\n      ResultsView.$container.append(message);\n    },\n\n    /**\n     * Replace current results with new data\n     * @param  {Object} data The raw data from the query\n     */\n    parseResults: function (data) {\n      // Remove the old results\n      ResultsView.clear();\n\n      if (data.retrieved > 0) {\n        // Results view cleared, and since we have results add the gallery into the container.\n        ResultsView.$container.append(ResultsView.$gallery);\n\n        // Loopy loop! (Like me after drinking coffeeeee)\n        for (var i in data.result.response.docs) {\n          ResultsView.add(new Campaign(data.result.response.docs[i]));\n        }\n\n        // There are more results than we've shown so far, add \"Show More\" button\n        ResultsView.showPaginationLink(data.result.response.numFound > ResultsView.start);\n      } else {\n        ResultsView.showEmptyState();\n      }\n\n      // Hey! We're done loading! I guess we can let the users know we're done.\n      ResultsView.loading(false);\n    },\n\n    /**\n     * Show or hide pagination link.\n     * @param {boolean} showLink    Should link be shown?\n     */\n    showPaginationLink: function(showLink) {\n      ResultsView.$paginationLink.remove();\n\n      if(showLink) {\n        ResultsView.$container.append(ResultsView.$paginationLink);\n        ResultsView.$paginationLink.show();\n      }\n    },\n\n    /**\n     * Append to current results with new data.\n     * @param  {Object} data The raw data from the query\n     */\n    appendResults: function (data) {\n      // Add those results to the page!\n      for (var i in data.result.response.docs) {\n        ResultsView.add(new Campaign(data.result.response.docs[i]));\n      }\n\n      // There are more results than we've shown so far, add \"Show More\" button\n      ResultsView.showPaginationLink(data.result.response.numFound > ResultsView.start);\n\n      // Hey! We're done loading! I guess we can let the users know we're done.\n      ResultsView.loading(false);\n    },\n\n    /**\n     * Toggle the loading indicator for the results div\n     * @param  {boolean} setTo Should I stay or should I go? If I go there will be trouble...or clicking.\n     */\n    loading: function (setTo) {\n      // Allow the function to be called without a parameter, since X.loading() would seem\n      // to be a logical call.\n      if (setTo === undefined) {\n        setTo = true;\n      }\n\n      // If we're loading, add a class to the results div. Otherwise, remove it.\n      ResultsView.$container.append(\"<div class='spinner'></div>\");\n      ResultsView.$container.toggleClass(\"loading\", setTo);\n    },\n\n    /**\n     * Have we run the init method?\n     */\n    checkInit: function () {\n      if (ResultsView.$container === null) {\n        // Nope. I'm gonna vomit...\n        throw Drupal.t(\"Error: ResultsView is not initialized.\");\n      }\n\n      // Yup.\n    },\n\n    /**\n     * Remove the current results and reboot this object.\n     */\n    clear: function () {\n      ResultsView.checkInit();\n      ResultsView.$container.empty();\n      ResultsView.$gallery.empty();\n\n      ResultsView.$container.show();\n      ResultsView.$blankSlateDiv.hide();\n\n\n      ResultsView.slots = 0;\n      ResultsView.start = 0;\n    },\n\n    /**\n     * Add a campaign to the results\n     * @param {Campaign} campaign The campaign to add\n     */\n    add: function (campaign) {\n      // Make sure we've initialized ourself\n      ResultsView.checkInit();\n\n      // If we're full, screw it.\n      // if (ResultsView.slots === ResultsView.maxSlots) {\n      //   return;\n      // }\n\n      // Render campaign object and append to the gallery\n      ResultsView.$gallery.append(campaign.render());\n      ResultsView.slots++;\n\n      // Track where we are for paging\n      ResultsView.start++;\n\n      // Lazy-load in images\n      ResultsView.$container.find(\"img\").unveil(200, function() {\n        $(this).load(function() {\n          this.style.opacity = 1;\n        });\n      });\n    }\n  };\n\n  return ResultsView;\n});\n\n","define('finder/SolrAdapter',['require','jquery','lodash'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n\n  // Create a callback function for caching the jsonp response.\n  /* jshint ignore:start */\n  window.solrResponse = function(response) {};\n  /* jshint ignore:end */\n\n  /**\n   * SolrAdapter acts as a mediator between Solr and the Campaign Finder.\n   *\n   * @type {Object}\n   */\n  var SolrAdapter = {\n    /*\n     * Sets how long after a user interaction we run the Solr query. As the\n     * name implies, this is a throttling mechanism that prevents the browser\n     * from pinging Solr every...single...time...a checkbox is changed.\n     **/\n    throttleTimeout: 400,\n\n    /*\n     * Configure this too. What's the base URL of the Solr server that you want\n     * the browser pinging? And what collection?\n     **/\n    baseURL: Drupal.settings.dosomethingSearch.solrURL,\n    collection: Drupal.settings.dosomethingSearch.collection,\n\n    // The current throttle timeout identifier\n    throttle: null,\n\n    // This would be awesome with an object key:value, but Solr allows multiple of the same key\n    defaultQuery: [\n      \"fq=-sm_field_campaign_status:(closed) bundle:[campaign TO campaign_group]\",\n      //\"fq=ss_field_search_image:[* TO *]\",\n      \"wt=json\",\n      \"indent=false\",\n      \"facet=true\",\n      \"facet.field=fs_field_active_hours\",\n      \"facet.field=im_field_cause\",\n      \"facet.field=im_field_action_type\",\n      // TODO: un-hard-code the rows\n      \"rows=8\",\n      \"fl=label,tid,im_vid_1,sm_vid_Action_Type,tm_vid_1_names,im_field_cause,im_vid_2,sm_vid_Cause,tm_vid_2_names,im_field_tags,im_vid_5,sm_vid_Tags,tm_vid_5_names,fs_field_active_hours,sm_field_call_to_action,bs_field_staff_pick,ss_field_search_image_400x400,ss_field_search_image_720x720,url\"\n    ],\n\n    // Map the input field names to the Solr query fields\n    fieldMap: {\n      \"cause\": \"im_field_cause\",\n      \"time\": \"fs_field_active_hours\",\n      \"action-type\": \"im_field_action_type\"\n    },\n\n    // Inverse mapping of fieldMap (duhhh)\n    fieldMapInverse: {},\n\n\n    // Container for Ajax response data\n    responseData: null,\n\n    /**\n     * Initialize the SolrAdapter.\n     */\n    init: function() {\n      // Create an inverse mapping so we can go from Solr field name to local field name\n      SolrAdapter.fieldMapInverse = _.invert(SolrAdapter.fieldMap);\n    },\n\n    /**\n     * Run the query after a specified timeout.\n     *\n     * @param checkedFields      Array of fields selected in the interface.\n     * @param offset             Offset to start results from (used for pagination).\n     * @param responseCallback   Function called when query successfully completes.\n     */\n    throttledQuery: function(checkedFields, offset, responseCallback) {\n      // Cancel the current pending query and set a new one\n      clearTimeout(SolrAdapter.throttle);\n\n      // Set a timeout so we don't immediately ping the Solr server\n      SolrAdapter.throttle = setTimeout(function() {\n        SolrAdapter.query(checkedFields, offset, responseCallback);\n      }, SolrAdapter.throttleTimeout);\n    },\n\n    /**\n     * Run the query against the Solr server\n     *\n     * @param checkedFields      Array of fields selected in the interface.\n     * @param offset             Offset to start results from (used for pagination).\n     * @param responseCallback   Function called when query successfully completes.\n     */\n    query: function (checkedFields, offset, responseCallback) {\n      /**\n       * A clone of the default query so we don't modify it directly\n       * @type {Array}\n       */\n      var query = _.clone(SolrAdapter.defaultQuery);\n      query.push(\"start=\" + offset);\n\n      /**\n       * The \"q\" parameter passed to Solr\n       * @type {Array}\n       */\n      var q = [];\n\n      _.forOwn(checkedFields, function(fields, fieldGroup) {\n        // Don't build parameter if we're not sorting by anything in this field group.\n        if( !_.isEmpty(fields) ) {\n          // Build a param query\n          var param = \"(\" + fields.join(\") OR (\") + \")\";\n\n          /*\n           * Use a powerset to weight items. For example, given:\n           *   ☑ Animals\n           *   ☑ Disasters\n           * We should weight results that are animals AND disasters before results\n           * that are animals OR disasters.\n           **/\n          var powerset = SolrAdapter.generatePowerset(fields);\n          if (powerset.length) {\n            param += \" OR \" + powerset;\n          }\n\n          // Push the newly built parameter onto the q parameter\n          q.push(SolrAdapter.fieldMap[fieldGroup] + \":\" + \"(\" + encodeURIComponent(param) + \")\");\n        }\n      });\n\n      // If we're already running an AJAX request, cancel it\n      if (SolrAdapter.xhr) {\n        SolrAdapter.xhr.abort();\n      }\n\n      // Store the AJAX request locally\n      SolrAdapter.xhr = $.ajax({\n        dataType: \"jsonp\",\n        cache: true,\n        jsonpCallback: \"solrResponse\",\n        url: SolrAdapter.buildQuery(query, q),\n        success: function (data) {\n          responseCallback({\n            result: data,\n            retrieved: data.response.docs.length,\n          });\n        },\n        error: function(data, errorType) {\n          responseCallback({\n            result: false,\n            error: errorType\n          });\n        },\n        // We use jsonp for X-domain compatibility\n        jsonp: \"json.wrf\"\n      });\n    },\n\n    /**\n     * Build a Solr query based on a base query string (what comes after the ?)\n     * and a \"q\" which goes into the \"q=\" part of said query string.\n     *\n     * @param  {String} query The query string\n     * @param  {String} q     The string for concatting into the q= parameter\n     *\n     * @return {String} The entire URL to query against\n     */\n    buildQuery: function (query, q) {\n      // Add \"q=\" to the query array, and keep track of its position because we\"re going\n      // to need to modify it (less memory!)\n      var pos = query.push(\"q=\") - 1;\n\n      // Add a function query to bubble staff picks, sponsored, and high season to the top.\n      var bubble = \"_query_:\\\"{!func}scale(is_bubble_factor,0,100)\\\" AND \";\n\n      if (q.length > 0) {\n        // If there is a query, join that sucker together\n        if (q.length === 1) {\n          query[pos] = \"q=\" + bubble + q[0];\n        } else {\n          query[pos] = \"q=\" + bubble + \"(\" + q.join(\") AND (\") + \")\";\n        }\n      } else {\n        query[pos] = bubble;\n      }\n\n      // Join the query array together as a URL query string\n      query = query.join(\"&\");\n\n      return SolrAdapter.baseURL + SolrAdapter.collection + \"/select?\" + query;\n    },\n\n    /**\n     * This one's fun! We want to generate power sets so we can weight results in a search.\n     *\n     * Instead of reading the code, here's an example!\n     *\n     * [a, b, c]\"s powerset+weight is:\n     * - []             IGNORED (i=0)\n     * - [a]            IGNORED (length=1)\n     * - [b]            IGNORED (length=1)\n     * - [c]            IGNORED (length=1)\n     * - (a AND b)      ^200\n     * - (b AND c)      ^200\n     * - (a AND b AND c)^300\n     *\n     *\n     * @param  {Array} params Parameters to powerset-ize\n     *\n     * @return {String} A powerset-ized query string joined by OR\n     */\n    generatePowerset: function (params) {\n      // Create a powerset\n      // See: http://rosettacode.org/wiki/Power_set#JavaScript\n      function powerset(ary) {\n        var ps = [[]];\n        for (var i=0; i < ary.length; i++) {\n          for (var j = 0, len = ps.length; j < len; j++) {\n            ps.push(ps[j].concat(ary[i]));\n          }\n        }\n        return ps;\n      }\n\n      // Generate the powerset\n      var variations = powerset(params);\n\n      // The placeholder query\n      var q = [];\n\n      // Loop through and build the string query\n      for (var i = 1; i < variations.length; i++) {\n        if (variations[i].length > 1) {\n          // Generate a string of format: ((a) AND (b) AND (c OR d))^X\n          // We need the second set of parenthesis beacuse some parameters are in the format\n          // \"c OR d\" or \"[* TO 2]\"\n          q.push(\"((\" + variations[i].join(\") AND (\") + \"))^\" + (100*variations[i].length));\n        }\n      }\n\n      return q.join(\" OR \");\n    }\n  };\n\n  return SolrAdapter;\n});\n\n","\ndefine('text!finder/templates/error.tpl.html',[],function () { return '<div class=\"messages error\">\\n  <%= Drupal.t(\"Ooof! We\\'re not sure what\\'s up? Maybe it\\'s us, or it could be your internet connection. Want to try again in a few minutes?\") %>\\n</div>\\n';});\n\n","define('finder/FormView',['require','jquery','lodash','finder/ResultsView','finder/SolrAdapter','text!finder/templates/error.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n  var ResultsView = require(\"finder/ResultsView\");\n  var SolrAdapter = require(\"finder/SolrAdapter\");\n  var errorTplSrc = require(\"text!finder/templates/error.tpl.html\");\n\n  /**\n   * FormView manages the filter form for Finder\n   * @type {Object}\n   */\n  var FormView = {\n    // The div where the form goes\n    $div: null,\n\n    // <button> that mobile users click to initiate the search\n    $searchButton: null,\n\n    // The field groups that contain the checkmarks\n    $fields: {},\n\n    // The last field group that was changed (by name)\n    lastChanged: null,\n\n    // TODO: Can we get this from CSS somewhere instead so it's not hard-coded?\n    cssBreakpoint: 768,\n\n    /**\n     * Construct the cloneables and set the parent div where the results go\n     * @param  {jQuery} $div The div where the results will live\n     */\n    init: function ($div, queryCallback) {\n      FormView.$div = $div;\n\n      // Prepare toggles\n      $div.find(\"[data-toggle]\").click(function () {\n        var $this = $(this),\n          toggleClass = $this.data(\"toggle\"),\n          $parent = $this.parents(\".\" + toggleClass),\n          $siblings = $parent.siblings();\n\n        $parent.toggleClass(\"open\");\n\n        // Need to treat siblings slightly differently to safeguard when going from mobile to desktop.\n        if ($(window).outerWidth() >= FormView.cssBreakpoint) {\n          if ($parent.hasClass(\"open\")) {\n            $siblings.addClass(\"open\");\n          } else {\n            $siblings.removeClass(\"open\");\n          }\n        }\n      });\n\n      // Store the inputs so we can access them later\n      FormView.$fields.cause = $div.find(\"input[name='cause']\");\n      FormView.$fields.time = $div.find(\"input[name='time']\");\n      FormView.$fields[\"action-type\"] = $div.find(\"input[name='action-type']\");\n\n      // Hook up to the DOM\n      FormView.$searchButton = $div.find(\".campaign-search\");\n\n      // Loop through each field selector\n      // @TODO This is tightly coupled.\n      _.each(FormView.$fields, function(fieldGroup) {\n        // For each field selector, we need to add a Facet query so we can get counts to\n        // disable the checkbox.\n        fieldGroup.each(function(idx, element) {\n          /**\n           * The Solr field name that we're going to query against\n           * @type {String}\n           */\n          var field = SolrAdapter.fieldMap[$(element).prop(\"name\")];\n\n          /**\n           * The value of the field that we're passing in to the query\n           * @type {String}\n           */\n          var val = $(element).val();\n\n          // Add the facet query\n          SolrAdapter.defaultQuery.push(\"facet.query=\" + field + \":\" + val);\n        });\n      });\n\n      // Now attach events:\n      _.each(FormView.$fields, function(fieldGroup) {\n        // Attach ourselves to the \"change\" event on the input fields\n        fieldGroup.change(function () {\n          // check this guy\n          $(this).parents(\"li\").toggleClass(\"checked\", $(this).is(\":checked\"));\n\n          // Save the last checkbox that we checked so we don\"t disable any of\n          // those fields if we\"re trying to select multiple\n          FormView.lastChanged = $(this).attr(\"name\");\n\n          // If we're not on mobile...\n          queryCallback();\n        });\n      });\n\n      // Search button appears on mobile in lieu of live filtering\n      FormView.$searchButton.click(function () {\n        queryCallback();\n        $(\"html,body\").animate({\n          scrollTop: ResultsView.$div.offset().scrollTop\n        }, 1000);\n      });\n    },\n\n    /**\n     * Have we run the init method?\n     */\n    checkInit: function () {\n      if (FormView.$div === null) {\n        // Nope. I'm gonna vomit...\n        throw Drupal.t(\"Error: FormView is not initialized.\");\n      }\n\n      // Yup.\n    },\n\n\n    /**\n     * Shows an error message for network issues\n     **/\n    showErrorMessage: function() {\n      var message = _.template(errorTplSrc);\n\n      if ($(\".error\").length < 1) {\n        FormView.$div.parents(\".finder--form\").after(message);\n      }\n\n    },\n\n\n    /**\n     * Returns Boolean if any fields are checked\n     **/\n    hasCheckedFields: function() {\n      var hasChecked = false;\n\n      // Loop through each of the field groups\n      _.each(FormView.$fields, function(fieldGroup) {\n        if (fieldGroup.filter(\":checked\").length > 0) {\n          hasChecked = true;\n        }\n      });\n\n      return hasChecked;\n    },\n\n    /**\n     * Returns an object with arrays of checked fields grouped by fieldGroup.\n     **/\n    getCheckedFields: function() {\n      var checkedFields = [];\n\n      // Loop through each of the field groups\n      _.each(FormView.$fields, function(fieldGroup, groupName) {\n        var checked = fieldGroup.filter(\":checked\");\n        checkedFields[groupName] = [];\n\n        // Only add this to the query if there are fields checked in this field group\n        if (checked.length > 0) {\n          // For each checked box, add it to the search query\n          checked.each(function (index, e) {\n            checkedFields[groupName].push($(e).val());\n          });\n        }\n      });\n\n      return checkedFields;\n    },\n\n\n    /**\n     * Disable fields that have no results available for the given selection\n     *\n     * @param  {Object} results The Solr facet_queries result\n     */\n    disableFields: function(results) {\n      // Make sure we've initialized ourself\n      FormView.checkInit();\n\n      // @TODO: This is super inefficient. We should be storing state in memory\n      // rather than in the DOM, and then rendering the form based on that state.\n\n      // for each of the facet queries\n      _.each(results, function(query, key) {\n        // Solr returns results in the format field_label:count instead of a nice\n        // associative array. :( Let\"s parse that out.\n        var keyArr = key.split(\":\");\n        var field = keyArr[0],\n            value = keyArr[1];\n\n        // If we've checked something in this group, disable 'em all. Otherwise, use facets\n        // to disable impossible choices.\n        var $checkboxes = $(\"input[name='\" + SolrAdapter.fieldMapInverse[field] + \"']\");\n\n        if( !_.isEmpty($checkboxes.filter(\":checked\")) ) {\n          $checkboxes.filter(\":not(:checked)\").prop(\"disabled\", true);\n          $checkboxes.filter(\":not(:checked)\").parents(\"li\").addClass(\"disabled\");\n        } else {\n          // Should we disable this field? Whelp, if there are no results, the answer is yes!\n          var disabled = results[key] === 0;\n          var $checkbox = $checkboxes.filter(\"[value='\" + value + \"']\");\n\n          // Set the disabled attribute if we need to (note: disabled is a variable!)\n          $checkbox.prop(\"disabled\", disabled);\n\n          if (disabled) {\n            // Let\"s uncheck it if we can't select it. It would be confusing otherwise.\n            $checkbox.prop(\"checked\", !disabled);\n\n            // And add a class so we can make it look purdy.\n            $checkbox.parents(\"li\").addClass(\"disabled\");\n          } else {\n            // Oh, hey! It's re-enabled! Let\"s make it look purdier than it was.\n            $checkbox.parents(\"li\").removeClass(\"disabled\");\n          }\n        }\n      });\n    },\n\n    /**\n     * Remove the current results and reboot this object.\n     */\n    clear: function() {\n      //FormView.checkInit();\n      _.each(FormView.$fields, function(fieldGroup) {\n        var disabled = fieldGroup.filter(\":disabled\");\n        if (disabled) {\n          fieldGroup.prop(\"disabled\", false)\n            .parents(\"li\").removeClass(\"disabled\");\n        }\n      });\n    }\n  };\n\n  return FormView;\n});\n\n","define('finder/Finder',['require','finder/FormView','finder/ResultsView','finder/SolrAdapter'],function(require) {\n  \"use strict\";\n\n  var FormView = require(\"finder/FormView\");\n  var ResultsView = require(\"finder/ResultsView\");\n  var SolrAdapter = require(\"finder/SolrAdapter\");\n\n  /**\n   * Finder manages the search action\n   *\n   * @type {Object}\n   */\n  var Finder = {\n\n    /**\n     * Initialize the Campaign Finder and, by extension, the Campaign Results handler\n     *\n     * @param  {JQuery} $formContainer       The div that the filters will be shown in\n     * @param  {JQuery} $resultsContainer    The container element that the results will be injected into\n     * @param  {JQuery} $blankSlate          The div that will be shown when no filter is selected\n     */\n    init: function ($formContainer, $resultsContainer, $blankSlate) {\n      // Initialize the ResultsView\n      FormView.init($formContainer, Finder.query);\n      ResultsView.init($resultsContainer, $blankSlate, Finder.query, FormView.clear);\n\n      // Prepare the Solr adapter\n      SolrAdapter.init();\n    },\n\n    /**\n     * Run the query against the Solr server\n     * @param  {int} offset   Offset to start results at (used for pagination).\n     */\n    query: function(offset) {\n      var queryOffset = offset || 0;\n      var checkedFields = FormView.getCheckedFields();\n\n      // Run the Solr query\n      if(!queryOffset) {\n        // If no offset, we display a new set of results\n        SolrAdapter.throttledQuery(checkedFields, queryOffset, Finder.displayResults);\n      } else {\n        // Otherwise, append to existing result set\n        SolrAdapter.throttledQuery(checkedFields, queryOffset, ResultsView.appendResults);\n      }\n\n      // Mark the results pane as loading\n      ResultsView.loading();\n    },\n\n    /**\n     * Displays results after querying Solr.\n     * @param data  Results from SolrAdapter\n     **/\n    displayResults: function(data) {\n      if (data.result) {\n        if(FormView.hasCheckedFields()) {\n          ResultsView.parseResults(data);\n          /* jshint ignore:start */\n          // Using that underscore variable notation for Solr.\n          FormView.disableFields(data.result[\"facet_counts\"][\"facet_queries\"]);\n          /* jshint ignore:end */\n        } else {\n          ResultsView.showBlankSlate();\n          FormView.clear();\n        }\n      } else {\n        FormView.showErrorMessage();\n      }\n    }\n  };\n\n  return Finder;\n});\n\n","define('StripeForm',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\"),\n    Stripe = window.Stripe || {};\n\n  /**\n    * Creates an instance of StripeForm.\n    *\n    * @constructor\n    * @this {StripeForm}\n    * @param {jQuery} $form The payment form\n    * @param {String} publishKey Publishable Stripe key.\n  */\n  var StripeForm = function ($form, publishKey) {\n    if ($form === undefined || !$($form.length)) { return; }\n    if (publishKey === undefined) { return; }\n    if (!this instanceof StripeForm) { return new StripeForm($form, publishKey); }\n    this.$form = $($form);\n    this.$parent = this.$form.parent();\n    this.publishKey = publishKey;\n    this.init();\n  };\n  StripeForm.prototype = {\n    /**\n      * Sets the publishable key to Stripe and adds event listeners to the form\n    */\n    init: function () {\n      var _this = this;\n      Stripe.setPublishableKey(this.publishKey);\n\n      this.$form.on(\"submit\", function (ev) {\n        ev.preventDefault();\n      });\n\n      // attach event listener to submit button to avoid double binding\n      this.$form.find(\".form-submit\").on(\"click\", function () {\n        // Timeout needed so errors (if any) can render first\n        setTimeout(function () {\n          var isValid = _this.isValid();\n          if (isValid) {\n            Stripe.card.createToken(_this.$form, function (status, response) {\n              _this.onFormSubmit(status, response);\n            });\n          }\n        }, 100);\n      });\n    },\n\n    /**\n      * Callback method when form is submitted\n      * @param {String} Response status code\n      * @param {object} JSON response from submitted token\n    */\n    onFormSubmit: function (status, response) {\n      var $form = this.$form;\n      if (response.error) {\n        // Show the errors on the form\n        $form.find(\".payment-errors\").text(response.error.message);\n      } else {\n        // response contains id and card, which contains additional card details\n        var token = response.id;\n        $form.find(\"input[name='token']\").val(token);\n        $form.get(0).submit();\n      }\n    },\n\n    /**\n      * Checks for invalid form fields\n      * @returns {boolean} Whether form contains zero errors or not\n    */\n    isValid: function () {\n      return this.$form.find(\".error\").length === 0;\n    }\n  };\n\n  return StripeForm;\n\n});\n\n","define('donate/Donate',['require','jquery','StripeForm'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var StripeForm = require(\"StripeForm\");\n  var $donateForm = $(\"#dosomething-payment-form\");\n\n  var Donate = {\n    init: function () {\n      try {\n        var stripeAPIPublishKey = Drupal.settings.dosomethingPayment.stripeAPIPublish;\n        new StripeForm($donateForm, stripeAPIPublishKey);\n      } catch(e) {\n        $donateForm.html(\"<div class='messages'>Whoops! Something's not right. Please email us!</div>\");\n      }\n    }\n  };\n\n  return Donate;\n\n});\n\n","define('revealer/Revealer',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n\n  /**\n   * Allows for specified grouping of elements to be hidden and then revealed\n   * via an interactive \"Show More\" button.\n   *\n   * @param {jQuery} $container The container element object that encloses the items to hide.\n   * @param {jQuery} $content   A collection of objects to hide.\n   * @param {string} category   Specify a category type for the content to provide more unique behavior.\n   * @param {int} initialItems  Amount of items to initially display.\n   * @param {int} stepItems     Amount of items to step by\n   */\n  var Revealer = function($container, $content, category, initialItems, stepItems) {\n    this.$container = $container;\n    this.$content   = $content;\n    this.$button    = $(\"<button class=\\\"button -tertiary\\\">\" + Drupal.t(\"Show More\") + \"</button>\");\n    this.category   = category;\n    this.initialItems = initialItems;\n    this.stepItems = stepItems;\n    this.step\n    this.steps      = {\n      // Array of step items to include with each button interaction.\n      items: [],\n\n      // Number of steps.\n      count: 0\n    };\n\n    this.init();\n  };\n\n\n  Revealer.prototype.init = function () {\n    if (this.category === \"gallery\") {\n      this.prepGalleryItems();\n    }\n    else {\n      this.steps.items.push(this.$content);\n    }\n\n    this.steps.count = this.steps.items.length;\n\n    this.detachContent();\n    this.enableButton();\n  };\n\n\n  Revealer.prototype.detachContent = function () {\n    this.$content.detach();\n  };\n\n\n  Revealer.prototype.reattachContent = function (content) {\n    this.$container.append(content);\n  };\n\n\n  Revealer.prototype.enableButton = function () {\n    this.$button.insertAfter(this.$container);\n\n    var _this = this;\n\n    this.$button.on(\"click\", function () {\n\n      if (_this.steps.count > 0) {\n        _this.reattachContent(_this.steps.items.shift());\n        _this.steps.count--;\n      }\n\n      if (_this.steps.count === 0) {\n        _this.$button.remove();\n      }\n\n    });\n  };\n\n\n  Revealer.prototype.prepGalleryItems = function () {\n    this.$content = this.$content.slice(this.initialItems);\n    var collection = $.makeArray(this.$content);\n\n    // Multiple step reveals.\n    if (this.$content.length > this.stepItems) {\n      while (collection.length > 0) {\n        this.steps.items.push(collection.splice(0, this.stepItems));\n      }\n    }\n    else {\n      this.steps.items.push(collection);\n    }\n\n    collection = null;\n  };\n\n\n  return Revealer;\n\n});\n\n","define('swapper/Swapper',[],function() {\n  \"use strict\";\n\n  var Swapper = function ($content) {\n    this.$image   = $content.find(\"img\");\n\n    this.init();\n  };\n\n\n  Swapper.prototype.init = function () {\n    var srcLarge = this.$image.data(\"src-large\") || null;\n\n    this.exchange(srcLarge);\n  };\n\n\n  Swapper.prototype.exchange = function (url) {\n    if (url) {\n      this.$image.attr(\"src\", url);\n    }\n  };\n\n\n  return Swapper;\n\n});\n\n","/**\n * Pub/Sub events: Allows modules to communicate via publishing\n * and subscribing to events.\n *\n * Based on Addy Osmani's Pubsubz, licensed under the GPL.\n * https://github.com/addyosmani/pubsubz\n * http://jsfiddle.net/LxPrq/\n */\n\ndefine('modal/events',[],function() {\n  \"use strict\";\n\n  var topics = {};\n  var subUid = -1;\n\n  var publish = function(topic, args) {\n    if (!topics[topic]) {\n      return false;\n    }\n\n    setTimeout(function() {\n      var subscribers = topics[topic],\n      len = subscribers ? subscribers.length : 0;\n\n      while(len--) {\n        subscribers[len].func(topic, args);\n      }\n    }, 0);\n\n    return true;\n  };\n\n  var subscribe = function(topic, func) {\n    if (!topics[topic]) {\n      topics[topic] = [];\n    }\n\n    var token = (++subUid).toString();\n    topics[topic].push({\n      token: token,\n      func: func\n    });\n\n    return token;\n  };\n\n  var unsubscribe = function(token) {\n    for (var m in topics) {\n      if (topics[m]) {\n        for (var i = 0, j = topics[m].length; i < j; i++) {\n          if (topics[m][i].token === token) {\n            topics[m].splice(i, 1);\n            return token;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  // Export public API\n  return {\n    publish: publish,\n    subscribe: subscribe,\n    unsubscribe: unsubscribe\n  };\n});\n\n","/**\n * @module neue/modal\n * Show/hide modals. To link to a modal, add a `data-modal-href` attribute\n * pointing to the selector for the modal you want to show.\n *\n * @example\n * // <a href=\"http://www.example.com\" data-modal-href=\"#modal--example\">Click!</a>\n * // <div data-modal id=\"modal--example\" role=\"dialog\">\n * //   <!-- content -->\n * // </div>\n *\n */\n\ndefine('modal/modal',['require','./events'],function(require) {\n  \"use strict\";\n\n  var $ = window.jQuery;\n  var Modernizr = window.Modernizr;\n  var Events = require(\"./events\");\n\n  var modalReady = false;\n  var queuedModal = null; // Modals queued to be shown on document.ready\n\n  // Cache commonly used jQuery objects\n  var $document = $(document);\n  var $chrome = $(\".chrome\");\n  var $modalContainer = null;\n\n  // UI elements:\n  var $skipLink = $(\"<a href='#' class='js-close-modal js-modal-generated modal-close-button -alt'>skip</a>\");\n  var $closeLink = $(\"<a href='#' class='js-close-modal js-modal-generated modal-close-button'>&#215;</a>\");\n\n  // The currently open modal\n  var $modal = null;\n\n  // Whether this modal can be closed by the user\n  var closeable = false;\n\n  // Return a boolean if modal is open or not\n  var isOpen = function() {\n    return ($modal !== null);\n  };\n\n  // Programmatically add close button to modal.\n  var _addCloseButton = function($el, type, skipForm) {\n    switch(type) {\n      case \"skip\":\n        // Add a skip button, which delegates to the submitting the form with the given ID\n        $el.prepend( $skipLink );\n        $skipLink.on(\"click\", function(event) {\n          event.preventDefault();\n          $(skipForm).submit();\n        });\n        closeable = false;\n        break;\n\n      case \"false\":\n      case \"0\":\n        closeable = false;\n        break;\n\n      default:\n        $el.prepend($closeLink);\n        closeable = true;\n    }\n  };\n\n  /**\n   * Open a new modal\n   * @param {jQuery}  $el                         Element that will be placed inside the modal.\n   * @param {boolean} [options.animated=true]     Use animation for opening the modal.\n   * @param {boolean} [options.closeButton]       Override `data-modal-close` attribute.\n   * @param {boolean} [options.skipForm]          Override `data-modal-skip-form` attribute.\n   */\n  var open = function($el, options) {\n    options = options || {};\n    options.animated = typeof options.animated === \"boolean\" ? options.animated : true;\n    options.closeButton = typeof options.closeButton !== \"undefined\" ? options.closeButton : $el.attr(\"data-modal-close\");\n    options.skipForm = typeof options.skipForm !== \"undefined\" ? options.skipForm : $el.attr(\"data-modal-skip-form\");\n\n    if($el.length === 0) {\n      // If modal does not exist, don't try to open it.\n      return false;\n    }\n\n    // If modal markup isn't initialized, save and display once it is.\n    if(!modalReady) {\n      queuedModal = {\"$el\": $el, \"options\": options};\n      return false;\n    }\n\n    // Read from DOM\n    var offsetTop = \"-\" + $document.scrollTop() + \"px\";\n\n    // Add generated content\n    _addCloseButton($el, options.closeButton, options.skipForm);\n\n    if(!isOpen()) {\n      // Set up overlay and show modal\n      $chrome.css(\"top\", offsetTop);\n      $chrome.addClass(\"has-modal\");\n      $modalContainer.css(\"display\", \"block\");\n      if(options.animated && Modernizr.cssanimations) {\n        $modalContainer.addClass(\"animated-open\");\n      }\n      $el.css(\"display\", \"block\");\n    } else {\n      // Modal is already open, so just replace current content\n      $modal.hide();\n      $el.show();\n    }\n\n    // Make sure we're scrolled to the top of the modal.\n    setTimeout(function() {\n      $document.scrollTop(0);\n    }, 50);\n\n    // We provide an event that other modules can hook into to perform custom functionality when\n    // a modal opens (such as preparing things that are added to the DOM, etc.)\n    Events.publish(\"Modal:Open\", $el);\n\n    // Keep track of whether modal is open or not\n    $modal = $el;\n  };\n\n  // Cleanup after modal animates out\n  var _cleanup = function(scrollOffset) {\n    $modalContainer.css(\"display\", \"none\");\n    $modalContainer.removeClass(\"animated-close\");\n    $modal.css(\"display\", \"none\");\n\n    // Remove any generated content\n    $modal.find(\".js-modal-generated\").remove();\n\n    // Remove overlay and reset scroll position\n    $chrome.removeClass(\"has-modal\");\n    $chrome.removeClass(\"animated-close\");\n    $chrome.css(\"top\", \"\");\n    $document.scrollTop(scrollOffset);\n\n    // Get rid of reference to closed modal\n    $modal = null;\n  };\n\n  /**\n   * Close the active modal.\n   * @param {boolean} [options.animated=true] Use animation for closing the modal.\n   */\n  var close = function(options) {\n    options = options || {};\n    options.animated = typeof options.animated !== \"undefined\" ? options.animated : true;\n\n    var scrollOffset = parseInt($chrome.css(\"top\")) * -1;\n\n    // Remove URL hash for modal from browser\n    if(window.location.hash === \"#\" + $modal.attr(\"id\")) {\n      window.location.hash = \"/\";\n    }\n\n    if(options.animated && Modernizr.cssanimations) {\n      $chrome.addClass(\"animated-close\");\n      $modalContainer.addClass(\"animated-close\");\n      $modalContainer.one(\"webkitAnimationEnd oanimationend msAnimationEnd animationend\", function() {\n        _cleanup(scrollOffset);\n      });\n    } else {\n      _cleanup(scrollOffset);\n    }\n\n    // We provide an event that other modules can hook into to perform custom functionality when\n    // a modal opens (such as preparing things that are added to the DOM, etc.)\n    Events.publish(\"Modal:Close\", $modal);\n  };\n\n  // Click handler for opening a new modal\n  var _openHandler = function(event) {\n    event.preventDefault();\n    var href = $(this).data(\"modal-href\");\n\n    open($(href));\n  };\n\n  // Click handler for closing a modal\n  var _closeHandler = function(event) {\n    // Don't let the event bubble.\n    if(event.target !== this) {\n      return;\n    }\n\n    // Only close on clicking overlay if this modal has a \"x\" close button\n    if( $(this).hasClass(\"js-close-modal\") || closeable ) {\n      // Override default link behavior.\n      event.preventDefault();\n      close();\n    }\n  };\n\n  $document.ready(function() {\n    var $body = $(\"body\");\n\n    // Create container for modals\n    $modalContainer = $(\"<div class='modal-container'></div>\");\n    $body.append($modalContainer);\n\n    // Prepare the DOM!\n    $(\"[data-modal]\").each(function() {\n      $(this).appendTo($modalContainer);\n      $(this).attr(\"hidden\", true);\n    });\n\n    //If there's a hash in the URL, check if it's a modal and load it\n    var hash = window.location.hash;\n    if(hash && hash !== \"#/\" && $(hash) && typeof $(hash).data(\"modal\") !== \"undefined\") {\n      open($(hash));\n    }\n\n    modalReady = true;\n    if(queuedModal !== null) {\n      open(queuedModal.$el, queuedModal.options);\n    }\n\n    // Bind events to open & close modal\n    $body.on(\"click\", \"[data-modal-href]\", _openHandler);\n    $body.on(\"click\", \".modal-container\", _closeHandler);\n    $body.on(\"click\", \".js-close-modal\", _closeHandler);\n  });\n\n  // Attach to namespaced window object\n  window.DS = window.DS || {};\n  window.DS.Modal = {\n    isOpen: isOpen,\n    open: open,\n    close: close,\n    Events: Events\n  };\n\n  return window.DS.Modal;\n});\n\n\ndefine('modal', ['modal/modal'], function (main) { return main; });\n\n","/**\n * Pub/Sub events: Allows modules to communicate via publishing\n * and subscribing to events.\n *\n * Based on Addy Osmani's Pubsubz, licensed under the GPL.\n * https://github.com/addyosmani/pubsubz\n * http://jsfiddle.net/LxPrq/\n */\n\ndefine('validation/events',[],function() {\n  \"use strict\";\n\n  var topics = {};\n  var subUid = -1;\n\n  var publish = function(topic, args) {\n    if (!topics[topic]) {\n      return false;\n    }\n\n    setTimeout(function() {\n      var subscribers = topics[topic],\n      len = subscribers ? subscribers.length : 0;\n\n      while(len--) {\n        subscribers[len].func(topic, args);\n      }\n    }, 0);\n\n    return true;\n  };\n\n  var subscribe = function(topic, func) {\n    if (!topics[topic]) {\n      topics[topic] = [];\n    }\n\n    var token = (++subUid).toString();\n    topics[topic].push({\n      token: token,\n      func: func\n    });\n\n    return token;\n  };\n\n  var unsubscribe = function(token) {\n    for (var m in topics) {\n      if (topics[m]) {\n        for (var i = 0, j = topics[m].length; i < j; i++) {\n          if (topics[m][i].token === token) {\n            topics[m].splice(i, 1);\n            return token;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  // Export public API\n  return {\n    publish: publish,\n    subscribe: subscribe,\n    unsubscribe: unsubscribe\n  };\n});\n\n","/**\n * Client-side form validation logic. Form element is validated based\n * on `data-validate` attribute, and validation output is placed in\n * corresponding `<label>`.\n *\n * Validations can be added later by extending `NEUE.Validation.Validations`.\n * Validators can be added later by extending `NEUE.Validation.Validators`.\n *\n * finished validating with a boolean `success` and a plain-text `message`\n * value. (Alternatively, a `suggestion` value can be passed which will\n * prompt the user \"Did you mean {suggestion}?\".\n *\n * ## Usage Notes:\n * - Input field must have `data-validate` attribute.\n * - If adding input fields to the DOM after load, run `prepareFields`\n */\n\ndefine('validation/validation',['require','./events'],function(require) {\n  \"use strict\";\n\n  var $ = window.jQuery;\n  var Events = require(\"./events\");\n  var validations = [];\n\n  /**\n   * Prepares form label DOM to display validation messages & register event handler\n   * @param {jQuery} $fields Fields to register validation handlers to.\n   */\n  var prepareFields = function($fields) {\n    $fields.each(function() {\n      var $field = $(this);\n\n      prepareLabel( $(\"label[for='\" + $field.attr(\"id\") + \"']\") );\n\n      $field.on(\"blur\", function(event) {\n        event.preventDefault();\n        validateField( $field );\n      });\n    });\n  };\n\n  /**\n   * Prepare field label DOM to display validation messages.\n   * @param {jQuery} $label Label element to prepare.\n   */\n  var prepareLabel = function($label) {\n    // Check to make sure we haven't already prepared this before\n    if($label.find(\".validation\").length === 0) {\n      var $innerLabel = $(\"<div class='validation'></div>\");\n      $innerLabel.append(\"<div class='validation__label'>\" + $label.html() + \"</div>\");\n      $innerLabel.append(\"<div class='validation__message'></div>\");\n\n      $label.html($innerLabel);\n    }\n  };\n\n  /**\n   * Trigger a validation on a form element.\n   * @param {jQuery}   $field                            Form element to be validated.\n   * @param {jQuery}   [force = false]                   Force validation (even on empty fields).\n   * @param {function} [callback=showValidationMessage]  Callback function that receives validation result\n   */\n  var validateField = function($field, force, callback) {\n    // Default arguments\n    force = typeof force !== \"undefined\" ? force : false;\n    callback = typeof callback !== \"undefined\" ? callback : function($field, result) {\n      showValidationMessage($field, result);\n    };\n\n    var validation = $field.data(\"validate\");\n\n    // Trigger any other linked validation\n    var validationTrigger = $field.data(\"validate-trigger\");\n    if(validationTrigger) {\n      validateField( $(validationTrigger) );\n    }\n\n\n    // Don't validate if validation doesn't exist\n    if(!validations[validation]) {\n      console.error(\"A validation with the name \"+ validation + \" has not been registered.\");\n      return;\n    }\n\n    // For <input>, <select>, and <textarea> tags we provide\n    // the field's value as a string\n    if( isFormField($field) ) {\n      // Get field info\n      var fieldValue = $field.val();\n\n      // Finally, let's not validate blank fields unless forced to\n      if(force || fieldValue !== \"\") {\n        if(validation === \"match\") {\n          var matchFieldValue = $($field.data(\"validate-match\")).val();\n          validations[validation].fn(fieldValue, matchFieldValue, function(result) {\n            callback($field, result);\n          });\n        } else {\n          validations[validation].fn(fieldValue, function(result) {\n            callback($field, result);\n          });\n        }\n      }\n    } else {\n      // For all other tags, we pass the element directly\n      if(validation === \"match\") {\n        var $matchField = $($field.data(\"validate-match\"));\n        validations[validation].fn($field, $matchField, function(result) {\n          callback($field, result);\n        });\n      } else {\n        validations[validation].fn($field, function(result) {\n          callback($field, result);\n        });\n      }\n    }\n  };\n\n  /**\n   * Register a new validation.\n   *\n   * @param {String}    name              The name function will be referenced by in `data-validate` attribute.\n   * @param {Object}    validation        Collection of validation rules to apply\n   * @param {Function}  [validation.fn]   Custom validation\n   */\n  var registerValidation = function(name, validation) {\n    if(validations[name]) {\n      throw \"A validation function with that name has already been registered\";\n    }\n\n    validations[name] = validation;\n  };\n\n  /**\n   * @DEPRECATED: Will be removed in a future version in favor of `registerValidation`.\n   */\n  var registerValidationFunction = function(name, func) {\n    var v = {\n      fn: func\n    };\n\n    registerValidation(name, v);\n  };\n\n  /**\n   * Show validation message in markup.\n   *\n   * @param {jQuery} $field              Field to display validation message for.\n   * @param {Object} result              Object containing `success` and either `message` or `suggestion`\n   */\n  var showValidationMessage = function($field, result) {\n    var $fieldLabel = $(\"label[for='\" + $field.attr(\"id\") + \"']\");\n    var $fieldValidation = $fieldLabel.find(\".validation\");\n    var $fieldMessage = $fieldValidation.find(\".validation__message\");\n    var fieldLabelHeight = $fieldLabel.height();\n    var fieldMessageHeight;\n\n    $field.removeClass(\"has-success has-error has-warning shake\");\n    $fieldMessage.removeClass(\"has-success has-error has-warning\");\n\n    // Highlight/animate field\n    if(result.success === true) {\n      $field.addClass(\"has-success\");\n      $fieldMessage.addClass(\"has-success\");\n    } else {\n      $field.addClass(\"has-error\");\n      $fieldMessage.addClass(\"has-error\");\n\n      if( isFormField($field) ) {\n        $field.addClass(\"shake\");\n      }\n\n      Events.publish(\"Validation:InlineError\", $fieldLabel.attr(\"for\"));\n    }\n\n    // Show validation message\n    if(result.message) {\n      $fieldMessage.text(result.message);\n    }\n\n    if(result.suggestion) {\n      $fieldMessage.html(\"Did you mean \" + result.suggestion.full + \"? <a href='#' data-suggestion='\" + result.suggestion.full + \"'class='js-mailcheck-fix'>Fix it!</a>\");\n      Events.publish(\"Validation:Suggestion\", result.suggestion.domain);\n    }\n\n    fieldMessageHeight = $fieldMessage.height();\n\n    // Set label height if it needs to be multiline.\n    if(fieldMessageHeight > fieldLabelHeight) {\n      $fieldLabel.css(\"height\", fieldMessageHeight + \"px\");\n    } else {\n      // Clear previous multiline height if no longer needed.\n      $fieldLabel.css(\"height\", \"\");\n    }\n\n    // Animate in the validation message\n    $fieldValidation.addClass(\"is-showing-message\");\n\n    $(\".js-mailcheck-fix\").on(\"click\", function(e) {\n      e.preventDefault();\n\n      var $field = $(\"#\" + $(this).closest(\"label\").attr(\"for\"));\n      $field.val($(this).data(\"suggestion\"));\n      $field.trigger(\"blur\");\n\n      // If Google Analytics is set up, we fire an event to\n      // mark that a suggestion has been made\n      Events.publish(\"Validation:SuggestionUsed\", $(this).text() );\n    });\n\n    $field.on(\"focus\", function() {\n      $field.removeClass(\"has-warning has-error has-success shake\");\n      $fieldValidation.removeClass(\"is-showing-message\");\n      $fieldLabel.css(\"height\", \"\");\n    });\n\n    return result.success;\n  };\n\n\n  /**\n   * Disable form submission.\n   * @param {jQuery} $form Form to disable submission for.\n   */\n  var disableFormSubmit = function($form) {\n    // Prevent double-submissions\n    var $submitButton = $form.find(\":submit\");\n\n    // Disable that guy\n    $submitButton.attr(\"disabled\", true);\n    $submitButton.addClass(\"is-loading\");\n  };\n\n\n  /**\n   * Re-enable form submission.\n   * @param {jQuery} $form Form to enable submission for.\n   */\n  var enableFormSubmit = function($form) {\n    var $submitButton = $form.find(\":submit\");\n    $submitButton.attr(\"disabled\", false);\n    $submitButton.removeClass(\"is-loading is-disabled\");\n  };\n\n  /**\n   * Returns whether element is <input>, <select>, or <textarea>.\n   * @param {jQuery} $el  Element to check type of.\n   * @return {boolean}\n   */\n  var isFormField = function($el) {\n    var tag = $el.prop(\"tagName\");\n    return ( tag === \"INPUT\" || tag === \"SELECT\" || tag === \"TEXTAREA\" );\n  };\n\n  /**\n   * Validate form on submit.\n   */\n  $(\"body\").on(\"submit\", \"form\", function(event, isValidated) {\n    var $form = $(this);\n    var $validationFields = $form.find(\"[data-validate]\");\n\n    // Disable form submission to prevent double-clicks.\n    disableFormSubmit($form);\n\n    // We want to validate all [data-validate] field that are either required, or have user input.\n    $validationFields = $validationFields.map(function() {\n      var $this = $(this);\n      if(typeof $this.attr(\"data-validate-required\") !== \"undefined\" || $this.val() !== \"\") {\n        return $this;\n      }\n    });\n\n    // If no fields should be validated, submit!\n    if($validationFields.length === 0) {\n      return true;\n    }\n\n    if(isValidated === true) {\n      // completed a previous runthrough & validated;\n      // we're ready to submit the form\n      return true;\n    } else {\n      event.preventDefault();\n\n      var validatedFields = 0;\n      var validatedResults = 0;\n      var scrolledToError = false;\n\n      $validationFields.each(function() {\n        validateField($(this), true, function($field, result) {\n          validatedFields++;\n          showValidationMessage($field, result);\n\n          if(result.success) {\n            validatedResults++;\n          }\n\n          // If this is the first error in the form, scroll to it.\n          if(!scrolledToError && result.success === false) {\n            scrolledToError = true;\n            $(\"html,body\").animate({scrollTop: $field.offset().top - 32}, 200);\n          }\n\n          // Once we're done validating all fields, check status of form\n          if(validatedFields === $validationFields.length) {\n            if(validatedResults === $validationFields.length) {\n              // we've validated all that can be validated\n              Events.publish(\"Validation:Submitted\", $(this).attr(\"id\") );\n              $form.trigger(\"submit\", true);\n            } else {\n              Events.publish(\"Validation:SubmitError\", $(this).attr(\"id\") );\n              enableFormSubmit($form);\n            }\n          }\n        });\n      });\n\n      return false; // don't submit form, wait for callback with `true` parameter\n    }\n  });\n\n  // Register the \"match\" validation.\n  registerValidationFunction(\"match\", function(string, secondString, done) {\n    if(string === secondString && string !== \"\") {\n      return done({\n        success: true,\n        message: \"Looks good!\"\n      });\n    } else {\n      return done({\n        success: false,\n        message: \"That doesn't match.\"\n      });\n    }\n  });\n\n  $(function() {\n    // Prepare the labels on any `[data-validate]` fields in the DOM at load\n    prepareFields( $(\"body\").find(\"[data-validate]\") );\n  });\n\n  // Attach to namespaced window object\n  window.DS = window.DS || {};\n  window.DS.Validation = {\n    prepareFields: prepareFields,\n    registerValidation: registerValidation,\n    registerValidationFunction: registerValidationFunction,\n    validateField: validateField,\n    showValidationMessage: showValidationMessage,\n    Validations: validations,\n    Events: Events\n  };\n\n  return window.DS.Validation;\n});\n\ndefine('validation', ['validation/validation'], function (main) { return main; });\n\n","define('images/ImageCrop',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n\n  // Initialize variables.\n  var xInitPos;\n  var yInitPos;\n  var offsetLeft;\n  var offsetTop;\n  var initialCropBoxHeight;\n  var initialCropBoxWidth;\n  var previewImageWidth;\n  var previewImageHeight;\n  var $previewImage;\n  var origImage;\n  var resizeState          = false;\n  var dragState            = false;\n  var $cropBox             = $(\"<div class='cropbox'><div class='resize-handle'></div></div>\");\n  var resizeClickPositionX = 0;\n  var resizeClickPositionY = 0;\n  var scale                = 1;\n  var degrees              = 0;\n  var minThreshold         = 480;\n\n  /**\n   * Returns the coordinates of a touch or mouse event.\n   */\n  var getCoords = function(e) {\n    var coords = {};\n    var eventType = e.originalEvent.type;\n\n    // Get the coordinates of a touchevent.\n    if (eventType === \"touchstart\" || eventType === \"touchmove\" || eventType === \"touchend\") {\n      coords = e.originalEvent.targetTouches[0];\n    }\n    // Get coordinates of mouse event.\n    else {\n      coords = {\n        pageX: e.pageX,\n        pageY: e.pageY,\n      };\n    }\n\n    return coords;\n  };\n\n  /**\n   * Returns a value equal to the minimum allowed crop size scaled down to fit the image.\n   */\n  var getMinimumSize = function() {\n    return minThreshold / scale;\n  };\n\n  /**\n   * Calculates the initial size of the cropbox. The initial\n   * size of the cropbox should be 50% of the size of the image,\n   * but have a minimum equal to the minimum allowed crop size.\n   *\n   * @param {number} width      width of the image.\n   * @param {number} height     height of the image.\n   * @param {number} minimum    minimum size of the cropbox\n   */\n  var getCropBoxSize = function(width, height, minimum) {\n    var cropBoxSize;\n    var orientation = (width > height) ? \"landscape\" : \"portrait\";\n\n    // Make the cropbox half the size of the largest dimension.\n    // But, make sure the cropbox will fit in the image by\n    // checking that it isn't ever greater than smallest dimension.\n    if (orientation === \"landscape\") {\n      var halfWidth = width / 2;\n\n      if (halfWidth > height) {\n        cropBoxSize = height;\n      }\n      else {\n        cropBoxSize = halfWidth;\n      }\n    }\n    else {\n      var halfHeight = height / 2;\n\n      if (halfHeight > width) {\n        cropBoxSize = width;\n      }\n      else {\n        cropBoxSize = halfHeight;\n      }\n    }\n\n    return (cropBoxSize > minimum) ? cropBoxSize : minimum;\n  };\n\n  /**\n   * This returns the amount to translate an image after it has been rotated so\n   * so that it stays center in it's container.\n   *\n   * @param {number} width      Width of the image.\n   * @param {number} height     height of the image.\n   * @param {number} degrees    How many degrees the image has been rotated.\n   */\n  var getTranslateDifference = function(width, height, degrees) {\n    var translateDiff = (width / 2) - (height / 2);\n\n    if (degrees === 90 || degrees === 270) {\n      return (degrees === 270) ? -(translateDiff) : translateDiff;\n    }\n    else {\n      return 0;\n    }\n  };\n\n  /**\n   * Turns on the ability to drag the crop box.\n   */\n  var dragCropBoxInit = function() {\n    // Bind touch and mouse events.\n    $cropBox.on(\"touchstart mousedown\", function(event) {\n      event.preventDefault();\n\n      var coords = getCoords(event);\n\n      // Set the initial position of the mouse.\n      xInitPos = coords.pageX;\n      yInitPos = coords.pageY;\n\n      // Sets the initial positioning of the crop box.\n      if ($cropBox.length) {\n        offsetLeft = parseInt($cropBox.css(\"left\"), 10);\n        offsetTop  = parseInt($cropBox.css(\"top\"), 10);\n      }\n\n      // Turns on dragging.\n      dragState = true;\n    });\n  };\n\n  /**\n   * Turns on the ability to resize the crop box.\n   */\n  var resizeCropBoxInit = function() {\n    $(\".resize-handle\").on(\"touchstart mousedown\", function(event) {\n      event.preventDefault();\n\n      // Grab the postioning of the event.\n      var coords = getCoords(event);\n\n      // Set the initial size of the crop box.\n      if ($cropBox.length) {\n        initialCropBoxHeight = parseInt($cropBox.css(\"height\"), 10);\n        initialCropBoxWidth  = parseInt($cropBox.css(\"width\"), 10);\n      }\n\n      // Set the position of the mouse.\n      resizeClickPositionX = coords.pageX;\n      resizeClickPositionY = coords.pageY;\n\n      // Turn on resizing.\n      resizeState = true;\n    });\n  };\n\n  /**\n   * Sets up the mouse events on the cropping interface using a give width and height.\n   *\n   * @param {number} width     Width of the crop area.\n   * @param {number} height    Height of the crop area.\n   */\n  var croppingReset = function (width, height) {\n    // Turn off any previously bound events so\n    // we can rebind them later using new settings.\n    $(document).off(\"touchmove mousemove\");\n    $(document).off(\"touchend mouseup\");\n\n    // Bind move events to the document.\n    $(document).on(\"touchmove mousemove\", function(event) {\n      var coords        = getCoords(event);\n      var cropBoxHeight = parseInt($cropBox.css(\"height\"),10);\n      var cropBoxWidth  = parseInt($cropBox.css(\"width\"),10);\n      var cropBoxTop    = parseInt($cropBox.css(\"top\"), 10);\n      var cropBoxLeft   = parseInt($cropBox.css(\"left\"), 10);\n\n      // If dragging, drag the crop box along.\n      if (dragState) {\n        // Calculate how far to move the box down and right based on the mouse position.\n        var moveRight = offsetLeft + (coords.pageX - xInitPos);\n        var moveDown  = offsetTop + (coords.pageY - yInitPos);\n\n        // Boundary threshold tests.\n        var withinTopBounds  = (height - cropBoxHeight) > moveDown ? true : false;\n        var withinLeftBounds = (width - cropBoxWidth) > moveRight ? true : false;\n\n        // Make sure we are still within the bounds of the image and then actully move the box.\n        if (withinTopBounds && (moveDown > 0)) {\n          $cropBox.css(\"top\", moveDown);\n        }\n        if (withinLeftBounds && (moveRight > 0)) {\n          $cropBox.css( \"left\", moveRight);\n        }\n      }\n\n      // If resizing, resize the crop box.\n      if (resizeState) {\n        dragState = false;\n        // Calculate how much to resize the cropbox.\n        var resizeHorizontal = initialCropBoxWidth + (coords.pageX - resizeClickPositionX);\n        var resizeVertical   = initialCropBoxHeight + (coords.pageX - resizeClickPositionX);\n\n        // Boundary threshold tests.\n        var withinHeightBounds = (cropBoxHeight + cropBoxTop) < height ? true : false;\n        var withinWidthBounds  = (cropBoxWidth + cropBoxLeft) < width ? true : false;\n        var cropBoxSizeAllowed = (cropBoxWidth > minThreshold) ? true : false;\n        var increasingSize     = (coords.pageX - resizeClickPositionX) > 0 ? true : false;\n        var decreasingSize     = (coords.pageX - resizeClickPositionX) < 0 ? true : false;\n\n        // Make sure we are still in the boundaries of the image, and then resize the box.\n        if (withinHeightBounds && withinWidthBounds && (cropBoxSizeAllowed || increasingSize)) {\n          $cropBox.css( \"height\", resizeVertical);\n          $cropBox.css( \"width\", resizeHorizontal);\n        }\n        else if (decreasingSize && cropBoxSizeAllowed) {\n          $cropBox.css( \"height\", resizeVertical);\n          $cropBox.css( \"width\", resizeHorizontal);\n        }\n      }\n    });\n\n    /**\n     *  When the user stops moving the mouse or touching the screen, turn of the drag and resizing events.\n     *  Get the final position and size of the crop and populate hidden form elements with them.\n     */\n    $(document).on(\"touchend mouseup\", function() {\n      dragState   = false;\n      resizeState = false;\n    });\n  };\n\n  /**\n   * This sets up the cropping interface with a given height and width.\n   *\n   * @param {number} width     Width of the crop area.\n   * @param {number} height    Height of the crop area.\n   */\n  var setupCrop = function(width, height) {\n    if (!$previewImage.length) {\n      return;\n    }\n\n    var $cropContainer = $previewImage.parent();\n    var cropBoxSize = getCropBoxSize(width, height, minThreshold);\n\n    // Expicitly set the dimensions of the crop area.\n    $cropContainer.width(width);\n    $cropContainer.height(height);\n\n    // Set the initial position of the cropbox in the center of the image\n    // and with a minimum value of 480px.\n    $cropBox.insertBefore($previewImage).css({\n      \"left\"   : Math.floor((width / 2) - (cropBoxSize / 2)),\n      \"top\"    : Math.floor((height / 2) - (cropBoxSize / 2)),\n      \"width\"  : cropBoxSize,\n      \"height\" : cropBoxSize,\n    });\n\n    // Initiate dragging and resizing.\n    dragCropBoxInit();\n    resizeCropBoxInit();\n\n    croppingReset(width, height);\n  };\n\n  /**\n   * Rotate an image in a container. When the image rotates, update the size\n   * of the container so it fits. Then, translate the image to the center of\n   * the new height of the container.\n   *\n   * @param {jQuery} $image     Image to be rotated.\n   * @param {number} degrees    How many degrees to rotate the image.\n   */\n  var rotateImage = function($image, degrees) {\n    var width          = $image.width();\n    var height         = $image.height();\n    var $cropContainer = $previewImage.parent();\n\n    // Calculate how much to translate the image by.\n    var translateDiff = getTranslateDifference(width, height, degrees);\n\n    if (degrees === 90 || degrees === 270) {\n      $cropContainer.css({\n        height: width,\n      });\n\n      // reset cropping events with new dimensions of crop area.\n      setupCrop(height,width);\n    }\n    else {\n      $cropContainer.css({\n        height: height,\n      });\n\n      setupCrop(width,height);\n    }\n\n    // Actually do the rotation and translation.\n    $image.css({\n      \"transform\" : \"rotate(\"+ degrees + \"deg) translate(\" + translateDiff + \"px, \" + translateDiff + \"px)\",\n    });\n  };\n\n  /**\n   * Populates fields in the main reportback form with values to use for cropping\n   * and rotating on the backend.\n   *\n   * @param {jQuery} form       The form to populate.\n   */\n  var populateFields = function($form) {\n    // Get the hidden form elements.\n    var $cropX        = $form.find(\"input[name='crop_x']\");\n    var $cropY        = $form.find(\"input[name='crop_y']\");\n    var $cropWidth    = $form.find(\"input[name='crop_width']\");\n    var $cropHeight   = $form.find(\"input[name='crop_height']\");\n    var $cropRotation = $form.find(\"input[name='crop_rotate']\");\n    var $captionField = $form.find(\"input[name='caption']\");\n    var caption       = $(\"#dosomething-reportback-image-form\").find(\"input[name='modal-caption']\").val();\n\n    // Calculate cropping information.\n    var cropValues = {\n      top     :  Math.round(($cropBox.offset().top - $previewImage.offset().top) * scale),\n      left    :  Math.round(($cropBox.offset().left - $previewImage.offset().left) * scale),\n      width   :  Math.round($cropBox.outerWidth() * scale),\n      height  :  Math.round($cropBox.outerHeight() * scale),\n      degrees :  degrees,\n    };\n\n    // Populate fields.\n    $cropX.val(cropValues.left);\n    $cropY.val(cropValues.top);\n    $cropWidth.val(cropValues.width);\n    $cropHeight.val(cropValues.height);\n    $cropRotation.val(cropValues.degrees);\n    $captionField.val(caption);\n  };\n\n  /**\n   * Initiates cropping js.\n   *\n   * @param {Image} origImage  Image object to crop\n   */\n  var dsCropperInit = function(image) {\n    // Store the image;\n    origImage = image;\n\n    // Get the preview image.\n    $previewImage = $(\"#modal--crop\").find(\".preview\");\n\n    if (!$previewImage.length) {\n      return;\n    }\n\n    // Set global valuea.\n    previewImageWidth  = $previewImage.width();\n    previewImageHeight = $previewImage.height();\n    scale              = origImage.width / $previewImage.width();\n    minThreshold       = getMinimumSize();\n\n    // Create the crop area.\n    $previewImage.wrap($(\"<div class='crop-bounding-box'></div>\"));\n\n    // Turn on cropping.\n    setupCrop(previewImageWidth, previewImageHeight);\n\n    // Rotation\n    var $rotateButton = $(\".image-editor\").find(\".-rotate\");\n\n    // Turn off any previously bound events to this button.\n    $rotateButton.off(\"click\");\n    degrees = 0;\n\n    $rotateButton.on(\"click\", function(e) {\n      e.preventDefault();\n      degrees = (degrees === 360) ? 90 : degrees + 90;\n      rotateImage($previewImage, degrees);\n    });\n  };\n\n  return {\n    dsCropperInit  : dsCropperInit,\n    populateFields : populateFields,\n  };\n});\n\n","  /**\n   * Creates a front-end preview of a reportback image given crop values.\n   */\ndefine('images/ImageCropPreview',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $                      = require(\"jquery\");\n  var $cropPreview           = $(\"<figure class='reportback__submission-cropped'></figure>\");\n  var $reportbackSubmissions = $(\".reportback__submissions\");\n  var $reportbackUploadBtn   = $(\".gigantor\");\n\n  /**\n   * Tests if this is the first reportback submission or not.\n   */\n  var firstSubmission = function() {\n    return ($(\".reportback__submission-latest\").length) ? false : true;\n  };\n\n  /**\n   * This returns the amount to translate an image after it has been rotated so\n   * so that it stays center in it's container.\n   * @TODO - this is a duplicate of a function used in ImageCrop.js. This needs to\n   * be made more DRY. Create a separate \"ImageCropUtilities.js\" file that can\n   * hold functions that pertain to calculations needed for cropping and rotation.\n   * This should also help clean up the cropping script for easier reading.\n   *\n   * @param {number} width      Width of the image.\n   * @param {number} height     height of the image.\n   * @param {number} degrees    How many degrees the image has been rotated.\n   */\n  var getTranslateDifference = function(width, height, degrees) {\n    var translateDiff = (width / 2) - (height / 2);\n\n    if (degrees === 90 || degrees === 270) {\n      return (degrees === 270) ? -(translateDiff) : translateDiff;\n    }\n    else {\n      return 0;\n    }\n  };\n\n  /**\n   * This function actually creates the crop preview image by calculating where to\n   * position the image within a square container so it looks like the crop the user chose.\n   * The positioning is based on crop and rotation that the user chose.\n   *\n   * @param {number} imageWidth      Width of the original image (not scaled).\n   * @param {number} imageHeight     height of the original image (not scaled).\n   * @param {object} cropValues      An object containing x, y, width, and height values describing the crop.\n   */\n  var getCropPreviewValues = function(imageWidth, imageHeight, cropValues) {\n    var cropPreviewSize = $cropPreview.width();\n    var horizontalScale = cropValues.width / cropPreviewSize;\n    var verticalScale   = cropValues.height / cropPreviewSize;\n    var newWidth        = imageWidth / horizontalScale;\n    var newHeight       = imageHeight / verticalScale;\n    var translateDiff   = getTranslateDifference(newWidth, newHeight, cropValues.degrees);\n\n    return {\n      \"left\"      : -(cropValues.x / horizontalScale) + \"px\",\n      \"top\"       : -(cropValues.y / verticalScale) + \"px\",\n      \"width\"     : newWidth,\n      \"height\"    : newHeight,\n      \"transform\" : \"rotate(\"+ cropValues.degrees + \"deg) translate(\" + translateDiff + \"px, \" + translateDiff + \"px)\",\n    };\n  };\n\n  /**\n   * This function handles DOM elements that are already on the page to make room for the crop preview image.\n   */\n  var setUpCropPreview = function() {\n    // If this is the first reportback submission, we need to hide the original button.\n    if (firstSubmission()) {\n      $reportbackUploadBtn.hide();\n    }\n    // Otherwise, move the current reportback into the thumbnail list of reportbacks\n    else {\n      var $lastestSubmission = $reportbackSubmissions.find(\".reportback__submission-latest img\");\n      var $reportbackSubmissionsList = $reportbackSubmissions.find(\".reportback__submissions-list\");\n\n      // Check if there is a list of reportbacks already on the page,\n      // if not, create on to put the old reportback in.\n      if (!$reportbackSubmissionsList.length) {\n        $reportbackSubmissionsList = $(\"<ul class='reportback__submissions-list gallery'></ul>\");\n        $reportbackSubmissions.append($reportbackSubmissionsList);\n      }\n\n      // If there are already 4 reportback submissions,\n      // then remove the last one and put the current on it it's place.\n      var submissionCount = $reportbackSubmissionsList.find(\"li\").length;\n      if (submissionCount === 4) {\n        $(\".reportback__submissions-list li:last-child\").remove();\n      }\n\n      $lastestSubmission.appendTo($reportbackSubmissionsList).wrap(\"<li></li>\");\n    }\n  };\n\n  // Create a preview of the crop.\n  var cropPreview = function(image, cropValues) {\n    // Save the original image dimensions.\n    var imageHeight   = image.height;\n    var imageWidth    = image.width;\n    var $previewImage = \"<img src='\" + image.src + \"'/>\";\n\n    // Add crop preview to the page.\n    setUpCropPreview();\n    $cropPreview.prependTo($reportbackSubmissions).empty().append($previewImage);\n\n    // Set heigth of the preview containter to be the sames as the computed width.\n    // This is so the preview container is always a square.\n    $cropPreview.css(\"height\", $cropPreview.width());\n\n    // Create the crop preview.\n    var cropPreviewValues = getCropPreviewValues(imageWidth, imageHeight, cropValues);\n    $cropPreview.find(\"img\").css(cropPreviewValues);\n\n    var $reportbackCaption = $(\".reportback__submission__copy\");\n\n    if ($(\".reportback__submission__copy\").length) {\n      $reportbackCaption.html(cropValues.caption);\n    }\n    else {\n      $reportbackCaption = $(\"<figcaption class=\\\"reportback__submission__copy\\\">\");\n      $cropPreview.after($reportbackCaption.html(cropValues.caption));\n    }\n  };\n\n  return {\n    cropPreview : cropPreview,\n  };\n});\n\n","define('images/ImageUploadBeta',['require','jquery','modal','validation','images/ImageCrop','../images/ImageCropPreview'],function(require) {\n  \"use strict\";\n\n  var $                = require(\"jquery\");\n  var Modal            = require(\"modal\");\n  var Validation       = require(\"validation\");\n  var ImageCrop        = require(\"images/ImageCrop\");\n  var ImageCropPreview = require(\"../images/ImageCropPreview\");\n\n\n  /**\n   * Handles the modal interface for image upload buttons.\n   * Requires a modal to be on the page with an id '#modal--crop'\n   * The modal should have a form '#dosomething-reportback-image-form'\n   * and a div to place the image preview '.image-wrapper'.\n   *\n   * @param {jQuery} $button  The file upload button\n   */\n  var ImageUploadBeta = function($button) {\n    this.$uploadButton   = $button;\n    this.$cropModal      = $(\"#modal--crop\");\n    this.$reportbackForm = $(\"#dosomething-reportback-form\");\n    this.$imageForm      = this.$cropModal.find(\"#dosomething-reportback-image-form\");\n    this.$imageCaption   = this.$imageForm.find(\"#modal-caption\");\n    this.$cropButton     = this.$imageForm.find(\".button\");\n    this.$imagePreview   = this.$cropModal.find(\".image-preview\");\n    this.imageValues     = {};\n    this.cropEnabled     = (typeof Drupal.settings.dsReportback.cropEnabled !== \"undefined\") ? Drupal.settings.dsReportback.cropEnabled : false;\n    this.readyToSave     = false;\n\n    this.init();\n  };\n\n  /**\n   * Initalizes event listeners\n   *\n   */\n  ImageUploadBeta.prototype.init = function () {\n    var _this = this;\n\n    this.$uploadButton.on(\"change\", function(event) {\n      event.preventDefault();\n\n      var files = !!this.files ? this.files : [];\n\n      // If no file selected/no FileReader support, we're all done\n      if (!files.length || !window.FileReader) {\n        return;\n      }\n\n      var fr = new FileReader();\n      fr.readAsArrayBuffer(this.files[0]);\n      fr.onload = function () {\n        var blob = _this.getStrippedBlob(this.result);\n        var urlCreator = window.URL || window.webkitURL;\n        var imageUrl = urlCreator.createObjectURL(blob);\n        var image = new Image();\n\n        image.src = imageUrl;\n        image.onload = function() {\n          var image = this;\n          var isValid = _this.validImage(this);\n          var $errorMsg = _this.$uploadButton.parent().siblings(\".error\");\n\n          if(isValid) {\n            // Remove any previously added error message.\n            if ($errorMsg.length) {\n              $errorMsg.remove();\n            }\n\n            // Open the modal.\n            _this.openModal();\n\n            // Add the preview image to the modal\n            _this.previewImage(image, _this.$imagePreview);\n\n            //Unbind before rebind so it doesnt fire twice.\n            _this.$cropButton.off(\"click\");\n\n            // When the user submits the modal form, send crop values to the form.\n            _this.$cropButton.on('click', function(event) {\n              event.preventDefault();\n\n              // Validate the caption field and make sure we are good to proceed.\n              _this.validateCaption(_this.engageImageCrop, image);\n            });\n          }\n          // Show user an error if they upload an image that is too small.\n          else {\n            if (!$errorMsg.length) {\n              var $error = $(\"<div class='messages error'>Please upload a larger photo. Min. size is 480px by 480px.</div>\");\n              $error.insertAfter(_this.$uploadButton.parent());\n            }\n          }\n        };\n      };\n    });\n\n    // Close the modal when a user wants to change their photo.\n    this.$cropModal.find(\".-change\").click(function(event) {\n      event.preventDefault();\n      Modal.close();\n    });\n\n    Modal.Events.subscribe(\"Modal:Close\", function() {\n      _this.resetFileField();\n    });\n  };\n\n\n  /**\n   * Validates the caption field in the modal.\n   * @param  {Function} callback  If validation passes, then lets rock on!\n   * @return {void}\n   */\n  ImageUploadBeta.prototype.validateCaption = function(callback, image) {\n    var _this = this;\n\n    Validation.validateField(this.$imageCaption, true, function($field, result) {\n      Validation.showValidationMessage($field, result);\n\n      if (result.success) {\n        callback(_this, image);\n      }\n    });\n  }\n\n\n  /**\n   * Everything is set, engage in cropping the selected image.\n   * @param  {object} data  ImageUpload object.\n   * @param  {object} image  Image object.\n   * @return {void}\n   */\n  ImageUploadBeta.prototype.engageImageCrop = function(data, image) {\n    var _this = data;\n\n    // Send crop information to the main reportback form\n    // so backend can use to crop.\n    ImageCrop.populateFields(_this.$reportbackForm);\n\n    // Create a crop preview on the client side.\n    ImageCropPreview.cropPreview(image, _this.getCropValues());\n\n    // Add a button to edit the image.\n    _this.createEditButton();\n\n    // The user clicked \"done\", so we can save this version of the crop\n    // and not reset the file field.\n    _this.readyToSave = true;\n\n    // Close the modal.\n    Modal.close();\n  }\n\n\n  /**\n   * Opens the modal making sure the done button is reset.\n   */\n  ImageUploadBeta.prototype.openModal = function() {\n    this.enableSubmit();\n    Modal.open(this.$cropModal,\n      {\n        animated: false,\n      }\n    );\n  };\n\n  /**\n   * Clears the file field input and resets it globally,\n   * if the user accidentally closed out of the modal.\n   * Allows the user to re-upload an image and edit it.\n   */\n  ImageUploadBeta.prototype.resetFileField = function() {\n    var $input = this.$uploadButton;\n\n    if (!this.readyToSave) {\n      $input.replaceWith(this.$uploadButton = $input.val(\"\").clone(true));\n    }\n  };\n\n  /**\n   * Creates a button the user can click to re-open the modal\n   * and edit the crop they selected.\n   */\n  ImageUploadBeta.prototype.createEditButton = function() {\n    var _this = this;\n\n    if (!$(\".reportback__submissions\").find(\".button--edit\").length) {\n      var $editButton = $(\"<span class='button button--edit -tertiary'>edit photo</span>\");\n      this.$uploadButton.parent().hide().before($editButton);\n\n      $editButton.click(function() {\n        _this.openModal();\n      });\n    }\n  };\n\n  /**\n   * Gets crop values from form and returns an object.\n   */\n  ImageUploadBeta.prototype.getCropValues = function() {\n    return {\n      x       : this.$reportbackForm.find(\"input[name='crop_x']\").val(),\n      y       : this.$reportbackForm.find(\"input[name='crop_y']\").val(),\n      width   : this.$reportbackForm.find(\"input[name='crop_width']\").val(),\n      height  : this.$reportbackForm.find(\"input[name='crop_height']\").val(),\n      degrees : parseInt(this.$reportbackForm.find(\"input[name='crop_rotate']\").val()),\n      caption : this.$reportbackForm.find(\"input[name='caption']\").val(),\n    };\n  };\n\n  /**\n   * Enables submit button in modal when it opens.\n   */\n  ImageUploadBeta.prototype.enableSubmit = function() {\n    var $submitButton = this.$cropModal.find(\".-done\");\n\n    if ($submitButton.prop(\"disabled\")) {\n      $submitButton.prop(\"disabled\", false);\n    }\n\n    if ($submitButton.hasClass(\"is-loading\")) {\n      $submitButton.removeClass(\"is-loading\");\n    }\n  };\n\n  /**\n   * Validates image size.\n   */\n  ImageUploadBeta.prototype.validImage = function(image) {\n    return (image.width >= 480 && image.height >= 480);\n  };\n\n  /**\n   * Resizes an image so that the dimensions of the scaled image.\n   * are never greater than it's container's maximum width (height of the container is variable).\n   *\n   * @param {jQuery} $image           The image to resize.\n   * @param {jQuery} $container       The container to resize within.\n   */\n  ImageUploadBeta.prototype.resizeImage = function($image, $container) {\n    var imageWidth  = $image.width();\n    var imageHeight = $image.height();\n    var containerMaxWidth = $container.width();\n    var orientation = (imageWidth > imageHeight) ? \"landscape\" : \"portrait\";\n\n    if ((imageWidth > containerMaxWidth) || (imageHeight > containerMaxWidth)) {\n      if (orientation === \"portrait\") {\n        $image.height(containerMaxWidth);\n      }\n      else {\n        $image.width(containerMaxWidth);\n      }\n    }\n    else {\n      return;\n    }\n  };\n\n  /**\n   * Creates a preview image of an uploaded file and adds it to a container.\n   * If cropping is enabled, it initiates the cropping script.\n   *\n   * @param {jQuery} fileReaderResult   The result property of a file reader object.\n   * @param {jQuery} $imageContainer    The DOM element to put the preview image in.\n   */\n  ImageUploadBeta.prototype.previewImage = function(image, $imageContainer) {\n    var _this = this;\n\n    var $preview = $(\"<img class='preview' src=''>\");\n    $imageContainer.html($preview);\n\n    $preview.attr(\"src\", image.src).load(function() {\n      var $this = $(this);\n\n      _this.resizeImage($this, $imageContainer);\n\n      // Initiate cropping if it is enabled.\n      if (_this.cropEnabled) {\n        ImageCrop.dsCropperInit(image);\n      }\n    });\n  };\n\n  /**\n   * This function strips out EXIF data from a file and recreates a\n   * FileReader Blob that we use to create the image object that is used\n   * in the modal. This way we only deal with the RAW image file on both\n   * mobile and desktop with out having to wory about it rendering differently\n   * and causing all of our image cropping/preview logic to be wrong.\n   *\n   * @TODO!!!!\n   * This code is UGLY and complicated. Largely, if not entirely, based on this\n   * flickr blog post: http://code.flickr.net/2012/06/01/parsing-exif-client-side-using-javascript-2/\n   * and this JS fiddle. http://jsfiddle.net/mowglisanu/frhwm2xe/3/\n   * We need to revist this, some options:\n   *  - We can try writing our own EXIF parser to remove or edit orientation data\n   *  - Use the exif-js (https://github.com/jseidelin/exif-js) library to read EXIF information\n   *    and try to update or crop preview logic based on the EXIF data.\n   */\n  ImageUploadBeta.prototype.getStrippedBlob = function(fileReaderResult) {\n    var dataView = new DataView(fileReaderResult);\n    var offset = 0;\n    var recess = 0;\n    var pieces = [];\n    var i = 0;\n    var generatedBlob;\n\n    if (dataView.getUint16(offset) === 0xffd8) {\n      offset   += 2;\n      var app1  = dataView.getUint16(offset);\n      offset   += 2;\n\n      // This loop doing the acutal reading of the data\n      // and creating an array with only the pieces we want.\n      while (offset < dataView.byteLength) {\n        if (app1 === 0xffe1) {\n          pieces[i] = {\n            recess : recess,\n            offset : offset - 2\n          };\n\n          recess = offset + dataView.getUint16(offset);\n\n          i++;\n        }\n        else if (app1 === 0xffda) {\n          break;\n        }\n\n        offset   += dataView.getUint16(offset);\n        app1  = dataView.getUint16(offset);\n        offset   += 2;\n      }\n\n      // If the file had EXIF data and it was removed,\n      // create a file blob with using the new array of file data.\n      if (pieces.length > 0) {\n        var newPieces = [];\n\n        pieces.forEach(function(v) {\n          newPieces.push(fileReaderResult.slice(v.recess, v.offset));\n        }, this);\n\n        newPieces.push(fileReaderResult.slice(recess));\n\n        generatedBlob = new Blob(newPieces, {type: \"image/jpeg\"});\n      }\n      // If no EXIF data existed on the file, then nothing was done to it.\n      // We can just create a blob with the original data.\n      else {\n        generatedBlob = new Blob([dataView], {type: \"image/jpeg\"});\n      }\n    }\n    // @TODO - If it is not a jpeg, create a png. We can work out a more\n    // robust fix for this that maybe only runs through the EXIF \n    // stuff if it is a jpeg in the first place.\n    else {\n      generatedBlob = new Blob([dataView], {type: 'image/png'});\n    }\n\n    return generatedBlob;\n  };\n\n  return ImageUploadBeta;\n\n});\n\n","\ndefine('text!images/templates/fallback-upload-interface.tpl.html',[],function () { return '<div class=\"file-selection\">\\n  <p class=\"file-selection__indicator\">\\n    <strong>Selected Photo:</strong> <span class=\"file-selection__name\"><%= file %></span>\\n  </p>\\n  <label class=\"<%= classes %>\" for=\"<%= id %>\">\\n    <span>Change photo</span>\\n  </label>\\n</div>\\n';});\n\n","/**\n * Provides a fallback for customized file input if the File API is not supported.\n */\ndefine('images/ImageUploadFallback',['require','jquery','lodash','text!images/templates/fallback-upload-interface.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $                    = require(\"jquery\");\n  var _                    = require(\"lodash\");\n  var fallbackUploadTplSrc = require(\"text!images/templates/fallback-upload-interface.tpl.html\");\n\n\n  var ImageUploadFallback = {\n\n    component: {\n      $container: null,\n      $fileInterface: null,\n      $indicator: null,\n      $input: null,\n      fileName: null,\n      id: null,\n      classes: [\n        'button',\n        'button--file',\n        '-tertiary'\n      ]\n    },\n\n\n    /**\n     * Initialize the fallback file input script.\n     * @param  jQuery  $input     Button input from form.\n     * @param  string  container  Container Class name for container that should house fallback components.\n     * @return void\n     */\n    init: function ($input, container) {\n      $input.attr('class', '');\n\n      this.component.$input = $input;\n      this.component.id = $input.attr('id');\n      this.component.$container = $(container);\n\n      this.activateInput(this.component.$input);\n    },\n\n\n    /**\n     * Activate the input to watch for file input change event.\n     * @param  jQuery  $input Specific file input.\n     * @return void\n     */\n    activateInput: function ($input) {\n      var _this = this;\n\n      $input.on('change', function (event) {\n        _this.component.fileName = _this.getFileName(event.target.value);\n\n        if (_this.component.$fileInterface) {\n          _this.updateFileSelection();\n        }\n        else {\n          _this.buildUpatedComponent();\n        }\n      });\n    },\n\n\n    /**\n     * Remove markup from the specified container.\n     * Clear it out to insert new interface.\n     * @return void\n     */\n    emptyContainer: function () {\n      this.component.$container.html('');\n    },\n\n\n    /**\n     * Get the file name for the uploaded file.\n     * @param  string  path  Full path string for uploaded image.\n     * @return string        Extracted file name from the full path.\n     */\n    getFileName: function (path) {\n      var start = path.indexOf(\"fakepath\\\\\");\n\n      if (start >= 0) {\n        return path.substring(start + 9, path.length); // 9 is length of \"fakepath\\\"\n      }\n\n      return path;\n    },\n\n\n    /**\n     * Construct the new interface component for the file api fallback.\n     * @return void\n     */\n    buildUpatedComponent: function () {\n      var data = {\n        \"id\": this.component.id,\n        \"classes\": this.component.classes.join(' '),\n        \"file\": this.component.fileName\n      };\n      var $markup = $(_.template(fallbackUploadTplSrc, data));\n\n      this.component.$input.detach();\n      $markup.find('.button--file').append(this.component.$input);\n\n      this.emptyContainer();\n      this.component.$indicator = $markup.find('.file-selection__name');\n      this.component.$fileInterface = $markup;\n      this.insertUpdatedComponent();\n    },\n\n\n    /**\n     * Insert the new interface into the specified container.\n     * @return void\n     */\n    insertUpdatedComponent: function () {\n      this.component.$container.prepend(this.component.$fileInterface);\n    },\n\n\n    /**\n     * Update just the file name displayed in the new file api interface.\n     * @return void\n     */\n    updateFileSelection: function () {\n      this.component.$indicator.text(this.component.fileName);\n    }\n  };\n\n\n  return ImageUploadFallback;\n});\n\n","\ndefine('text!reportback/templates/reportback.tpl.html',[],function () { return '<% if (isListItem) { %><li><% } %>\\n<figure class=\"photo -stacked -framed\">\\n  <img src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=\" alt=\"<%= caption %>\" data-src=\"<%= image %>\" />\\n  <figcaption class=\"__copy\"><%= caption %></figcaption>\\n</figure>\\n<% if (isListItem) { %></li><% } %>\\n';});\n\n","define('reportback/Reportback',['require','jquery','lodash','modal','../images/ImageUploadBeta','../images/ImageUploadFallback','text!reportback/templates/reportback.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $                   = require(\"jquery\");\n  var _                   = require(\"lodash\");\n  var Modal               = require(\"modal\");\n  var ImageUploadBeta     = require(\"../images/ImageUploadBeta\");\n  var ImageUploadFallback = require(\"../images/ImageUploadFallback\");\n  var reportbackTplSrc    = require(\"text!reportback/templates/reportback.tpl.html\");\n\n\n  var Reportback = {\n\n    $initialGallery: null,\n    $extendedGallery: null,\n    $viewMoreContainer: null,\n    $viewMoreButton: null,\n    $spinner: null,\n\n    apiUrl: \"/api/v1/campaigns\",\n\n    nid: null,\n\n    offset: 0,\n\n    itemsPrefetched: 0,\n\n    itemsTotal: null,\n\n    bundleSize: 12,\n\n    requestSize: 20,\n\n    inventory: [],\n\n    currentIndex: 0,\n\n    galleryInDom: false,\n\n\n    /**\n     * Initialize the Reportback interface.\n     *\n     * @param  {jQuery} $container  Reportback container object.\n     */\n    init: function ($container) {\n      this.reportbackContainer = $container;\n      this.$reportbackWrapper  = this.reportbackContainer.find(\".wrapper\");\n      this.$reportbackForm     = this.reportbackContainer.find(\"#dosomething-reportback-form\");\n      this.$uploadButton       = this.reportbackContainer.find(\".js-image-upload-beta\");\n      this.$captionField       = this.$reportbackForm.find(\".form-item-caption\");\n      this.$initialGallery     = $container.find(\".gallery--reportback\");\n\n      this.itemsPrefetched = $container.data(\"prefetched\");\n      this.itemsTotal      = $container.data(\"total\") - this.itemsPrefetched;\n      this.nid             = $container.data(\"nid\");\n      this.offset          = this.itemsPrefetched;\n\n      if (this.itemsPrefetched < this.itemsTotal) {\n        this.apiUrl = this.buildApiUrl();\n        this.enableViewMore();\n        this.enableResponsive();\n      }\n\n      if (Modernizr.filereader) {\n        this.imageUploadInit();\n      }\n      else {\n         ImageUploadFallback.init(this.$uploadButton, '.reportback__submissions');\n      }\n    },\n\n\n    imageUploadInit: function () {\n      var _this = this;\n      var imageUpload = new ImageUploadBeta(this.$uploadButton);\n\n      this.$captionField.hide();\n    },\n\n\n    /**\n     * Add the reportback entries to the DOM.\n     * Adds the entire extended gallery if it does not exist already,\n     * otherwise just appends the additional entries.\n     */\n    appendEntries: function (inventoryIndex) {\n      var start    = inventoryIndex;\n      var end      = start + this.bundleSize;\n      var $cluster = $();\n      var $images  = null;\n\n      if (this.outOfStock(start)) {\n        end = this.itemsTotal;\n      }\n\n      for (var i = start; i < end; i++) {\n        if (this.inventory[i] !== undefined) {\n          $cluster = $cluster.add(this.inventory[i]);\n        }\n      }\n\n      $images = $cluster.find(\"img\");\n\n      $images.unveil(200, function () {\n        var $this = $(this);\n\n        $this.load(function () {\n          $this.parent(\".photo\").css({ opacity: 1});\n        });\n      });\n\n      if (!this.galleryInDom) {\n        this.insertGallery($cluster);\n      }\n      else {\n        this.$extendedGallery.append($cluster);\n      }\n\n      // @TODO: There has to be a better way to trigger unveil to execute and not require a scroll.\n      $(window).trigger(\"scroll\");\n    },\n\n\n    /**\n     * Build out the API URL with the campaign node id.\n     *\n     * @return {string}  API base url.\n     */\n    buildApiUrl: function () {\n      return this.apiUrl + \"/\" + this.nid + \"/gallery.json\";\n    },\n\n\n    /**\n     * Remove the View More button.\n     */\n    disableViewMore: function () {\n      this.$viewMoreButton.remove();\n    },\n\n\n    /**\n     * Add the View More button if there are additional reportbacks.\n     */\n    enableViewMore: function () {\n      var _this = this;\n\n      this.$viewMoreContainer = $(\"<div class=\\\"reportback__view-more\\\"></div>\");\n      this.$viewMoreButton = $(\"<button id=\\\"view-more-button\\\" class=\\\"button button--view-more -tertiary\\\">View more</button>\");\n\n      this.$viewMoreContainer.append(this.$viewMoreButton);\n\n      if (this.isLargerMedia()) {\n        this.$viewMoreContainer.insertAfter(this.$reportbackWrapper);\n      }\n      else {\n        this.$viewMoreContainer.insertAfter(this.$initialGallery);\n      }\n\n\n      this.$viewMoreButton.on(\"click\", function () {\n        _this.evaluateInventory();\n      });\n    },\n\n\n    /**\n     * Enable Media Query check to shift around markup.\n     */\n    enableResponsive: function () {\n      var _this = this;\n\n      $(window).on(\"resize\", _.debounce(function () {\n        if (_this.isLargerMedia()) {\n          if (_this.$viewMoreContainer) {\n            _this.$viewMoreContainer.detach();\n            _this.$viewMoreContainer.insertAfter(_this.$reportbackWrapper);\n          }\n        } else {\n          if (_this.$viewMoreContainer) {\n            _this.$viewMoreContainer.detach();\n            _this.$viewMoreContainer.insertAfter(_this.$initialGallery);\n          }\n        }\n      }, 300));\n    },\n\n\n    /**\n     * Check to see if there are any reportback items currently in the\n     * inventory after each click of the View More button.\n     * If there are items already, then append them, otherwise if there are\n     * more in storage then request them to add to the inventory.\n     * If there's low inventory and no more in storage then remove the button.\n     */\n    evaluateInventory: function () {\n      if (this.inventory.length) {\n        if (this.lowInventory()) {\n          if (this.outOfStock(this.currentIndex)) {\n            this.appendEntries(this.currentIndex);\n            this.currentIndex = this.inventory.length;\n          }\n          else {\n            this.request(this.currentIndex);\n            this.currentIndex += this.bundleSize;\n          }\n        }\n        else {\n          this.appendEntries(this.currentIndex);\n          this.currentIndex += this.bundleSize;\n        }\n      }\n      else {\n        this.request(this.currentIndex);\n        this.currentIndex += this.bundleSize;\n      }\n\n      if (this.currentIndex === this.itemsTotal) {\n        this.disableViewMore();\n      }\n    },\n\n\n    /**\n     * Insert the extended gallery into the DOM.\n     *\n     * @param  {string} data  Markup of list items.\n     */\n    insertGallery: function (data) {\n      var content = data || null;\n\n      this.$extendedGallery = $(\"<ul class=\\\"gallery gallery--extended\\\"></ul>\");\n\n      if (content) {\n        this.$extendedGallery.html(content);\n      }\n\n      this.$viewMoreContainer.prepend(this.$extendedGallery);\n\n      this.galleryInDom = true;\n    },\n\n\n    /**\n     * Check to see if media size is large.\n     * @return {boolean}\n     */\n    isLargerMedia: function () {\n      return ($(window).outerWidth() >= 760);\n    },\n\n\n    /**\n     * Check to see if the stock is running low and will need to retrieve\n     * more based on the current index item we are on in the stock list.\n     *\n     * @return {boolean}\n     */\n    lowInventory: function () {\n      if ((this.currentIndex + this.bundleSize) > this.inventory.length ) {\n        return true;\n      }\n\n      return false;\n    },\n\n\n    /**\n     * Check to see if we are completely out of reportback item stock,\n     * and can not request more; if so, remove the \"View More\" button.\n     *\n     * @return {boolean}\n     */\n    outOfStock: function (quantity) {\n      if ((quantity + this.bundleSize) > this.itemsTotal) {\n        return true;\n      }\n\n      return false;\n    },\n\n\n    /**\n     * Ajax request to retrieve more reportback entries.\n     *\n     * @param {int} inventoryIndex  Value to indicate what index to start appending items from.\n     */\n    request: function (inventoryIndex) {\n      var _this = this;\n\n      $.ajax({\n        url: this.apiUrl,\n        dataType: \"json\",\n        data: {\n          offset: this.offset,\n          count: this.requestSize\n        },\n        beforeSend: function () {\n          if (_this.$spinner) {\n            _this.$spinner.show();\n          } else {\n            _this.$spinner = $(\"<div class=\\\"spinner\\\"></div>\");\n            _this.$viewMoreContainer.append(_this.$spinner);\n          }\n        }\n      }).done(function (response) {\n        _this.templatize(response);\n        _this.$spinner.hide();\n        _this.appendEntries(inventoryIndex);\n\n      }).fail(function () {\n        // @TODO: handle error here!\n\n      }).always(function () {\n        _this.offset += _this.inventory.length;\n      });\n    },\n\n\n    /**\n     * Use specified template to markup each reportback entry list item.\n     *\n     * @param {array} items Array of JSON objects containing reportback items.\n     */\n    templatize: function (items) {\n      for (var i = 0, count = items.length; i < count; i++) {\n        var data = {\n          \"id\": items[i].rbid,\n          \"image\": items[i].src,\n          \"caption\": items[i].caption,\n          \"status\": items[i].status,\n          \"isListItem\": true  // @TODO: probably a better way to address this... :insert shrug emoji here:\n        };\n\n        var markup = _.template(reportbackTplSrc, data);\n\n        this.inventory.push(markup);\n      }\n    }\n\n  };\n\n\n  return Reportback;\n});\n\n","/**\n * # Image Carousel\n *\n * Adds simple \"previous/next\" functionality to slide deck-style image\n * galleries with the following markup:\n *\n * @example\n * //  <div class=\"js-carousel gallery\">\n * //    <div id=\"prev\" class=\"prev-wrapper\">\n * //      <div class=\"prev-button\"><span class=\"arrow\">&#xe605;</span></div>\n * //    </div>\n * //\n * //    <div class=\"carousel-wrapper\">\n * //      <figure id=\"slide0\" class=\"slide\"><img src=\"./img/example_img0.jpg\" /></figure>\n * //      <figure id=\"slide1\" class=\"slide\"><img src=\"./img/example_img1.jpg\" /></figure>\n * //      <figure id=\"slide2\" class=\"slide\"><img src=\"./img/example_img2.jpg\" /></figure>\n * //      <figure id=\"slide3\" class=\"slide\"><img src=\"./img/example_img3.jpg\" /></figure>\n * //    </div>\n * //\n * //    <div id=\"next\" class=\"next-wrapper\">\n * //      <div class=\"next-button\"><span class=\"arrow\">&#xe60a;</span></div>\n * //    </div>\n * //  </div>\n *\n */\n\ndefine('neue/carousel',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  $(function() {\n    // Show first image\n    $(\"#slide0\").addClass(\"is-visible\");\n\n    // Make carousel stateful\n    var counter = 0,\n        totalCount = $(\".carousel__slide\").length - 1;\n\n    // Cache carousel buttons\n    var $buttons = $(\"#prev, #next\");\n\n    // Decrement counter\n    function decrementCounter() {\n      // If first slide is shown, restart loop\n      // Else, show previous slide\n      counter === 0 ? counter = totalCount : counter--;\n    }\n\n    // Increment counter\n    function incrementCounter() {\n      // If last slide is shown, restart loop\n      // Else, show next slide\n      counter === totalCount ? counter = 0 : counter++;\n    }\n\n    // Toggle slide visibility\n    function showCurrentSlide( direction ) {\n      // Remove \"visibile\" class from the current slide\n      $(\"#slide\" + counter).removeClass(\"is-visible\");\n\n      // Increment or decrement slide position based on user\"s request\n      direction === \"prev\" ? decrementCounter() : incrementCounter();\n\n      // Assign \"visible\" class to the requested slide\n      $(\"#slide\" + counter).addClass(\"is-visible\");\n    }\n\n    // Bind click event to carousel buttons\n    $buttons.click(function() {\n      showCurrentSlide( $(this).attr(\"id\") );\n    });\n  });\n});\n\n","/**\n * Enables \"toggle\" functionality on Footnote pattern.\n */\n\ndefine('neue/footnote',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  $(function() {\n\n    $(\".js-footnote-toggle\").each(function() {\n      var $content = $(this).closest(\".footnote\").find(\".js-footnote-hidden\");\n\n      // Hide content in a footnote if there's a toggle link.\n      $content.hide();\n\n      // Make toggle into a link\n      $(this).wrapInner(\"<a href='#'></a>\").on(\"click\", function(event) {\n        event.preventDefault();\n\n        $content.slideToggle();\n      });\n\n    });\n\n\n  });\n});\n\n","/**\n * Applies a smooth-scroll animation on links with the `.js-jump-scroll` class.\n */\n\ndefine('neue/jump-scroll',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  $(function() {\n    $(\".js-jump-scroll\").on(\"click\", function(event) {\n      event.preventDefault();\n\n      var href = $(this).attr(\"href\");\n\n      // Animate scroll position to the target of the link:\n      $(\"html,body\").animate({scrollTop: $(event.target.hash).offset().top}, \"slow\", function() {\n        // Finally, set the correct hash in the address bar.\n        window.location.hash = href;\n      });\n    });\n  });\n});\n\n","/**\n * Initializes site-wide menu chrome functionality.\n */\n\ndefine('neue/menu',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  $(function() {\n    // Toggle dropdown menu navigation on mobile:\n    $(\".js-navigation-toggle\").on(\"touchstart mousedown\", function(e) {\n      e.preventDefault();\n\n      $(\".chrome\").toggleClass(\"has-mobile-menu\");\n      $(\".navigation\").toggleClass(\"is-visible\");\n    });\n\n    // Hide footer on mobile until clicked\n    var $collapsible = $(\".js-toggle-collapsed\");\n    $collapsible.addClass(\"is-collapsed is-toggleable\");\n    $collapsible.on(\"click\", function() {\n      if( window.matchMedia(\"screen and (max-width: 768px)\").matches ) {\n        $(this).toggleClass(\"is-collapsed\");\n      }\n    });\n  });\n});\n\n","/**\n * @module neue/messages\n * System Messages. Will create a close (\"X\") button\n * for users with JavaScript enabled that uses the following\n * syntax to hook into this function:\n *\n * @example\n * //  <div class=\"js-message\">Alert! You win.</div>\n *\n * @returns\n * // <div class=\"js-message\">Alert! You win.\n * //   <a href=\"#\" class=\"js-close-message\">x</a>\n * // </div>\n */\n\ndefine('neue/messages',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  var messageClose = \"<a href=\\\"#\\\" class=\\\"js-close-message messages__close\\\"><span>Close</span></a>\";\n\n  /**\n  * Adds a close button to system message banner, with optional callback.\n  *\n  * @param {jQuery}   $messages  Object containing message divs to be modified.\n  * @param {function} callback   Callback fired after message is closed.\n  */\n  var attachCloseButton = function($messages, callback) {\n    // Create message close button\n    $messages.append(messageClose);\n\n    // Close message when \"x\" is clicked:\n    $messages.on(\"click\", \".js-close-message\", function(event) {\n      event.preventDefault();\n      $(this).parent(\".messages\").slideUp();\n\n      if(callback && typeof callback === \"function\") {\n        callback();\n      }\n    });\n  };\n\n  // Prepare any messages in the DOM on load\n  $(function() {\n    attachCloseButton( $(\".messages\") );\n  });\n\n  return {\n    attachCloseButton: attachCloseButton\n  };\n});\n\n","/**\n * Indicates current section in nav on scroll. Applies an `.is-active`\n * class when the specified `href` reaches the top of the viewport.\n *\n * Triggered by a `.js-scroll-indicator` on a link.\n */\n\ndefine('neue/scroll-indicator',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n  var links = [];\n\n  /**\n   * @see _.throttle\n   */\n  var throttle = function(func, wait, options) {\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n\n    options || (options = {});\n\n    var later = function() {\n      previous = new Date();\n      timeout = null;\n      result = func.apply(context, args);\n    };\n\n    return function() {\n      var now = new Date();\n      if (!previous && options.leading === false) previous = now;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n\n      if (remaining <= 0) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n\n      return result;\n    };\n  };\n\n  /**\n   * @see _.sortedIndex\n   */\n  function sortedIndex(array, value, key) {\n    var low = 0,\n    high = array ? array.length : low;\n\n    while (low < high) {\n      var mid = (low + high) >>> 1; // jshint ignore:line\n      (array[mid][key] < value) ? low = mid + 1 : high = mid;\n    }\n\n    return low ? low - 1 : low;\n  }\n\n  /**\n   * Modified binary search. Finds target key, or next lowest if\n   * it doesn't exist.\n   * @see _.binarySearch\n   */\n  function binarySearch(array, value) {\n    var index = sortedIndex(array, value, \"offset\");\n    return array[index];\n  }\n\n  // Registers links and their targets with scroll handler\n  function prepareIndicator($link) {\n    // Calculate the element's offset from the top of the page while anchored\n    var $linkTarget = $( $link.attr(\"href\") );\n    if( $linkTarget.length ) {\n      // Add jQuery object and offset value to link map\n      links.push({ offset: $linkTarget.offset().top, link: $link });\n    }\n  }\n\n  // Prepare all `.js-scroll-indicator` links on the page.\n  function preparePage() {\n    links = [];\n\n    $(\".js-scroll-indicator\").find(\"a\").each(function(index, link) {\n      prepareIndicator( $(link) );\n    });\n  }\n\n  var oldIndicator;\n  // Scroll handler: highlights the furthest link the user has passed\n  function updateScrollIndicators() {\n    var newIndicator = binarySearch(links, $(window).scrollTop() + 40);\n    // @NOTE: We use a 40px offset to trigger indicator slightly after scroll position\n    // (so that nav switches closer to where a user will likely be reading the text)\n\n    if(newIndicator && newIndicator.link) {\n      var newIndicatorParents = newIndicator.link.parentsUntil(\".js-scroll-indicator\");\n      var oldIndicatorParents = $();\n\n      if(oldIndicator && oldIndicator !== newIndicator) {\n        oldIndicator.link.removeClass(\"is-active\");\n        oldIndicatorParents = oldIndicator.link.parentsUntil(\".js-scroll-indicator\");\n      }\n\n      newIndicator.link.addClass(\"is-active\");\n      newIndicatorParents.addClass(\"is-active\");\n      oldIndicatorParents.not(newIndicatorParents).removeClass(\"is-active\");\n\n      oldIndicator = newIndicator;\n    }\n  }\n\n  // Attach our functions to their respective events.\n  $(function() {\n    preparePage();\n\n    var throttledScroll = throttle(updateScrollIndicators, 60);\n\n    $(window).on(\"scroll\", throttledScroll);\n    $(window).on(\"resize\", preparePage);\n  });\n\n});\n\n\n","define('neue/tabs',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  var $tabs = $(\".js-tabs\"),\n      $tabMenuLinks = $tabs.find(\".tabs__menu a\");\n\n  // Show the first tab in any \"js-tabs\" collection.\n  $tabs.each(function() {\n    $(this).find(\".tabs__tab\").first().addClass(\"is-active\");\n  });\n\n  // View other tabs on click.\n  $tabMenuLinks.on(\"click\", function(event) {\n    event.preventDefault();\n\n    var $this = $(this),\n        $siblings = $this.parent().siblings(),\n        selection = $this.data(\"tab\") - 1,\n        $tabs = $this.closest(\".js-tabs\").find(\".tabs__tab\"),\n        tab = $tabs.get(selection);\n\n    $siblings.removeClass(\"is-active\");\n    $this.parent().addClass(\"is-active\");\n\n    // Show selected tab.\n    $tabs.removeClass(\"is-active\");\n    $(tab).addClass(\"is-active\");\n\n  });\n\n});\n\n","/**\n * Main build script. This will compile modules into `neue.js`\n * and `neue.min.js` in dist package, and attach each module to\n * a NEUE global variable attached to the window.\n */\n\ndefine('neue/main',['require','./carousel','./footnote','./jump-scroll','./menu','./messages','./scroll-indicator','./tabs'],function(require) {\n  \"use strict\";\n\n  // Attach modules to window\n  window.NEUE = {\n    Carousel: require(\"./carousel\"),\n    Footnote: require(\"./footnote\"),\n    JumpScroll: require(\"./jump-scroll\"),\n    Menu: require(\"./menu\"),\n    Messages: require(\"./messages\"),\n    ScrollIndicator: require(\"./scroll-indicator\"),\n    Tabs: require(\"./tabs\"),\n  };\n\n  return window.NEUE;\n});\n\ndefine('neue', ['neue/main'], function (main) { return main; });\n\n","define('campaign/SchoolFinder',['require','jquery','lodash','validation'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n  var Validation = require(\"validation\");\n\n  var shouldValidateForm = true;\n  var resultTpl = _.template(\"<li><a class='js-schoolfinder-result' data-gsid='<%- gsid %>' href='#'><span><%- name %></span> <em><%- city %>, <%- state %></em></a></li>\");\n\n  var getResults = function(state, query, limit, callback) {\n    var endpoint;\n    if(_.isEmpty(query) || _.isEmpty(state)) return callback([]);\n\n    try {\n      // Use Drupal dateFormat validation format if available\n      endpoint = Drupal.settings.dosomethingUser.schoolFinderAPIEndpoint;\n    } catch(e) {\n      endpoint = \"http://lofischools.herokuapp.com/search\";\n    }\n\n    $.ajax({\n      dataType: \"json\",\n      url: endpoint + \"?state=\" + state + \"&query=\" + query + \"&limit=\" + limit\n    }).done(function(data) {\n      callback(data.results, data.meta.more_results); // jshint ignore:line\n    }).fail(function() {\n      callback(false);\n    });\n  };\n\n  var displayResults = function($el, results, canShowMore) {\n    $el.empty();\n\n    if(!results) {\n      $el.append(\"<div class='messages error'>We couldn't load schools. Check your internet connection, or try refreshing the page.</div>\");\n      $el.show();\n      return;\n    }\n\n    _.each(results, function(result) {\n      $el.append(resultTpl(result));\n    });\n\n    if(results.length === 0) {\n      $el.append(\"<div class='messages error'>Hmm, we couldn't find your school based on how the name was entered. But it may still be there! Click on the link below for tips on finding your school.</div>\");\n    }\n\n    if(canShowMore) {\n      $el.append(\"<p class='schoolfinder-showmore'><a href='#' class='secondary js-schoolfinder-showmore'>Show More Results</a></p>\");\n    }\n\n    $el.show();\n  };\n\n  var initializeSchoolFinder = function($schoolSignupForm) {\n    var $stateField = $(\"#edit-school-administrative-area\");\n    var $schoolIDField = $schoolSignupForm.find(\"[name='school_id']\");\n    var $schoolSearchField = $schoolSignupForm.find(\".js-schoolfinder-search\");\n    var $schoolSearchResults = $schoolSignupForm.find(\".js-schoolfinder-results\");\n    var $notAffiliatedField = $(\"#edit-school-not-affiliated\");\n    var $notAffiliatedConfirmationMessage = $schoolSignupForm.find(\".js-school-not-affiliated-confirmation\");\n\n    var savedStateFieldState = \"\";\n    var getResultsThrottled = _.throttle(getResults, 1000);\n\n    // Set the form to default state.\n    $schoolSearchField.hide();\n    $schoolSearchResults.hide();\n\n    /**\n     * Event handler for the state select field.\n     */\n    $stateField.on(\"change\", function() {\n      // Show the school name field once user has chosen a state.\n      var stateSelected = $(this).val() !== \"\";\n      $schoolSignupForm.find(\".messages\").hide();\n      $schoolSearchField.val(\"\");\n      $schoolSearchField.trigger(\"keyup\");\n      $schoolSearchField.toggle(stateSelected);\n\n      if(stateSelected) {\n        $schoolSearchField.focus();\n      }\n    });\n\n    /**\n     * Event handler for school search field text input.\n     */\n    $schoolSearchField.on(\"keyup\", function() {\n      $schoolSignupForm.find(\".messages\").hide();\n      var val = $(this).val();\n\n      if(val !== \"\") {\n        $schoolSearchField.addClass(\"loading\");\n        getResultsThrottled( $stateField.val(), val, 10, function(res, moreAvailable) {\n          displayResults($schoolSearchResults, res, moreAvailable);\n          $schoolSearchField.removeClass(\"loading\");\n        });\n      } else {\n        $schoolSearchResults.hide();\n        $schoolIDField.val(\"\");\n      }\n    });\n\n    /**\n     * Event handler for clicking a result.\n     */\n    $schoolSearchResults.on(\"click\", \".js-schoolfinder-result\", function(e) {\n      e.preventDefault();\n\n      var $this = $(this);\n      $schoolIDField.val( $this.data(\"gsid\") );\n      $schoolSearchField.val( $this.find(\"span\").text() );\n\n      $this.addClass(\"is-selected\");\n      $this.parent(\"li\").siblings().hide();\n    });\n\n    /**\n     * Event handler for \"Show More\" link.\n     */\n    $schoolSignupForm.on(\"click\", \".js-schoolfinder-showmore\", function(e) {\n      e.preventDefault();\n\n      $(this).remove();\n\n      $schoolSearchField.addClass(\"loading\");\n      getResultsThrottled( $stateField.val(), $schoolSearchField.val(), 50, function(res) {\n        displayResults($schoolSearchResults, res, false);\n        $schoolSearchField.removeClass(\"loading\");\n      });\n    });\n\n    /**\n     * Event handler for the \"I'm not affiliated with a school\" checkbox.\n     */\n    $notAffiliatedField.on(\"change\", function() {\n      // If user is not entering a school, don't validate form.\n      shouldValidateForm = !this.checked;\n      $notAffiliatedConfirmationMessage.toggle(this.checked);\n\n      if(this.checked) {\n        savedStateFieldState = $stateField.val();\n        $stateField.val(\"\");\n        $schoolSearchField.val(\"\");\n        $schoolSearchField.trigger(\"keyup\");\n      } else {\n        $stateField.val(savedStateFieldState);\n        $notAffiliatedConfirmationMessage.hide();\n      }\n\n      $stateField.trigger(\"change\");\n    });\n\n    $schoolSignupForm.find(\".js-schoolfinder-help\").on(\"click\", function() {\n      $(\".js-schoolfinder-help-content\").toggle();\n    });\n  };\n\n  $(document).ready(function() {\n    var $schoolSignupForm = $(\"#dosomething-signup-user-signup-data-form\");\n    if( $schoolSignupForm ) {\n      initializeSchoolFinder($schoolSignupForm);\n    }\n  });\n\n  /**\n   * Custom validation for the School Finder.\n   */\n  Validation.registerValidationFunction(\"school_finder\", function($el, done) {\n    var $schoolID = $el.find(\"[name='school_id']\");\n\n    if(!shouldValidateForm) {\n      // User has selected \"I'm not affiliated\" checkbox. Skip validation.\n      return done({ success: true });\n    }\n\n    if($schoolID.val() === \"\") {\n      // User has not selected a school.\n      $el.addClass(\"shake\");\n\n      // Remove any existing error messages.\n      $el.find(\".messages.error\").remove();\n\n      $el.append(\"<div class='messages error'>You haven't entered your school. Find your school by entering your state and then selecting a school from the search results.</div>\");\n\n      return done({ success: false });\n    }\n\n    // User has selected a school.\n    return done({ success: true });\n  });\n\n});\n\n","define('campaign/ImageUploader',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n\n  var prepareImageUploadUI = function($context) {\n    // Toggle visibility of upload button and hide that guy\n    var $imageUploads = $context.find(\".js-image-upload\");\n\n    // @TODO: Not ideal location; will be refactored during new reportback implementation.\n    // This should actually sit within the Reportback.js code, but would need to implement\n    // an event that can respond to an image being uploaded. Temporarily placed here until\n    // upcoming refactor. (2014.11.18 - Diego)\n    var $caption       = $context.find(\".form-item-caption\");\n    var submittedImage = $context.find(\".submitted-image\").length === 0 ? false : true;\n\n    // If no prior submitted image is present, caption should be hidden.\n    if (!submittedImage) {\n      $caption.hide();\n    }\n\n    $imageUploads.each(function(i, el) {\n      $(el).wrap( $(\"<div class='image-upload-container'></div>\") );\n      var $container = $(el).parent(\".image-upload-container\");\n\n      $container.wrap(\"<div style='clear: both'></div>\");\n\n      var $uploadBtn = $(\"<a href='#' class='button -secondary'>\" + Drupal.t(\"Upload A Pic\") + \"</a>\");\n      $uploadBtn.insertAfter( $(el) );\n\n      var $imgPreview = $(\"<img class='preview' src=''>\");\n      $imgPreview.insertBefore( $container );\n      $imgPreview.hide();\n\n      var $fileName = $(\"<p class='filename'></p>\");\n      $fileName.insertAfter($uploadBtn);\n\n      // Show image preview on upload\n      $(el).on(\"change\", function(event) {\n        event.preventDefault();\n\n        // New image added, show the caption.\n        submittedImage = true;\n        $caption.show();\n\n        // Change button state\n        $uploadBtn.text(Drupal.t(\"Change Pic\"));\n\n        var files = !!this.files ? this.files : [];\n\n        // Show file name below field\n        if( files[0] && files[0].name ) {\n          $fileName.text( files[0].name );\n        } else {\n          var file = $(el).val().replace(\"C:\\\\fakepath\\\\\", \"\");\n          $fileName.text(file);\n        }\n\n        // If no file selected/no FileReader support, we're all done\n        if (!files.length || !window.FileReader) {\n          return;\n        }\n\n        if (/^image/.test( files[0].type)) {\n          var reader = new FileReader();\n          reader.readAsDataURL(files[0]);\n\n          reader.onloadend = function() {\n            $imgPreview.show();\n            $imgPreview.attr(\"src\", this.result);\n          };\n        }\n\n      });\n    });\n  };\n\n  // On DOM ready, we prepare any `.js-image-upload`s that we find on the page\n  $(function() {\n    $proveItSection = $('#prove');\n\n    if ($proveItSection.length && !$proveItSection.hasClass('reportback-beta')) {\n      prepareImageUploadUI( $(\"body\") );\n    }\n  });\n\n});\n\n","define('validators/auth',['require','validation','mailcheck'],function(require) {\n  \"use strict\";\n\n  var Validation= require(\"validation\");\n  var mailcheck = require(\"mailcheck\");\n\n  // # Helpers\n  // Basic sanity check used by email validation.\n  // This won't catch everything, but should prevent validating some simple mistakes\n  function isValidEmailSyntax(string) {\n    var email = string.toUpperCase();\n    if( email.match(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]+$/) ) {\n      var lastChar = \"\";\n      for(var i = 0, len = email.length; i < len; i++) {\n        // fail if we see two dots in a row\n        if(lastChar === \".\"  && email[i] === \".\") {\n          return false;\n        }\n\n        lastChar = email[i];\n      }\n\n      return true;\n    }\n\n    return false;\n  }\n\n  // @TODO: This will be removed when Neue's validation gets refactored.\n  function validateNotBlank(string, done, success, failure) {\n    if( string !== \"\" ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  // # Add validation functions...\n\n  // ## Name\n  // Greets the user when they enter their name.\n  Validation.registerValidationFunction(\"name\", function(string, done) {\n    validateNotBlank(string, done,\n      Drupal.t(\"Hey, @name!\", {\"@name\": string}),\n      Drupal.t(\"We need your first name.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"last_name\", function(string, done) {\n    validateNotBlank(string, done,\n      Drupal.t(\"Got it, @name!\", {\"@name\": string}),\n      Drupal.t(\"We need your last name.\")\n    );\n  });\n\n  // ## Birthday\n  // Validates correct date input, reasonable birthdate, and says a nice message.\n  Validation.registerValidationFunction(\"birthday\", function(string, done) {\n    var birthday, birthMonth, birthDay, birthYear, format;\n\n    try {\n      // Use Drupal dateFormat validation format if available\n      format = Drupal.settings.dsValidation.dateFormat;\n    } catch(e) {\n      format = \"MM/DD/YYYY\";\n    }\n\n    // parse date from string\n    if( format === \"MM/DD/YYYY\" && /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/.test(string) ) {\n      // US formatting\n      birthday = string.split(\"/\");\n      birthMonth = parseInt(birthday[0]);\n      birthDay = parseInt(birthday[1]);\n      birthYear = parseInt(birthday[2]);\n    } else if( format === \"DD/MM/YYYY\" && /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/.test(string) ) {\n      // UK formatting\n      birthday = string.split(\"/\");\n      birthDay = parseInt(birthday[0]);\n      birthMonth = parseInt(birthday[1]);\n      birthYear = parseInt(birthday[2]);\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Enter your birthday \" + format + \"!\")\n      });\n    }\n\n    // fail if incorrect month\n    if (birthMonth > 12 || birthMonth === 0) {\n      return done({\n        success: false,\n        message: Drupal.t(\"That doesn't seem right.\")\n      });\n    }\n\n    //list of last days in months and check for leap year\n    var endDates = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n    if(((birthYear % 4 === 0) && (birthYear % 100 !== 0)) || (birthYear % 400 === 0)){\n      endDates[2] = 29;\n    }\n\n    // fail if incorrect day\n    if (birthDay > endDates[birthMonth]) {\n      return done({\n        success: false,\n        message: Drupal.t(\"That doesn't seem right.\")\n      });\n    }\n\n    // calculate age\n    // Source: http://stackoverflow.com/questions/4060004/calculate-age-in-javascript#answer-7091965\n    var birthDate = new Date(birthYear, birthMonth - 1, birthDay);\n    var now = new Date();\n    var age = now.getFullYear() - birthDate.getFullYear();\n    var m = now.getMonth() - birthDate.getMonth();\n    if (m < 0 || (m === 0 && now.getDate() < birthDate.getDate())) {\n      age--;\n    }\n\n    if (age < 0)  {\n      return done({\n        success: false,\n        message: Drupal.t(\"Are you a time traveller?\")\n      });\n    } else if( age > 0 && age <= 25  ) {\n\n      if (birthDate.getMonth() === now.getMonth() && now.getDate() === birthDate.getDate() ) {\n        return done({\n          success: true,\n          message: Drupal.t(\"Wow, happy birthday!\")\n        });\n      } else if ( age < 10) {\n        return done({\n          success: true,\n          message: Drupal.t(\"Wow, you're @age!\", {\"@age\": age})\n        });\n      } else {\n        return done({\n          success: true,\n          message: Drupal.t(\"Cool, @age!\", {\"@age\": age})\n        });\n      }\n\n    } else if (age > 25 && age < 130) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Got it!\")\n      });\n    } else if (string === \"\") {\n      return done({\n        success: false,\n        message: Drupal.t(\"We need your birthday.\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"That doesn't seem right.\")\n      });\n    }\n  });\n\n  // ## Email\n  // Performs some basic sanity checks on email format (see helper method), and\n  // uses Kicksend's mailcheck library to offer suggestions for misspellings.\n  Validation.registerValidationFunction(\"email\", function(string, done) {\n    if ( isValidEmailSyntax(string) ) {\n      // we use mailcheck.js to find some common email mispellings\n      mailcheck.run({\n        email: string,\n        domains: [\"yahoo.com\", \"google.com\", \"hotmail.com\", \"gmail.com\", \"me.com\", \"aol.com\", \"mac.com\",\n                  \"live.com\", \"comcast.net\", \"googlemail.com\", \"msn.com\", \"hotmail.co.uk\", \"yahoo.co.uk\",\n                  \"facebook.com\", \"verizon.net\", \"sbcglobal.net\", \"att.net\", \"gmx.com\", \"mail.com\", \"outlook.com\",\n                  \"aim.com\", \"ymail.com\", \"rocketmail.com\", \"bellsouth.net\", \"cox.net\", \"charter.net\", \"me.com\",\n                  \"earthlink.net\", \"optonline.net\", \"dosomething.org\"],\n        suggested: function(s) {\n          return done({\n            success: true,\n            suggestion: s\n          });\n        },\n        empty: function() {\n          return done({\n            success: true,\n            message: Drupal.t(\"Great, thanks!\")\n          });\n        }\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"We need a valid email.\")\n      });\n    }\n  });\n\n  // ## Password\n  // Checks that password is 6 or more characters long.\n  // Matches validation performed in dosomething_user.module.\n  Validation.registerValidationFunction(\"password\", function(string, done) {\n    if(string.length >= 6) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Keep it secret, keep it safe!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Must be 6+ characters.\")\n      });\n    }\n  });\n\n  // ## Phone\n  // Matches validation performed in dosomething_user.module.\n  Validation.registerValidationFunction(\"phone\", function(string, done) {\n    // Matches server-side validation from `dosomething_user_valid_cell()` in `dosomething_user.module`.\n    var numberWithoutFormatting = string.replace(/[\\-\\s\\.]/g, \"\");\n    var isValidFormat = /^(?:\\+?([0-9]{1,3})([\\-\\s\\.]{1})?)?\\(?([0-9]{3})\\)?(?:[\\-\\s\\.]{1})?([0-9]{3})(?:[\\-\\s\\.]{1})?([0-9]{4})/.test(numberWithoutFormatting);\n\n    var sanitizedNumber = string.replace(/[^0-9]/g, \"\");\n    var allRepeatingDigits = /([0-9]{1})\\1{9,}/.test(sanitizedNumber);\n\n    if(isValidFormat && !allRepeatingDigits) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Thanks!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Enter a valid telephone number.\")\n      });\n    }\n  });\n});\n\n","define('validators/reportback',['require','validation','jquery'],function(require) {\n  \"use strict\";\n\n  var Validation = require(\"validation\");\n  var $          = require(\"jquery\");\n\n  // validate number of items\n  Validation.registerValidationFunction(\"positiveInteger\", function(string, done) {\n    var trimmedString = string.replace(\" \", \"\");\n    if( trimmedString !== \"\" && /^[1-9]\\d*$/.test(trimmedString) ) {\n      return done({\n        success: true,\n        message: Drupal.t(\"That's great!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Enter a valid number!\")\n      });\n    }\n  });\n\n  // validate that string isn't blank\n  Validation.registerValidationFunction(\"reportbackReason\", function(string, done) {\n    if( string !== \"\" ) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Thanks for caring!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Tell us why you cared!\")\n      });\n    }\n  });\n\n  // validate that string isn't blank and less than or equal to 60 characters\n  Validation.registerValidationFunction(\"caption\", function(string, done) {\n    if( string !== \"\" && string.length <= 60 ) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Sounds great!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Tell us about your photo in 60 characters or less!\")\n      });\n    }\n  });\n});\n\n","define('validators/address',['require','jquery','validation'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var Validation= require(\"validation\");\n\n  /** @NOTE: Temporary, testing out some new ideas. */\n  var requiredValidator = function(string, done, args) {\n    if( string !== \"\" ) {\n      return done({\n        success: true,\n        message: args.success\n      });\n    } else {\n      return done({\n        success: false,\n        message: args.failure\n      });\n    }\n  };\n\n  /**\n   * Validators for individual address form fields:\n   */\n  Validation.registerValidationFunction(\"fname\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Oh hey, @fname!\", {\"@fname\": string}),\n      failure: Drupal.t(\"We need your name. We’re on a first-name basis, right?\")\n    });\n  });\n\n  Validation.registerValidationFunction(\"lname\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"The @lname-inator! People call you that, right?\", {\"@lname\": string}),\n      failure: Drupal.t(\"We need your last name.\")\n\n    });\n  });\n\n  Validation.registerValidationFunction(\"address1\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Got it!\"),\n      failure: Drupal.t(\"We need your street name and number.\")\n    });\n  });\n\n  Validation.registerValidationFunction(\"address2\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Got that too!\"),\n      failure: \"\"\n    });\n  });\n\n  Validation.registerValidationFunction(\"city\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Sweet, thanks!\"),\n      failure: Drupal.t(\"We need your city.\")\n    });\n  });\n\n  Validation.registerValidationFunction(\"state\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"I \\u2764 @state\", {\"@state\": string}),\n      failure: Drupal.t(\"We need your state.\")\n    });\n  });\n\n  Validation.registerValidationFunction(\"zipcode\", function(string, done) {\n    if( string.match(/^\\d{5}(?:[-\\s]\\d{4})?$/) ) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Almost done!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"We need your zip code.\")\n      });\n    }\n  });\n\n  Validation.registerValidationFunction(\"why_signedup\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Thanks for caring!\"),\n      failure: Drupal.t(\"Oops! Can't leave this one blank.\")\n    });\n  });\n\n\n  /**\n   * Custom validation for UPS address fieldset.\n   */\n  Validation.registerValidationFunction(\"ups_address\", function($el, done) {\n    var $sorryError = $(\n      \"<div class='messages error'>\" +\n        \"<strong>\" + Drupal.t(\"We couldn't find that address.\") + \"</strong>\" +\n        Drupal.t(\"Double check for typos and try submitting again.\") +\n      \"</div>\"\n    );\n\n    var $networkError= $(\n      \"<div class='messages error'>\" +\n        Drupal.t(\"We're having trouble submitting the form, are you sure your internet connection is working? Email us if you continue having problems.\") +\n      \"</div>\"\n    );\n\n    var addressFieldData = $el.find(\"select, input\").serializeArray();\n\n    // Remove previous messages.\n    $el.find(\".messages\").slideUp(function() { $(this).remove(); });\n\n    // Once we know we have, submit them to the AJAX endpoint\n    $.ajax({\n      type: \"POST\",\n      url: \"/user/validate/address\",\n      dataType: \"json\",\n      data: addressFieldData,\n      success: function(data) {\n\n        if(data.sorry) {\n          // Address is invalid and we don't have any suggestions\n          $el.append($sorryError).hide().slideDown();\n          return done({ success: false });\n        }\n\n        var hasFieldErrors = false;\n        for(var field in data) {\n          if(data.hasOwnProperty(field) && field !== \"ambiguous\") {\n            var suggestion = data[field];\n            var $fieldEl = $el.find(\"[name='user_address[\" + field + \"]']\");\n\n            // If just capitalizing or adding extra 4-digit to zip, don't show an error\n            if(  (field === \"postal_code\" && $fieldEl.val().slice(0,4) === suggestion.slice(0,4)) || (suggestion === $fieldEl.val().toUpperCase() ) ) {\n              $fieldEl.val( suggestion  );\n            } else {\n              // Otherwise, mark errors and ask user to correct them\n              hasFieldErrors = true;\n\n              Validation.showValidationMessage($fieldEl, {\n                success: false,\n                suggestion: {\n                  full: suggestion,\n                  domain: \"zip\"\n                }\n              });\n            }\n          }\n        }\n\n        if(hasFieldErrors) {\n          done({ success: false });\n        } else {\n          done({ success: true });\n        }\n\n      },\n      error: function() {\n        // We're having trouble getting the validation over AJAX, let's mark as\n        // validated and leave it up to the server just to be safe.\n        $el.append($networkError).hide().slideDown();\n        done({ success: false });\n      }\n    });\n  });\n\n\n  /**\n   * Validators for shirt reward fields:\n   */\n  Validation.registerValidationFunction(\"shirt_size\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"It'll fit great!\"),\n      failure: Drupal.t(\"We need a shirt size!\")\n    });\n  });\n\n  // Shirt style validor\n  // @TODO: add support to radio button validation in Neue\n  Validation.registerValidationFunction(\"shirt_style\", function($el, done) {\n    // collected checked radio's\n    var $checked = $el.find(\"input[type='radio']:checked\");\n\n    // message that will be injected upon error\n    var $errorMsg = $(\n      \"<div class='message error'>\" + Drupal.t(\"We need a shirt style!\") + \"</div>\"\n    );\n\n    // remove the error message before validation\n    $el.find(\".message\").remove();\n\n    if ($checked.length === 1) {\n      done({ success: true });\n    } else {\n      $el.find(\"label:first\").append($errorMsg);\n      done({ success: false });\n    }\n  });\n\n});\n\n","define('validators/donate',['require','validation'],function(require) {\n  \"use strict\";\n\n  var Validation= require(\"validation\");\n\n  // Credit card types\n  var cardTypes = {\n    Visa: {\n      name: \"Visa\",\n      numberPattern: /^4[0-9]{12}(?:[0-9]{3})?$/\n    },\n    Mastercard: {\n      name: \"MasterCard\",\n      numberPattern: /^5[1-5][0-9]{14}$/\n    },\n    AmericanExpress: {\n      name: \"American Express\",\n      numberPattern: /^3[47][0-9]{13}$/\n    },\n    DinersClub: {\n      name: \"Diners Club\",\n      numberPattern: /^3(?:0[0-5]|[68][0-9])[0-9]{11}$/\n    },\n    Discover: {\n      name: \"Discover\",\n      numberPattern: /^6(?:011|5[0-9]{2})[0-9]{12}$/\n    },\n    JCB: {\n      name: \"JCB\",\n      numberPattern: /^(?:2131|1800|35\\d{3})\\d{11}$/\n    }\n  };\n\n  /**\n  * Validates string for a number\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function isDigit(string) {\n    return (/^\\d+$/).test(string);\n  }\n\n  /**\n  * Validates string for credit card cvv\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function isValidCVV(string) {\n    return (/^\\d{3,4}$/).test(string);\n  }\n\n  /**\n  * Validates string for a valid month [MM]\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function isValidMonth(string) {\n    return (/^(0?[1-9]|1[0-2])$/).test(string);\n  }\n\n  /**\n  * Validates string for a valid year [YYYY]\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function isValidYear(string) {\n    return (/^[1-9]\\d{3,}$/).test(string);\n  }\n\n\n  // @TODO: This will be removed when Neue's validation gets refactored.\n  function validateNotBlank(string, done, success, failure) {\n    if( string !== \"\" ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  // @TODO: This will be removed when Neue's validation gets refactored.\n  function validateDigit(string, done, success, failure) {\n    if( isDigit(string) ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  /**\n  * Validates string for a valid credit card number\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function validateCreditCardNumber(string, done, success, failure) {\n    var found = null;\n    for (var key in cardTypes) {\n      var card = cardTypes[key];\n      if (card.numberPattern.test(string)) {\n        found = card;\n      }\n    }\n    if (found) {\n      return done({\n        success: true,\n        message: found.name + \" \" + success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  /**\n  * Validates string for a valid cvv\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function validateCvv(string, done, success, failure) {\n    if ( isValidCVV(string) ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  /**\n  * Validates string for a valid expiration month\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function validateExpMonth(string, done, success, failure) {\n    if ( isValidMonth(string)) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  /**\n  * Validates string for a valid expiration year\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function validateExpYear(string, done, success, failure) {\n    if ( isValidYear(string) ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  // # Add validation functions...\n\n  Validation.registerValidationFunction(\"full_name\", function(string, done) {\n    validateNotBlank(string, done,\n      Drupal.t(\"Hey, @name!\", {\"@name\": string}),\n      Drupal.t(\"We need your full name.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"cc_num\", function(string, done) {\n    validateCreditCardNumber(string, done,\n      Drupal.t(\"number looks good!\"),\n      Drupal.t(\"Invalid credit card number.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"cvv\", function(string, done) {\n    validateCvv(string, done,\n      Drupal.t(\"CVV looks good!\"),\n      Drupal.t(\"Invalid CVV.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"exp_month\", function(string, done) {\n    validateExpMonth(string, done,\n      Drupal.t(\"Good Month!\"),\n      Drupal.t(\"Invalid Month.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"exp_year\", function(string, done) {\n    validateExpYear(string, done,\n      Drupal.t(\"Good Year!\"),\n      Drupal.t(\"Invalid Year.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"amount\", function(string, done) {\n    validateDigit(string, done,\n      Drupal.t(\"So Generous!\"),\n      Drupal.t(\"Invalid Amount.\")\n    );\n  });\n\n});\n\n","/**\n * @module Analytics\n * Uses Google Analytics custom events API to fire events for client-side\n * Modal and Form Validation flows.\n */\ndefine('Analytics',[\"validation\", \"modal\"], function(Validation, Modal) {\n  \"use strict\";\n\n  // We'll only fire GA Custom Events if the GA object exists\n  if(typeof(_gaq) !== \"undefined\" && _gaq !== null) {\n    // Validation\n    Validation.Events.subscribe(\"Validation:InlineError\", function(topic, args) {\n      _gaq.push([\"_trackEvent\", \"Form\", \"Inline Validation Error\", args, null, true]);\n    });\n\n    Validation.Events.subscribe(\"Validation:Suggestion\", function(topic, args) {\n      _gaq.push([\"_trackEvent\", \"Form\", \"Suggestion\", args, null, true]);\n    });\n\n    Validation.Events.subscribe(\"Validation:SuggestionUsed\", function(topic, args) {\n      _gaq.push([\"_trackEvent\", \"Form\", \"Suggestion Used\", args, null, true]);\n    });\n\n    Validation.Events.subscribe(\"Validation:Submitted\", function(topic, args) {\n      _gaq.push([\"_trackEvent\", \"Form\", \"Submitted\", args, null, false]);\n    });\n\n    Validation.Events.subscribe(\"Validation:SubmitError\", function(topic, args) {\n      _gaq.push([\"_trackEvent\", \"Form\", \"Validation Error on submit\", args, null, true]);\n    });\n\n    // Modals\n    Modal.Events.subscribe(\"Modal:Open\", function(topic, args) {\n      _gaq.push([\"_trackEvent\", \"Modal\", \"Open\", \"#\" + args.attr(\"id\"), null, true]);\n    });\n\n    Modal.Events.subscribe(\"Modal:Close\", function(topic, args) {\n      _gaq.push([\"_trackEvent\", \"Modal\", \"Close\", \"#\" + args.attr(\"id\"), null, true]);\n    });\n  }\n\n});\n\n","define('tiles',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n\n  // Lazy-load in tile images\n  $(\".tile\").find(\"img\").unveil(200, function() {\n    $(this).load(function() {\n      this.style.opacity = 1;\n    });\n  });\n\n\n  /**\n   * This is a temporary fix until the next Neue release!\n   * @TODO: Remove when Neue 6.0.0-beta5 is merged in!\n   *\n   * Replace the `video` tag in a tile with a static image, based on either the `poster`\n   * attribute of the video, or an included `img` fallback source.\n   */\n  function replaceVideoWithImage() {\n    var poster = $(this).attr('poster') || $(this).find('img').attr('src');\n    $(this).replaceWith($(\"<img>\").attr('src', poster));\n  }\n\n  // On Mobile Safari, we need to replace `<video>` with a static image so the \"play\" control does not appear.\n  // Yes, this is browser sniffing - but we're fixing a browser-specific quirk so I don't think it's evil.\n  if (window.navigator.userAgent.match(/iPad/i) || window.navigator.userAgent.match(/iPhone/i)) {\n    $(function() {\n      $(\".tile video\").each(replaceVideoWithImage);\n    });\n  }\n\n});\n\n"]}