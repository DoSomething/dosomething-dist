{"version":3,"file":"app.js","sources":["text.js","finder/templates/campaign.tpl.html!text","finder/Campaign.js","text!finder/templates/no-results.tpl.html","finder/ResultsView.js","finder/SolrAdapter.js","finder/templates/error.tpl.html!text","finder/FormView.js","finder/Finder.js","StripeForm.js","donate/Donate.js","revealer/Revealer.js","swapper/Swapper.js","../../bower_components/dosomething-modal/js/events.js","../../bower_components/dosomething-modal/js/modal.js","../../bower_components/dosomething-validation/js/events.js","../../bower_components/dosomething-validation/js/validation.js","images/ImageCrop.js","images/ImageCropPreview.js","images/ImageUpload.js","text!images/templates/fallback-upload-interface.tpl.html","images/ImageUploadFallback.js","reportback/templates/reportback.tpl.html!text","reportback/Reportback.js","../../bower_components/neue/js/footnote.js","../../bower_components/neue/js/jump-scroll.js","../../bower_components/neue/js/menu.js","../../bower_components/neue/js/messages.js","../../bower_components/neue/js/scroll-indicator.js","../../bower_components/neue/js/tabs.js","../../bower_components/neue/js/main.js","campaign/SchoolFinder.js","validators/auth.js","validators/reportback.js","validators/address.js","validators/donate.js","Analytics.js","tiles.js"],"names":["define","load","id","Error","require","$","_","campaignTplSrc","Campaign","data","defaults","title","description","url","staffPick","featured","extend","this","convert","prototype","newData","map","label","sm_field_call_to_action","bs_field_staff_pick","bs_sticky","ss_field_search_image_400x400","i","undefined","render","$wrapper","template","image","noResultsTplSrc","ResultsView","$container","$gallery","$blankSlateDiv","slots","maxSlots","start","init","paginateAction","clearFormAction","hide","$paginationLink","Drupal","t","on","event","preventDefault","showBlankSlate","show","showEmptyState","message","append","parseResults","clear","retrieved","result","response","docs","add","showPaginationLink","numFound","loading","showLink","remove","appendResults","setTo","toggleClass","checkInit","empty","campaign","find","unveil","style","opacity","window","solrResponse","SolrAdapter","throttleTimeout","baseURL","settings","dosomethingSearch","solrURL","collection","throttle","defaultQuery","fieldMap","cause","time","action-type","fieldMapInverse","responseData","invert","throttledQuery","checkedFields","offset","responseCallback","clearTimeout","setTimeout","query","clone","push","q","forOwn","fields","fieldGroup","isEmpty","param","join","powerset","generatePowerset","length","encodeURIComponent","xhr","abort","ajax","dataType","cache","jsonpCallback","buildQuery","success","error","errorType","jsonp","pos","bubble","params","ary","ps","j","len","concat","variations","errorTplSrc","FormView","$div","$searchButton","$fields","lastChanged","cssBreakpoint","queryCallback","click","$this","$parent","parents","$siblings","siblings","outerWidth","hasClass","addClass","removeClass","each","idx","element","field","prop","val","change","is","attr","animate","scrollTop","showErrorMessage","after","hasCheckedFields","hasChecked","filter","getCheckedFields","groupName","checked","index","e","disableFields","results","key","keyArr","split","value","$checkboxes","disabled","$checkbox","Finder","$formContainer","$resultsContainer","$blankSlate","queryOffset","displayResults","Stripe","StripeForm","$form","publishKey","parent","_this","setPublishableKey","ev","isValid","card","createToken","status","onFormSubmit","text","token","get","submit","$donateForm","Donate","stripeAPIPublishKey","dosomethingPayment","stripeAPIPublish","html","Revealer","$content","category","initialItems","stepItems","$button","step","steps","items","count","prepGalleryItems","detachContent","enableButton","detach","reattachContent","content","insertAfter","shift","slice","makeArray","splice","Swapper","$image","srcLarge","exchange","topics","subUid","publish","topic","args","subscribers","func","subscribe","toString","unsubscribe","m","jQuery","Modernizr","Events","modalReady","queuedModal","$document","document","$chrome","$modalContainer","$skipLink","$closeLink","$modal","closeable","isOpen","_addCloseButton","$el","type","skipForm","prepend","open","options","animated","closeButton","offsetTop","css","cssanimations","_cleanup","scrollOffset","close","parseInt","location","hash","one","_openHandler","href","_closeHandler","target","ready","$body","appendTo","DS","Modal","main","validations","prepareFields","$field","prepareLabel","validateField","$label","$innerLabel","force","callback","showValidationMessage","validation","validationTrigger","isFormField","fieldValue","matchFieldValue","fn","$matchField","registerValidation","name","registerValidationFunction","v","fieldMessageHeight","$fieldLabel","$fieldValidation","$fieldMessage","fieldLabelHeight","height","suggestion","full","domain","closest","trigger","disableFormSubmit","$submitButton","enableFormSubmit","tag","isValidated","$validationFields","validatedFields","validatedResults","scrolledToError","top","string","secondString","done","Validation","Validations","xInitPos","yInitPos","offsetLeft","initialCropBoxHeight","initialCropBoxWidth","previewImageWidth","previewImageHeight","$previewImage","origImage","moveRight","moveDown","resizeHorizontal","resizeVertical","minScaled","resizeState","dragState","minimum","$cropBox","resizeClickPositionX","resizeClickPositionY","scale","degrees","getCoords","coords","eventType","originalEvent","targetTouches","pageX","pageY","getMinimumSize","getCropBoxSize","width","cropBoxSize","orientation","halfWidth","halfHeight","getTranslateDifference","translateDiff","onMouseDown","requestAnimationFrame","dragBox","resizeBox","onMouseUp","onMouseMove","cropBoxHeight","cropBoxWidth","cropBoxTop","cropBoxLeft","withinLeftBounds","withinTopBounds","widthMax","heightMax","increasingSize","decreasingSize","croppingReset","off","setupCrop","$cropContainer","left","Math","floor","insertBefore","rotateImage","transform","populateFields","$cropX","$cropY","$cropWidth","$cropHeight","$cropRotation","$captionField","caption","cropValues","round","outerHeight","dsCropperInit","wrap","$rotateButton","$cropPreview","$reportbackSubmissions","$reportbackUploadBtn","firstSubmission","getCropPreviewValues","imageWidth","imageHeight","cropPreviewSize","horizontalScale","verticalScale","newWidth","newHeight","x","y","setUpCropPreview","$lastestSubmission","$reportbackSubmissionsList","submissionCount","prependTo","cropPreview","src","cropPreviewValues","$reportbackCaption","ImageCrop","ImageCropPreview","ImageUpload","$uploadButton","$uploadButtonLabel","$cropModal","$reportbackForm","$imageForm","$imageCaption","$cropButton","$imagePreview","imageValues","readyToSave","fileTypes","fileSizeLimit","typeError","dimensionsError","sizeError","files","FileReader","validImageType","showError","validFileSize","fr","navigator","userAgent","match","readAsArrayBuffer","onload","blob","getStrippedBlob","urlCreator","URL","webkitURL","imageUrl","createObjectURL","loadImage","readAsDataURL","onloadend","resetFileField","moveUploadButton","createEditButton","validateCaption","engageImageCrop","getCropValues","openModal","enableSubmit","$input","replaceWith","$editButton","before","validImageSize","extension","indexOf","size","removeError","$errorMsg","msg","$error","resizeImage","containerMaxWidth","previewImage","$imageContainer","$preview","Image","isValidSize","fileReaderResult","generatedBlob","dataView","DataView","recess","pieces","getUint16","app1","byteLength","newPieces","forEach","Blob","fallbackUploadTplSrc","ImageUploadFallback","component","$fileInterface","$indicator","fileName","classes","container","activateInput","getFileName","updateFileSelection","buildUpatedComponent","emptyContainer","path","substring","file","$markup","insertUpdatedComponent","reportbackTplSrc","Reportback","$initialGallery","$extendedGallery","$viewMoreContainer","$viewMoreButton","$spinner","apiUrl","nid","itemsPrefetched","itemsTotal","bundleSize","requestSize","inventory","currentIndex","galleryInDom","reportbackContainer","$reportbackWrapper","buildApiUrl","enableViewMore","enableResponsive","filereader","imageUploadInit","appendEntries","inventoryIndex","end","$cluster","$images","outOfStock","insertGallery","disableViewMore","isLargerMedia","evaluateInventory","debounce","lowInventory","request","quantity","beforeSend","templatize","fail","always","rbid","isListItem","markup","wrapInner","slideToggle","$collapsible","matchMedia","matches","messageClose","attachCloseButton","$messages","slideUp","sortedIndex","array","low","high","mid","binarySearch","prepareIndicator","$link","$linkTarget","links","link","preparePage","updateScrollIndicators","newIndicator","newIndicatorParents","parentsUntil","oldIndicatorParents","oldIndicator","not","wait","context","timeout","previous","later","Date","apply","now","leading","remaining","arguments","trailing","throttledScroll","$tabs","$tabMenuLinks","first","selection","tab","NEUE","Footnote","JumpScroll","Menu","Messages","ScrollIndicator","Tabs","shouldValidateForm","resultTpl","getResults","state","limit","endpoint","dosomethingUser","schoolFinderAPIEndpoint","meta","more_results","canShowMore","initializeSchoolFinder","$schoolSignupForm","$stateField","$schoolIDField","$schoolSearchField","$schoolSearchResults","$notAffiliatedField","$notAffiliatedConfirmationMessage","savedStateFieldState","getResultsThrottled","stateSelected","toggle","focus","res","moreAvailable","$schoolID","isValidEmailSyntax","email","toUpperCase","lastChar","validateNotBlank","failure","mailcheck","@name","birthday","birthMonth","birthDay","birthYear","format","dsValidation","dateFormat","test","endDates","birthDate","age","getFullYear","getMonth","getDate","@age","run","domains","suggested","s","numberWithoutFormatting","replace","isValidFormat","sanitizedNumber","allRepeatingDigits","trimmedString","requiredValidator","@fname","@lname","@state","$sorryError","$networkError","addressFieldData","serializeArray","sorry","slideDown","hasFieldErrors","hasOwnProperty","$fieldEl","$checked","isDigit","isValidCVV","isValidMonth","isValidYear","validateDigit","validateCreditCardNumber","found","cardTypes","numberPattern","validateCvv","validateExpMonth","validateExpYear","Visa","Mastercard","AmericanExpress","DinersClub","Discover","JCB","ga","replaceVideoWithImage","poster","fixedsticky","$campaignFinderForm","$results","$revealGalleries","galleryList","gallery","$tiles","isMosaicGallery","$mosaicGalleries","swappedImagesList","$featureTile","$reportback","windowOptions","winHeight","screen","winWidth"],"mappings":"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","sourcesContent":["define('text',{load: function(id){throw new Error(\"Dynamic load not allowed: \" + id);}});\n","\ndefine('text!finder/templates/campaign.tpl.html',[],function () { return '<li>\\n<article class=\"tile\">\\n  <a class=\"wrapper\" href=\"<%= url %>\">\\n    <% if(staffPick) {  %><div class=\"tile__flag -staff-pick\"><%= Drupal.t(\"Staff Pick\") %></div><% } %>\\n    <div class=\"tile__meta\">\\n      <h1 class=\"tile__title\"><%= title %></h1>\\n      <p class=\"tile__tagline\"><%= description %></p>\\n    </div>\\n    <img src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"<%= image %>\">\\n  </a>\\n</article>\\n</li>\\n';});\n\n","define('finder/Campaign',['require','jquery','lodash','text!finder/templates/campaign.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n  var campaignTplSrc =  require(\"text!finder/templates/campaign.tpl.html\");\n\n  /**\n   * Campaign JS object representation\n   * @param {Object} data The raw campaign data\n   */\n  var Campaign = function (data) {\n    // Default values for a newly created campaign\n    var defaults = {\n      title: \"\",\n      description: \"\",\n      url: \"#\",\n      staffPick: false,\n      featured: false\n    };\n\n    // Merge the campaign object from data with the defaults into\n    // this campaign object\n    $.extend(this, defaults, this.convert(data));\n  };\n\n  /**\n   * Convert fields from the Solr results to relevant local, friendlier\n   * field names.\n   *\n   * @param  {Object} data The raw campaign object\n   *\n   * @return {Object} The new data translated and ignoring\n   */\n  Campaign.prototype.convert = function (data) {\n    var newData = {};\n    var map = {\n      \"label\": \"title\",\n      \"sm_field_call_to_action\": \"description\",\n      \"url\": \"url\",\n      \"bs_field_staff_pick\": \"staffPick\",\n      \"bs_sticky\": \"featured\",\n      \"ss_field_search_image_400x400\": \"image\"\n    };\n\n    // Only populate fields that we care about from the map.\n    for (var i in data) {\n      if (map[i] !== undefined) {\n        newData[map[i]] = data[i];\n      }\n    }\n\n    return newData;\n  };\n\n  /**\n   * Render a campaign\n   * @return {jQuery} The jQuery object that is the rendered representation of this Campaign\n   */\n  Campaign.prototype.render = function () {\n    var $wrapper = _.template(campaignTplSrc, {\n      \"image\": this.image,\n      \"staffPick\": this.staffPick,\n      \"featured\": this.featured,\n      \"title\": this.title,\n      \"description\": this.description,\n      \"url\": this.url\n    });\n\n    return $wrapper;\n  };\n\n  return Campaign;\n});\n\n","\ndefine('text!finder/templates/no-results.tpl.html',[],function () { return '<div class=\"no-result\">\\n  <div class=\"wrapper\">\\n    <p class=\"message\"><%= Drupal.t(\"Oh snap! We\\'ll work on that.\") %></p>\\n    <p>\\n      <a id=\"reset-filters\" href=\"/\">\\n        <%= Drupal.t(\"Want to try another combo?\") %>\\n      </a>\\n    </p>\\n  </div>\\n</div>\\n';});\n\n","define('finder/ResultsView',['require','jquery','lodash','finder/Campaign','text!finder/templates/no-results.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n  var Campaign = require(\"finder/Campaign\");\n  var noResultsTplSrc = require(\"text!finder/templates/no-results.tpl.html\");\n\n  /**\n   * ResultsView manages search results from Finder\n   * @type {Object}\n   */\n  var ResultsView = {\n    // The container element where the results go\n    $container: null,\n\n    // The gallery located in the container\n    $gallery: $(\"<ul class='gallery -quartet -mosaic'></ul>\"),\n\n    // The div that is shown if no filters are selected\n    $blankSlateDiv: null,\n\n    // How many slots are currently used. Full-height = 2, half-height = 1\n    slots: 0,\n\n    // How many slots are we allowing\n    maxSlots: 8,\n\n    // For tracking what page we're on\n    start: 0,\n\n    /**\n     * Construct the cloneables and set the parent div where the results go\n     * @param  {jQuery} $container        The container element where the results will live\n     * @param  {jQuery} $blankSlateDiv    The div containing initial pre-filtered state\n     * @param  {function} paginateAction  Function to query next page of results.\n     */\n    init: function ($container, $blankSlateDiv, paginateAction, clearFormAction) {\n      ResultsView.$container = $container;\n      ResultsView.$container.hide();\n\n\n      ResultsView.$paginationLink = $(\n        \"<div class='pagination-link'><a href='#' class='secondary js-finder-show-more'>\" +\n          Drupal.t(\"Show More\") +\n        \"</a></div>\"\n      );\n\n      $(\"body\").on(\"click\", \".js-finder-show-more\", function(event) {\n        event.preventDefault();\n        paginateAction(ResultsView.start);\n      });\n\n      ResultsView.$blankSlateDiv = $blankSlateDiv;\n\n      ResultsView.$container.on(\"click\", \"#reset-filters\", function(event) {\n        event.preventDefault();\n\n        ResultsView.showBlankSlate();\n\n        // TODO: Maybe allow for FormView.clear() to be called from ResultsView so\n        // it doesn't have to be passed in as an argument to the init().\n        clearFormAction();\n      });\n    },\n\n    /**\n     * Shows the blank slate div (initial state).\n     */\n    showBlankSlate: function() {\n      ResultsView.$container.hide();\n      ResultsView.$blankSlateDiv.show();\n    },\n\n    /**\n     * Shows the empty slate div (no results state).\n     */\n    showEmptyState: function() {\n      var message = _.template(noResultsTplSrc);\n\n      ResultsView.$container.append(message);\n    },\n\n    /**\n     * Replace current results with new data\n     * @param  {Object} data The raw data from the query\n     */\n    parseResults: function (data) {\n      // Remove the old results\n      ResultsView.clear();\n\n      if (data.retrieved > 0) {\n        // Results view cleared, and since we have results add the gallery into the container.\n        ResultsView.$container.append(ResultsView.$gallery);\n\n        // Loopy loop! (Like me after drinking coffeeeee)\n        for (var i in data.result.response.docs) {\n          ResultsView.add(new Campaign(data.result.response.docs[i]));\n        }\n\n        // There are more results than we've shown so far, add \"Show More\" button\n        ResultsView.showPaginationLink(data.result.response.numFound > ResultsView.start);\n      } else {\n        ResultsView.showEmptyState();\n      }\n\n      // Hey! We're done loading! I guess we can let the users know we're done.\n      ResultsView.loading(false);\n    },\n\n    /**\n     * Show or hide pagination link.\n     * @param {boolean} showLink    Should link be shown?\n     */\n    showPaginationLink: function(showLink) {\n      ResultsView.$paginationLink.remove();\n\n      if(showLink) {\n        ResultsView.$container.append(ResultsView.$paginationLink);\n        ResultsView.$paginationLink.show();\n      }\n    },\n\n    /**\n     * Append to current results with new data.\n     * @param  {Object} data The raw data from the query\n     */\n    appendResults: function (data) {\n      // Add those results to the page!\n      for (var i in data.result.response.docs) {\n        ResultsView.add(new Campaign(data.result.response.docs[i]));\n      }\n\n      // There are more results than we've shown so far, add \"Show More\" button\n      ResultsView.showPaginationLink(data.result.response.numFound > ResultsView.start);\n\n      // Hey! We're done loading! I guess we can let the users know we're done.\n      ResultsView.loading(false);\n    },\n\n    /**\n     * Toggle the loading indicator for the results div\n     * @param  {boolean} setTo Should I stay or should I go? If I go there will be trouble...or clicking.\n     */\n    loading: function (setTo) {\n      // Allow the function to be called without a parameter, since X.loading() would seem\n      // to be a logical call.\n      if (setTo === undefined) {\n        setTo = true;\n      }\n\n      // If we're loading, add a class to the results div. Otherwise, remove it.\n      ResultsView.$container.append(\"<div class='spinner'></div>\");\n      ResultsView.$container.toggleClass(\"loading\", setTo);\n    },\n\n    /**\n     * Have we run the init method?\n     */\n    checkInit: function () {\n      if (ResultsView.$container === null) {\n        // Nope. I'm gonna vomit...\n        throw Drupal.t(\"Error: ResultsView is not initialized.\");\n      }\n\n      // Yup.\n    },\n\n    /**\n     * Remove the current results and reboot this object.\n     */\n    clear: function () {\n      ResultsView.checkInit();\n      ResultsView.$container.empty();\n      ResultsView.$gallery.empty();\n\n      ResultsView.$container.show();\n      ResultsView.$blankSlateDiv.hide();\n\n\n      ResultsView.slots = 0;\n      ResultsView.start = 0;\n    },\n\n    /**\n     * Add a campaign to the results\n     * @param {Campaign} campaign The campaign to add\n     */\n    add: function (campaign) {\n      // Make sure we've initialized ourself\n      ResultsView.checkInit();\n\n      // If we're full, screw it.\n      // if (ResultsView.slots === ResultsView.maxSlots) {\n      //   return;\n      // }\n\n      // Render campaign object and append to the gallery\n      ResultsView.$gallery.append(campaign.render());\n      ResultsView.slots++;\n\n      // Track where we are for paging\n      ResultsView.start++;\n\n      // Lazy-load in images\n      ResultsView.$container.find(\"img\").unveil(200, function() {\n        $(this).load(function() {\n          this.style.opacity = 1;\n        });\n      });\n    }\n  };\n\n  return ResultsView;\n});\n\n","define('finder/SolrAdapter',['require','jquery','lodash'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n\n  // Create a callback function for caching the jsonp response.\n  /* jshint ignore:start */\n  window.solrResponse = function(response) {};\n  /* jshint ignore:end */\n\n  /**\n   * SolrAdapter acts as a mediator between Solr and the Campaign Finder.\n   *\n   * @type {Object}\n   */\n  var SolrAdapter = {\n    /*\n     * Sets how long after a user interaction we run the Solr query. As the\n     * name implies, this is a throttling mechanism that prevents the browser\n     * from pinging Solr every...single...time...a checkbox is changed.\n     **/\n    throttleTimeout: 400,\n\n    /*\n     * Configure this too. What's the base URL of the Solr server that you want\n     * the browser pinging? And what collection?\n     **/\n    baseURL: Drupal.settings.dosomethingSearch.solrURL,\n    collection: Drupal.settings.dosomethingSearch.collection,\n\n    // The current throttle timeout identifier\n    throttle: null,\n\n    // This would be awesome with an object key:value, but Solr allows multiple of the same key\n    defaultQuery: [\n      \"fq=-sm_field_campaign_status:(closed) bundle:[campaign TO campaign_group]\",\n      //\"fq=ss_field_search_image:[* TO *]\",\n      \"wt=json\",\n      \"indent=false\",\n      \"facet=true\",\n      \"facet.field=fs_field_active_hours\",\n      \"facet.field=im_field_cause\",\n      \"facet.field=im_field_action_type\",\n      // TODO: un-hard-code the rows\n      \"rows=8\",\n      \"fl=label,tid,im_vid_1,sm_vid_Action_Type,tm_vid_1_names,im_field_cause,im_vid_2,sm_vid_Cause,tm_vid_2_names,im_field_tags,im_vid_5,sm_vid_Tags,tm_vid_5_names,fs_field_active_hours,sm_field_call_to_action,bs_field_staff_pick,ss_field_search_image_400x400,ss_field_search_image_720x720,url\"\n    ],\n\n    // Map the input field names to the Solr query fields\n    fieldMap: {\n      \"cause\": \"im_field_cause\",\n      \"time\": \"fs_field_active_hours\",\n      \"action-type\": \"im_field_action_type\"\n    },\n\n    // Inverse mapping of fieldMap (duhhh)\n    fieldMapInverse: {},\n\n\n    // Container for Ajax response data\n    responseData: null,\n\n    /**\n     * Initialize the SolrAdapter.\n     */\n    init: function() {\n      // Create an inverse mapping so we can go from Solr field name to local field name\n      SolrAdapter.fieldMapInverse = _.invert(SolrAdapter.fieldMap);\n    },\n\n    /**\n     * Run the query after a specified timeout.\n     *\n     * @param checkedFields      Array of fields selected in the interface.\n     * @param offset             Offset to start results from (used for pagination).\n     * @param responseCallback   Function called when query successfully completes.\n     */\n    throttledQuery: function(checkedFields, offset, responseCallback) {\n      // Cancel the current pending query and set a new one\n      clearTimeout(SolrAdapter.throttle);\n\n      // Set a timeout so we don't immediately ping the Solr server\n      SolrAdapter.throttle = setTimeout(function() {\n        SolrAdapter.query(checkedFields, offset, responseCallback);\n      }, SolrAdapter.throttleTimeout);\n    },\n\n    /**\n     * Run the query against the Solr server\n     *\n     * @param checkedFields      Array of fields selected in the interface.\n     * @param offset             Offset to start results from (used for pagination).\n     * @param responseCallback   Function called when query successfully completes.\n     */\n    query: function (checkedFields, offset, responseCallback) {\n      /**\n       * A clone of the default query so we don't modify it directly\n       * @type {Array}\n       */\n      var query = _.clone(SolrAdapter.defaultQuery);\n      query.push(\"start=\" + offset);\n\n      /**\n       * The \"q\" parameter passed to Solr\n       * @type {Array}\n       */\n      var q = [];\n\n      _.forOwn(checkedFields, function(fields, fieldGroup) {\n        // Don't build parameter if we're not sorting by anything in this field group.\n        if( !_.isEmpty(fields) ) {\n          // Build a param query\n          var param = \"(\" + fields.join(\") OR (\") + \")\";\n\n          /*\n           * Use a powerset to weight items. For example, given:\n           *    Animals\n           *    Disasters\n           * We should weight results that are animals AND disasters before results\n           * that are animals OR disasters.\n           **/\n          var powerset = SolrAdapter.generatePowerset(fields);\n          if (powerset.length) {\n            param += \" OR \" + powerset;\n          }\n\n          // Push the newly built parameter onto the q parameter\n          q.push(SolrAdapter.fieldMap[fieldGroup] + \":\" + \"(\" + encodeURIComponent(param) + \")\");\n        }\n      });\n\n      // If we're already running an AJAX request, cancel it\n      if (SolrAdapter.xhr) {\n        SolrAdapter.xhr.abort();\n      }\n\n      // Store the AJAX request locally\n      SolrAdapter.xhr = $.ajax({\n        dataType: \"jsonp\",\n        cache: true,\n        jsonpCallback: \"solrResponse\",\n        url: SolrAdapter.buildQuery(query, q),\n        success: function (data) {\n          responseCallback({\n            result: data,\n            retrieved: data.response.docs.length,\n          });\n        },\n        error: function(data, errorType) {\n          responseCallback({\n            result: false,\n            error: errorType\n          });\n        },\n        // We use jsonp for X-domain compatibility\n        jsonp: \"json.wrf\"\n      });\n    },\n\n    /**\n     * Build a Solr query based on a base query string (what comes after the ?)\n     * and a \"q\" which goes into the \"q=\" part of said query string.\n     *\n     * @param  {String} query The query string\n     * @param  {String} q     The string for concatting into the q= parameter\n     *\n     * @return {String} The entire URL to query against\n     */\n    buildQuery: function (query, q) {\n      // Add \"q=\" to the query array, and keep track of its position because we\"re going\n      // to need to modify it (less memory!)\n      var pos = query.push(\"q=\") - 1;\n\n      // Add a function query to bubble staff picks, sponsored, and high season to the top.\n      var bubble = \"_query_:\\\"{!func}scale(is_bubble_factor,0,100)\\\" AND \";\n\n      if (q.length > 0) {\n        // If there is a query, join that sucker together\n        if (q.length === 1) {\n          query[pos] = \"q=\" + bubble + q[0];\n        } else {\n          query[pos] = \"q=\" + bubble + \"(\" + q.join(\") AND (\") + \")\";\n        }\n      } else {\n        query[pos] = bubble;\n      }\n\n      // Join the query array together as a URL query string\n      query = query.join(\"&\");\n\n      return SolrAdapter.baseURL + SolrAdapter.collection + \"/select?\" + query;\n    },\n\n    /**\n     * This one's fun! We want to generate power sets so we can weight results in a search.\n     *\n     * Instead of reading the code, here's an example!\n     *\n     * [a, b, c]\"s powerset+weight is:\n     * - []             IGNORED (i=0)\n     * - [a]            IGNORED (length=1)\n     * - [b]            IGNORED (length=1)\n     * - [c]            IGNORED (length=1)\n     * - (a AND b)      ^200\n     * - (b AND c)      ^200\n     * - (a AND b AND c)^300\n     *\n     *\n     * @param  {Array} params Parameters to powerset-ize\n     *\n     * @return {String} A powerset-ized query string joined by OR\n     */\n    generatePowerset: function (params) {\n      // Create a powerset\n      // See: http://rosettacode.org/wiki/Power_set#JavaScript\n      function powerset(ary) {\n        var ps = [[]];\n        for (var i=0; i < ary.length; i++) {\n          for (var j = 0, len = ps.length; j < len; j++) {\n            ps.push(ps[j].concat(ary[i]));\n          }\n        }\n        return ps;\n      }\n\n      // Generate the powerset\n      var variations = powerset(params);\n\n      // The placeholder query\n      var q = [];\n\n      // Loop through and build the string query\n      for (var i = 1; i < variations.length; i++) {\n        if (variations[i].length > 1) {\n          // Generate a string of format: ((a) AND (b) AND (c OR d))^X\n          // We need the second set of parenthesis beacuse some parameters are in the format\n          // \"c OR d\" or \"[* TO 2]\"\n          q.push(\"((\" + variations[i].join(\") AND (\") + \"))^\" + (100*variations[i].length));\n        }\n      }\n\n      return q.join(\" OR \");\n    }\n  };\n\n  return SolrAdapter;\n});\n\n","\ndefine('text!finder/templates/error.tpl.html',[],function () { return '<div class=\"messages error\">\\n  <%= Drupal.t(\"Ooof! We\\'re not sure what\\'s up? Maybe it\\'s us, or it could be your internet connection. Want to try again in a few minutes?\") %>\\n</div>\\n';});\n\n","define('finder/FormView',['require','jquery','lodash','finder/ResultsView','finder/SolrAdapter','text!finder/templates/error.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n  var ResultsView = require(\"finder/ResultsView\");\n  var SolrAdapter = require(\"finder/SolrAdapter\");\n  var errorTplSrc = require(\"text!finder/templates/error.tpl.html\");\n\n  /**\n   * FormView manages the filter form for Finder\n   * @type {Object}\n   */\n  var FormView = {\n    // The div where the form goes\n    $div: null,\n\n    // <button> that mobile users click to initiate the search\n    $searchButton: null,\n\n    // The field groups that contain the checkmarks\n    $fields: {},\n\n    // The last field group that was changed (by name)\n    lastChanged: null,\n\n    // TODO: Can we get this from CSS somewhere instead so it's not hard-coded?\n    cssBreakpoint: 768,\n\n    /**\n     * Construct the cloneables and set the parent div where the results go\n     * @param  {jQuery} $div The div where the results will live\n     */\n    init: function ($div, queryCallback) {\n      FormView.$div = $div;\n\n      // Prepare toggles\n      $div.find(\"[data-toggle]\").click(function () {\n        var $this = $(this),\n          toggleClass = $this.data(\"toggle\"),\n          $parent = $this.parents(\".\" + toggleClass),\n          $siblings = $parent.siblings();\n\n        $parent.toggleClass(\"open\");\n\n        // Need to treat siblings slightly differently to safeguard when going from mobile to desktop.\n        if ($(window).outerWidth() >= FormView.cssBreakpoint) {\n          if ($parent.hasClass(\"open\")) {\n            $siblings.addClass(\"open\");\n          } else {\n            $siblings.removeClass(\"open\");\n          }\n        }\n      });\n\n      // Store the inputs so we can access them later\n      FormView.$fields.cause = $div.find(\"input[name='cause']\");\n      FormView.$fields.time = $div.find(\"input[name='time']\");\n      FormView.$fields[\"action-type\"] = $div.find(\"input[name='action-type']\");\n\n      // Hook up to the DOM\n      FormView.$searchButton = $div.find(\".campaign-search\");\n\n      // Loop through each field selector\n      // @TODO This is tightly coupled.\n      _.each(FormView.$fields, function(fieldGroup) {\n        // For each field selector, we need to add a Facet query so we can get counts to\n        // disable the checkbox.\n        fieldGroup.each(function(idx, element) {\n          /**\n           * The Solr field name that we're going to query against\n           * @type {String}\n           */\n          var field = SolrAdapter.fieldMap[$(element).prop(\"name\")];\n\n          /**\n           * The value of the field that we're passing in to the query\n           * @type {String}\n           */\n          var val = $(element).val();\n\n          // Add the facet query\n          SolrAdapter.defaultQuery.push(\"facet.query=\" + field + \":\" + val);\n        });\n      });\n\n      // Now attach events:\n      _.each(FormView.$fields, function(fieldGroup) {\n        // Attach ourselves to the \"change\" event on the input fields\n        fieldGroup.change(function () {\n          // check this guy\n          $(this).parents(\"li\").toggleClass(\"checked\", $(this).is(\":checked\"));\n\n          // Save the last checkbox that we checked so we don\"t disable any of\n          // those fields if we\"re trying to select multiple\n          FormView.lastChanged = $(this).attr(\"name\");\n\n          // If we're not on mobile...\n          queryCallback();\n        });\n      });\n\n      // Search button appears on mobile in lieu of live filtering\n      FormView.$searchButton.click(function () {\n        queryCallback();\n        $(\"html,body\").animate({\n          scrollTop: ResultsView.$div.offset().scrollTop\n        }, 1000);\n      });\n    },\n\n    /**\n     * Have we run the init method?\n     */\n    checkInit: function () {\n      if (FormView.$div === null) {\n        // Nope. I'm gonna vomit...\n        throw Drupal.t(\"Error: FormView is not initialized.\");\n      }\n\n      // Yup.\n    },\n\n\n    /**\n     * Shows an error message for network issues\n     **/\n    showErrorMessage: function() {\n      var message = _.template(errorTplSrc);\n\n      if ($(\".error\").length < 1) {\n        FormView.$div.parents(\".finder--form\").after(message);\n      }\n\n    },\n\n\n    /**\n     * Returns Boolean if any fields are checked\n     **/\n    hasCheckedFields: function() {\n      var hasChecked = false;\n\n      // Loop through each of the field groups\n      _.each(FormView.$fields, function(fieldGroup) {\n        if (fieldGroup.filter(\":checked\").length > 0) {\n          hasChecked = true;\n        }\n      });\n\n      return hasChecked;\n    },\n\n    /**\n     * Returns an object with arrays of checked fields grouped by fieldGroup.\n     **/\n    getCheckedFields: function() {\n      var checkedFields = [];\n\n      // Loop through each of the field groups\n      _.each(FormView.$fields, function(fieldGroup, groupName) {\n        var checked = fieldGroup.filter(\":checked\");\n        checkedFields[groupName] = [];\n\n        // Only add this to the query if there are fields checked in this field group\n        if (checked.length > 0) {\n          // For each checked box, add it to the search query\n          checked.each(function (index, e) {\n            checkedFields[groupName].push($(e).val());\n          });\n        }\n      });\n\n      return checkedFields;\n    },\n\n\n    /**\n     * Disable fields that have no results available for the given selection\n     *\n     * @param  {Object} results The Solr facet_queries result\n     */\n    disableFields: function(results) {\n      // Make sure we've initialized ourself\n      FormView.checkInit();\n\n      // @TODO: This is super inefficient. We should be storing state in memory\n      // rather than in the DOM, and then rendering the form based on that state.\n\n      // for each of the facet queries\n      _.each(results, function(query, key) {\n        // Solr returns results in the format field_label:count instead of a nice\n        // associative array. :( Let\"s parse that out.\n        var keyArr = key.split(\":\");\n        var field = keyArr[0],\n            value = keyArr[1];\n\n        // If we've checked something in this group, disable 'em all. Otherwise, use facets\n        // to disable impossible choices.\n        var $checkboxes = $(\"input[name='\" + SolrAdapter.fieldMapInverse[field] + \"']\");\n\n        if( !_.isEmpty($checkboxes.filter(\":checked\")) ) {\n          $checkboxes.filter(\":not(:checked)\").prop(\"disabled\", true);\n          $checkboxes.filter(\":not(:checked)\").parents(\"li\").addClass(\"disabled\");\n        } else {\n          // Should we disable this field? Whelp, if there are no results, the answer is yes!\n          var disabled = results[key] === 0;\n          var $checkbox = $checkboxes.filter(\"[value='\" + value + \"']\");\n\n          // Set the disabled attribute if we need to (note: disabled is a variable!)\n          $checkbox.prop(\"disabled\", disabled);\n\n          if (disabled) {\n            // Let\"s uncheck it if we can't select it. It would be confusing otherwise.\n            $checkbox.prop(\"checked\", !disabled);\n\n            // And add a class so we can make it look purdy.\n            $checkbox.parents(\"li\").addClass(\"disabled\");\n          } else {\n            // Oh, hey! It's re-enabled! Let\"s make it look purdier than it was.\n            $checkbox.parents(\"li\").removeClass(\"disabled\");\n          }\n        }\n      });\n    },\n\n    /**\n     * Remove the current results and reboot this object.\n     */\n    clear: function() {\n      //FormView.checkInit();\n      _.each(FormView.$fields, function(fieldGroup) {\n        var disabled = fieldGroup.filter(\":disabled\");\n        if (disabled) {\n          fieldGroup.prop(\"disabled\", false)\n            .parents(\"li\").removeClass(\"disabled\");\n        }\n      });\n    }\n  };\n\n  return FormView;\n});\n\n","define('finder/Finder',['require','finder/FormView','finder/ResultsView','finder/SolrAdapter'],function(require) {\n  \"use strict\";\n\n  var FormView = require(\"finder/FormView\");\n  var ResultsView = require(\"finder/ResultsView\");\n  var SolrAdapter = require(\"finder/SolrAdapter\");\n\n  /**\n   * Finder manages the search action\n   *\n   * @type {Object}\n   */\n  var Finder = {\n\n    /**\n     * Initialize the Campaign Finder and, by extension, the Campaign Results handler\n     *\n     * @param  {JQuery} $formContainer       The div that the filters will be shown in\n     * @param  {JQuery} $resultsContainer    The container element that the results will be injected into\n     * @param  {JQuery} $blankSlate          The div that will be shown when no filter is selected\n     */\n    init: function ($formContainer, $resultsContainer, $blankSlate) {\n      // Initialize the ResultsView\n      FormView.init($formContainer, Finder.query);\n      ResultsView.init($resultsContainer, $blankSlate, Finder.query, FormView.clear);\n\n      // Prepare the Solr adapter\n      SolrAdapter.init();\n    },\n\n    /**\n     * Run the query against the Solr server\n     * @param  {int} offset   Offset to start results at (used for pagination).\n     */\n    query: function(offset) {\n      var queryOffset = offset || 0;\n      var checkedFields = FormView.getCheckedFields();\n\n      // Run the Solr query\n      if(!queryOffset) {\n        // If no offset, we display a new set of results\n        SolrAdapter.throttledQuery(checkedFields, queryOffset, Finder.displayResults);\n      } else {\n        // Otherwise, append to existing result set\n        SolrAdapter.throttledQuery(checkedFields, queryOffset, ResultsView.appendResults);\n      }\n\n      // Mark the results pane as loading\n      ResultsView.loading();\n    },\n\n    /**\n     * Displays results after querying Solr.\n     * @param data  Results from SolrAdapter\n     **/\n    displayResults: function(data) {\n      if (data.result) {\n        if(FormView.hasCheckedFields()) {\n          ResultsView.parseResults(data);\n          /* jshint ignore:start */\n          // Using that underscore variable notation for Solr.\n          FormView.disableFields(data.result[\"facet_counts\"][\"facet_queries\"]);\n          /* jshint ignore:end */\n        } else {\n          ResultsView.showBlankSlate();\n          FormView.clear();\n        }\n      } else {\n        FormView.showErrorMessage();\n      }\n    }\n  };\n\n  return Finder;\n});\n\n","define('StripeForm',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\"),\n    Stripe = window.Stripe || {};\n\n  /**\n    * Creates an instance of StripeForm.\n    *\n    * @constructor\n    * @this {StripeForm}\n    * @param {jQuery} $form The payment form\n    * @param {String} publishKey Publishable Stripe key.\n  */\n  var StripeForm = function ($form, publishKey) {\n    if ($form === undefined || !$($form.length)) { return; }\n    if (publishKey === undefined) { return; }\n    if (!this instanceof StripeForm) { return new StripeForm($form, publishKey); }\n    this.$form = $($form);\n    this.$parent = this.$form.parent();\n    this.publishKey = publishKey;\n    this.init();\n  };\n  StripeForm.prototype = {\n    /**\n      * Sets the publishable key to Stripe and adds event listeners to the form\n    */\n    init: function () {\n      var _this = this;\n      Stripe.setPublishableKey(this.publishKey);\n\n      this.$form.on(\"submit\", function (ev) {\n        ev.preventDefault();\n      });\n\n      // attach event listener to submit button to avoid double binding\n      this.$form.find(\".form-submit\").on(\"click\", function () {\n        // Timeout needed so errors (if any) can render first\n        setTimeout(function () {\n          var isValid = _this.isValid();\n          if (isValid) {\n            Stripe.card.createToken(_this.$form, function (status, response) {\n              _this.onFormSubmit(status, response);\n            });\n          }\n        }, 100);\n      });\n    },\n\n    /**\n      * Callback method when form is submitted\n      * @param {String} Response status code\n      * @param {object} JSON response from submitted token\n    */\n    onFormSubmit: function (status, response) {\n      var $form = this.$form;\n      if (response.error) {\n        // Show the errors on the form\n        $form.find(\".payment-errors\").text(response.error.message);\n      } else {\n        // response contains id and card, which contains additional card details\n        var token = response.id;\n        $form.find(\"input[name='token']\").val(token);\n        $form.get(0).submit();\n      }\n    },\n\n    /**\n      * Checks for invalid form fields\n      * @returns {boolean} Whether form contains zero errors or not\n    */\n    isValid: function () {\n      return this.$form.find(\".error\").length === 0;\n    }\n  };\n\n  return StripeForm;\n\n});\n\n","define('donate/Donate',['require','jquery','StripeForm'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var StripeForm = require(\"StripeForm\");\n  var $donateForm = $(\"#dosomething-payment-form\");\n\n  var Donate = {\n    init: function () {\n      try {\n        var stripeAPIPublishKey = Drupal.settings.dosomethingPayment.stripeAPIPublish;\n        new StripeForm($donateForm, stripeAPIPublishKey);\n      } catch(e) {\n        $donateForm.html(\"<div class='messages'>Whoops! Something's not right. Please email us!</div>\");\n      }\n    }\n  };\n\n  return Donate;\n\n});\n\n","define('revealer/Revealer',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n\n  /**\n   * Allows for specified grouping of elements to be hidden and then revealed\n   * via an interactive \"Show More\" button.\n   *\n   * @param {jQuery} $container The container element object that encloses the items to hide.\n   * @param {jQuery} $content   A collection of objects to hide.\n   * @param {string} category   Specify a category type for the content to provide more unique behavior.\n   * @param {int} initialItems  Amount of items to initially display.\n   * @param {int} stepItems     Amount of items to step by\n   */\n  var Revealer = function($container, $content, category, initialItems, stepItems) {\n    this.$container = $container;\n    this.$content   = $content;\n    this.$button    = $(\"<button class=\\\"button -tertiary\\\">\" + Drupal.t(\"Show More\") + \"</button>\");\n    this.category   = category;\n    this.initialItems = initialItems;\n    this.stepItems = stepItems;\n    this.step\n    this.steps      = {\n      // Array of step items to include with each button interaction.\n      items: [],\n\n      // Number of steps.\n      count: 0\n    };\n\n    this.init();\n  };\n\n\n  Revealer.prototype.init = function () {\n    if (this.category === \"gallery\") {\n      this.prepGalleryItems();\n    }\n    else {\n      this.steps.items.push(this.$content);\n    }\n\n    this.steps.count = this.steps.items.length;\n\n    this.detachContent();\n    this.enableButton();\n  };\n\n\n  Revealer.prototype.detachContent = function () {\n    this.$content.detach();\n  };\n\n\n  Revealer.prototype.reattachContent = function (content) {\n    this.$container.append(content);\n  };\n\n\n  Revealer.prototype.enableButton = function () {\n    this.$button.insertAfter(this.$container);\n\n    var _this = this;\n\n    this.$button.on(\"click\", function () {\n\n      if (_this.steps.count > 0) {\n        _this.reattachContent(_this.steps.items.shift());\n        _this.steps.count--;\n      }\n\n      if (_this.steps.count === 0) {\n        _this.$button.remove();\n      }\n\n    });\n  };\n\n\n  Revealer.prototype.prepGalleryItems = function () {\n    this.$content = this.$content.slice(this.initialItems);\n    var collection = $.makeArray(this.$content);\n\n    // Multiple step reveals.\n    if (this.$content.length > this.stepItems) {\n      while (collection.length > 0) {\n        this.steps.items.push(collection.splice(0, this.stepItems));\n      }\n    }\n    else {\n      this.steps.items.push(collection);\n    }\n\n    collection = null;\n  };\n\n\n  return Revealer;\n\n});\n\n","define('swapper/Swapper',[],function() {\n  \"use strict\";\n\n  var Swapper = function ($content) {\n    this.$image   = $content.find(\"img\");\n\n    this.init();\n  };\n\n\n  Swapper.prototype.init = function () {\n    var srcLarge = this.$image.data(\"src-large\") || null;\n\n    this.exchange(srcLarge);\n  };\n\n\n  Swapper.prototype.exchange = function (url) {\n    if (url) {\n      this.$image.attr(\"src\", url);\n    }\n  };\n\n\n  return Swapper;\n\n});\n\n","/**\n * Pub/Sub events: Allows modules to communicate via publishing\n * and subscribing to events.\n *\n * Based on Addy Osmani's Pubsubz, licensed under the GPL.\n * https://github.com/addyosmani/pubsubz\n * http://jsfiddle.net/LxPrq/\n */\n\ndefine('modal/events',[],function() {\n  \"use strict\";\n\n  var topics = {};\n  var subUid = -1;\n\n  var publish = function(topic, args) {\n    if (!topics[topic]) {\n      return false;\n    }\n\n    setTimeout(function() {\n      var subscribers = topics[topic],\n      len = subscribers ? subscribers.length : 0;\n\n      while(len--) {\n        subscribers[len].func(topic, args);\n      }\n    }, 0);\n\n    return true;\n  };\n\n  var subscribe = function(topic, func) {\n    if (!topics[topic]) {\n      topics[topic] = [];\n    }\n\n    var token = (++subUid).toString();\n    topics[topic].push({\n      token: token,\n      func: func\n    });\n\n    return token;\n  };\n\n  var unsubscribe = function(token) {\n    for (var m in topics) {\n      if (topics[m]) {\n        for (var i = 0, j = topics[m].length; i < j; i++) {\n          if (topics[m][i].token === token) {\n            topics[m].splice(i, 1);\n            return token;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  // Export public API\n  return {\n    publish: publish,\n    subscribe: subscribe,\n    unsubscribe: unsubscribe\n  };\n});\n\n","/**\n * @module neue/modal\n * Show/hide modals. To link to a modal, add a `data-modal-href` attribute\n * pointing to the selector for the modal you want to show.\n *\n * @example\n * // <a href=\"http://www.example.com\" data-modal-href=\"#modal--example\">Click!</a>\n * // <div data-modal id=\"modal--example\" role=\"dialog\">\n * //   <!-- content -->\n * // </div>\n *\n */\n\ndefine('modal/modal',['require','./events'],function(require) {\n  \"use strict\";\n\n  var $ = window.jQuery;\n  var Modernizr = window.Modernizr;\n  var Events = require(\"./events\");\n\n  var modalReady = false;\n  var queuedModal = null; // Modals queued to be shown on document.ready\n\n  // Cache commonly used jQuery objects\n  var $document = $(document);\n  var $chrome = $(\".chrome\");\n  var $modalContainer = null;\n\n  // UI elements:\n  var $skipLink = $(\"<a href='#' class='js-close-modal js-modal-generated modal-close-button -alt'>skip</a>\");\n  var $closeLink = $(\"<a href='#' class='js-close-modal js-modal-generated modal-close-button'>&#215;</a>\");\n\n  // The currently open modal\n  var $modal = null;\n\n  // Whether this modal can be closed by the user\n  var closeable = false;\n\n  // Return a boolean if modal is open or not\n  var isOpen = function() {\n    return ($modal !== null);\n  };\n\n  // Programmatically add close button to modal.\n  var _addCloseButton = function($el, type, skipForm) {\n    switch(type) {\n      case \"skip\":\n        // Add a skip button, which delegates to the submitting the form with the given ID\n        $el.prepend( $skipLink );\n        $skipLink.on(\"click\", function(event) {\n          event.preventDefault();\n          $(skipForm).submit();\n        });\n        closeable = false;\n        break;\n\n      case \"false\":\n      case \"0\":\n        closeable = false;\n        break;\n\n      // Add option to only allow the close button to close the modal.\n      case \"closeButtonOnly\":\n        $el.prepend($closeLink);\n        closeable = false;\n        break;\n\n      default:\n        $el.prepend($closeLink);\n        closeable = true;\n    }\n  };\n\n  /**\n   * Open a new modal\n   * @param {jQuery}  $el                         Element that will be placed inside the modal.\n   * @param {boolean} [options.animated=true]     Use animation for opening the modal.\n   * @param {boolean} [options.closeButton]       Override `data-modal-close` attribute.\n   * @param {boolean} [options.skipForm]          Override `data-modal-skip-form` attribute.\n   */\n  var open = function($el, options) {\n    options = options || {};\n    options.animated = typeof options.animated === \"boolean\" ? options.animated : true;\n    options.closeButton = typeof options.closeButton !== \"undefined\" ? options.closeButton : $el.attr(\"data-modal-close\");\n    options.skipForm = typeof options.skipForm !== \"undefined\" ? options.skipForm : $el.attr(\"data-modal-skip-form\");\n\n    if($el.length === 0) {\n      // If modal does not exist, don't try to open it.\n      return false;\n    }\n\n    // If modal markup isn't initialized, save and display once it is.\n    if(!modalReady) {\n      queuedModal = {\"$el\": $el, \"options\": options};\n      return false;\n    }\n\n    // Read from DOM\n    var offsetTop = \"-\" + $document.scrollTop() + \"px\";\n\n    // Add generated content\n    _addCloseButton($el, options.closeButton, options.skipForm);\n\n    if(!isOpen()) {\n      // Set up overlay and show modal\n      $chrome.css(\"top\", offsetTop);\n      $chrome.addClass(\"has-modal\");\n      $modalContainer.css(\"display\", \"block\");\n      if(options.animated && Modernizr.cssanimations) {\n        $modalContainer.addClass(\"animated-open\");\n      }\n      $el.css(\"display\", \"block\");\n    } else {\n      // Modal is already open, so just replace current content\n      $modal.hide();\n      $el.show();\n    }\n\n    // Make sure we're scrolled to the top of the modal.\n    setTimeout(function() {\n      $document.scrollTop(0);\n    }, 50);\n\n    // We provide an event that other modules can hook into to perform custom functionality when\n    // a modal opens (such as preparing things that are added to the DOM, etc.)\n    Events.publish(\"Modal:Open\", $el);\n\n    // Keep track of whether modal is open or not\n    $modal = $el;\n  };\n\n  // Cleanup after modal animates out\n  var _cleanup = function(scrollOffset) {\n    $modalContainer.css(\"display\", \"none\");\n    $modalContainer.removeClass(\"animated-close\");\n    $modal.css(\"display\", \"none\");\n\n    // Remove any generated content\n    $modal.find(\".js-modal-generated\").remove();\n\n    // Remove overlay and reset scroll position\n    $chrome.removeClass(\"has-modal\");\n    $chrome.removeClass(\"animated-close\");\n    $chrome.css(\"top\", \"\");\n    $document.scrollTop(scrollOffset);\n\n    // Get rid of reference to closed modal\n    $modal = null;\n  };\n\n  /**\n   * Close the active modal.\n   * @param {boolean} [options.animated=true] Use animation for closing the modal.\n   */\n  var close = function(options) {\n    options = options || {};\n    options.animated = typeof options.animated !== \"undefined\" ? options.animated : true;\n\n    var scrollOffset = parseInt($chrome.css(\"top\")) * -1;\n\n    // Remove URL hash for modal from browser\n    if(window.location.hash === \"#\" + $modal.attr(\"id\")) {\n      window.location.hash = \"/\";\n    }\n\n    if(options.animated && Modernizr.cssanimations) {\n      $chrome.addClass(\"animated-close\");\n      $modalContainer.addClass(\"animated-close\");\n      $modalContainer.one(\"webkitAnimationEnd oanimationend msAnimationEnd animationend\", function() {\n        _cleanup(scrollOffset);\n      });\n    } else {\n      _cleanup(scrollOffset);\n    }\n\n    // We provide an event that other modules can hook into to perform custom functionality when\n    // a modal opens (such as preparing things that are added to the DOM, etc.)\n    Events.publish(\"Modal:Close\", $modal);\n  };\n\n  // Click handler for opening a new modal\n  var _openHandler = function(event) {\n    event.preventDefault();\n    var href = $(this).data(\"modal-href\");\n\n    open($(href));\n  };\n\n  // Click handler for closing a modal\n  var _closeHandler = function(event) {\n    // Don't let the event bubble.\n    if(event.target !== this) {\n      return;\n    }\n\n    // Only close on clicking overlay if this modal has a \"x\" close button\n    if( $(this).hasClass(\"js-close-modal\") || closeable ) {\n      // Override default link behavior.\n      event.preventDefault();\n      close();\n    }\n  };\n\n  $document.ready(function() {\n    var $body = $(\"body\");\n\n    // Create container for modals\n    $modalContainer = $(\"<div class='modal-container'></div>\");\n    $body.append($modalContainer);\n\n    // Prepare the DOM!\n    $(\"[data-modal]\").each(function() {\n      $(this).appendTo($modalContainer);\n      $(this).attr(\"hidden\", true);\n    });\n\n    //If there's a hash in the URL, check if it's a modal and load it\n    var hash = window.location.hash;\n    if(hash && hash !== \"#/\" && $(hash) && typeof $(hash).data(\"modal\") !== \"undefined\") {\n      open($(hash));\n    }\n\n    modalReady = true;\n    if(queuedModal !== null) {\n      open(queuedModal.$el, queuedModal.options);\n    }\n\n    // Bind events to open & close modal\n    $body.on(\"click\", \"[data-modal-href]\", _openHandler);\n    $body.on(\"click\", \".modal-container\", _closeHandler);\n    $body.on(\"click\", \".js-close-modal\", _closeHandler);\n  });\n\n  // Attach to namespaced window object\n  window.DS = window.DS || {};\n  window.DS.Modal = {\n    isOpen: isOpen,\n    open: open,\n    close: close,\n    Events: Events\n  };\n\n  return window.DS.Modal;\n});\n\n\ndefine('modal', ['modal/modal'], function (main) { return main; });\n\n","/**\n * Pub/Sub events: Allows modules to communicate via publishing\n * and subscribing to events.\n *\n * Based on Addy Osmani's Pubsubz, licensed under the GPL.\n * https://github.com/addyosmani/pubsubz\n * http://jsfiddle.net/LxPrq/\n */\n\ndefine('validation/events',[],function() {\n  \"use strict\";\n\n  var topics = {};\n  var subUid = -1;\n\n  var publish = function(topic, args) {\n    if (!topics[topic]) {\n      return false;\n    }\n\n    setTimeout(function() {\n      var subscribers = topics[topic],\n      len = subscribers ? subscribers.length : 0;\n\n      while(len--) {\n        subscribers[len].func(topic, args);\n      }\n    }, 0);\n\n    return true;\n  };\n\n  var subscribe = function(topic, func) {\n    if (!topics[topic]) {\n      topics[topic] = [];\n    }\n\n    var token = (++subUid).toString();\n    topics[topic].push({\n      token: token,\n      func: func\n    });\n\n    return token;\n  };\n\n  var unsubscribe = function(token) {\n    for (var m in topics) {\n      if (topics[m]) {\n        for (var i = 0, j = topics[m].length; i < j; i++) {\n          if (topics[m][i].token === token) {\n            topics[m].splice(i, 1);\n            return token;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  // Export public API\n  return {\n    publish: publish,\n    subscribe: subscribe,\n    unsubscribe: unsubscribe\n  };\n});\n\n","/**\n * Client-side form validation logic. Form element is validated based\n * on `data-validate` attribute, and validation output is placed in\n * corresponding `<label>`.\n *\n * Validations can be added later by extending `NEUE.Validation.Validations`.\n * Validators can be added later by extending `NEUE.Validation.Validators`.\n *\n * finished validating with a boolean `success` and a plain-text `message`\n * value. (Alternatively, a `suggestion` value can be passed which will\n * prompt the user \"Did you mean {suggestion}?\".\n *\n * ## Usage Notes:\n * - Input field must have `data-validate` attribute.\n * - If adding input fields to the DOM after load, run `prepareFields`\n */\n\ndefine('validation/validation',['require','./events'],function(require) {\n  \"use strict\";\n\n  var $ = window.jQuery;\n  var Events = require(\"./events\");\n  var validations = [];\n\n  /**\n   * Prepares form label DOM to display validation messages & register event handler\n   * @param {jQuery} $fields Fields to register validation handlers to.\n   */\n  var prepareFields = function($fields) {\n    $fields.each(function() {\n      var $field = $(this);\n\n      prepareLabel( $(\"label[for='\" + $field.attr(\"id\") + \"']\") );\n\n      $field.on(\"blur\", function(event) {\n        event.preventDefault();\n        validateField( $field );\n      });\n    });\n  };\n\n  /**\n   * Prepare field label DOM to display validation messages.\n   * @param {jQuery} $label Label element to prepare.\n   */\n  var prepareLabel = function($label) {\n    // Check to make sure we haven't already prepared this before\n    if($label.find(\".validation\").length === 0) {\n      var $innerLabel = $(\"<div class='validation'></div>\");\n      $innerLabel.append(\"<div class='validation__label'>\" + $label.html() + \"</div>\");\n      $innerLabel.append(\"<div class='validation__message'></div>\");\n\n      $label.html($innerLabel);\n    }\n  };\n\n  /**\n   * Trigger a validation on a form element.\n   * @param {jQuery}   $field                            Form element to be validated.\n   * @param {jQuery}   [force = false]                   Force validation (even on empty fields).\n   * @param {function} [callback=showValidationMessage]  Callback function that receives validation result\n   */\n  var validateField = function($field, force, callback) {\n    // Default arguments\n    force = typeof force !== \"undefined\" ? force : false;\n    callback = typeof callback !== \"undefined\" ? callback : function($field, result) {\n      showValidationMessage($field, result);\n    };\n\n    var validation = $field.data(\"validate\");\n\n    // Trigger any other linked validation\n    var validationTrigger = $field.data(\"validate-trigger\");\n    if(validationTrigger) {\n      validateField( $(validationTrigger) );\n    }\n\n\n    // Don't validate if validation doesn't exist\n    if(!validations[validation]) {\n      console.error(\"A validation with the name \"+ validation + \" has not been registered.\");\n      return;\n    }\n\n    // For <input>, <select>, and <textarea> tags we provide\n    // the field's value as a string\n    if( isFormField($field) ) {\n      // Get field info\n      var fieldValue = $field.val();\n\n      // Finally, let's not validate blank fields unless forced to\n      if(force || fieldValue !== \"\") {\n        if(validation === \"match\") {\n          var matchFieldValue = $($field.data(\"validate-match\")).val();\n          validations[validation].fn(fieldValue, matchFieldValue, function(result) {\n            callback($field, result);\n          });\n        } else {\n          validations[validation].fn(fieldValue, function(result) {\n            callback($field, result);\n          });\n        }\n      }\n    } else {\n      // For all other tags, we pass the element directly\n      if(validation === \"match\") {\n        var $matchField = $($field.data(\"validate-match\"));\n        validations[validation].fn($field, $matchField, function(result) {\n          callback($field, result);\n        });\n      } else {\n        validations[validation].fn($field, function(result) {\n          callback($field, result);\n        });\n      }\n    }\n  };\n\n  /**\n   * Register a new validation.\n   *\n   * @param {String}    name              The name function will be referenced by in `data-validate` attribute.\n   * @param {Object}    validation        Collection of validation rules to apply\n   * @param {Function}  [validation.fn]   Custom validation\n   */\n  var registerValidation = function(name, validation) {\n    if(validations[name]) {\n      throw \"A validation function with that name has already been registered\";\n    }\n\n    validations[name] = validation;\n  };\n\n  /**\n   * @DEPRECATED: Will be removed in a future version in favor of `registerValidation`.\n   */\n  var registerValidationFunction = function(name, func) {\n    var v = {\n      fn: func\n    };\n\n    registerValidation(name, v);\n  };\n\n  /**\n   * Show validation message in markup.\n   *\n   * @param {jQuery} $field              Field to display validation message for.\n   * @param {Object} result              Object containing `success` and either `message` or `suggestion`\n   */\n  var showValidationMessage = function($field, result) {\n    var $fieldLabel = $(\"label[for='\" + $field.attr(\"id\") + \"']\");\n    var $fieldValidation = $fieldLabel.find(\".validation\");\n    var $fieldMessage = $fieldValidation.find(\".validation__message\");\n    var fieldLabelHeight = $fieldLabel.height();\n    var fieldMessageHeight;\n\n    $field.removeClass(\"has-success has-error has-warning shake\");\n    $fieldMessage.removeClass(\"has-success has-error has-warning\");\n\n    // Highlight/animate field\n    if(result.success === true) {\n      $field.addClass(\"has-success\");\n      $fieldMessage.addClass(\"has-success\");\n    } else {\n      $field.addClass(\"has-error\");\n      $fieldMessage.addClass(\"has-error\");\n\n      if( isFormField($field) ) {\n        $field.addClass(\"shake\");\n      }\n\n      Events.publish(\"Validation:InlineError\", $fieldLabel.attr(\"for\"));\n    }\n\n    // Show validation message\n    if(result.message) {\n      $fieldMessage.text(result.message);\n    }\n\n    if(result.suggestion) {\n      $fieldMessage.html(\"Did you mean \" + result.suggestion.full + \"? <a href='#' data-suggestion='\" + result.suggestion.full + \"'class='js-mailcheck-fix'>Fix it!</a>\");\n      Events.publish(\"Validation:Suggestion\", result.suggestion.domain);\n    }\n\n    fieldMessageHeight = $fieldMessage.height();\n\n    // Set label height if it needs to be multiline.\n    if(fieldMessageHeight > fieldLabelHeight) {\n      $fieldLabel.css(\"height\", fieldMessageHeight + \"px\");\n    } else {\n      // Clear previous multiline height if no longer needed.\n      $fieldLabel.css(\"height\", \"\");\n    }\n\n    // Animate in the validation message\n    $fieldValidation.addClass(\"is-showing-message\");\n\n    $(\".js-mailcheck-fix\").on(\"click\", function(e) {\n      e.preventDefault();\n\n      var $field = $(\"#\" + $(this).closest(\"label\").attr(\"for\"));\n      $field.val($(this).data(\"suggestion\"));\n      $field.trigger(\"blur\");\n\n      // If Google Analytics is set up, we fire an event to\n      // mark that a suggestion has been made\n      Events.publish(\"Validation:SuggestionUsed\", $(this).text() );\n    });\n\n    $field.on(\"focus\", function() {\n      $field.removeClass(\"has-warning has-error has-success shake\");\n      $fieldValidation.removeClass(\"is-showing-message\");\n      $fieldLabel.css(\"height\", \"\");\n    });\n\n    return result.success;\n  };\n\n\n  /**\n   * Disable form submission.\n   * @param {jQuery} $form Form to disable submission for.\n   */\n  var disableFormSubmit = function($form) {\n    // Prevent double-submissions\n    var $submitButton = $form.find(\":submit\");\n\n    // Disable that guy\n    $submitButton.attr(\"disabled\", true);\n    $submitButton.addClass(\"is-loading\");\n  };\n\n\n  /**\n   * Re-enable form submission.\n   * @param {jQuery} $form Form to enable submission for.\n   */\n  var enableFormSubmit = function($form) {\n    var $submitButton = $form.find(\":submit\");\n    $submitButton.attr(\"disabled\", false);\n    $submitButton.removeClass(\"is-loading is-disabled\");\n  };\n\n  /**\n   * Returns whether element is <input>, <select>, or <textarea>.\n   * @param {jQuery} $el  Element to check type of.\n   * @return {boolean}\n   */\n  var isFormField = function($el) {\n    var tag = $el.prop(\"tagName\");\n    return ( tag === \"INPUT\" || tag === \"SELECT\" || tag === \"TEXTAREA\" );\n  };\n\n  /**\n   * Validate form on submit.\n   */\n  $(\"body\").on(\"submit\", \"form\", function(event, isValidated) {\n    var $form = $(this);\n    var $validationFields = $form.find(\"[data-validate]\");\n\n    // Disable form submission to prevent double-clicks.\n    disableFormSubmit($form);\n\n    // We want to validate all [data-validate] field that are either required, or have user input.\n    $validationFields = $validationFields.map(function() {\n      var $this = $(this);\n      if(typeof $this.attr(\"data-validate-required\") !== \"undefined\" || $this.val() !== \"\") {\n        return $this;\n      }\n    });\n\n    // If no fields should be validated, submit!\n    if($validationFields.length === 0) {\n      return true;\n    }\n\n    if(isValidated === true) {\n      // completed a previous runthrough & validated;\n      // we're ready to submit the form\n      return true;\n    } else {\n      event.preventDefault();\n\n      var validatedFields = 0;\n      var validatedResults = 0;\n      var scrolledToError = false;\n\n      $validationFields.each(function() {\n        validateField($(this), true, function($field, result) {\n          validatedFields++;\n          showValidationMessage($field, result);\n\n          if(result.success) {\n            validatedResults++;\n          }\n\n          // If this is the first error in the form, scroll to it.\n          if(!scrolledToError && result.success === false) {\n            scrolledToError = true;\n            $(\"html,body\").animate({scrollTop: $field.offset().top - 32}, 200);\n          }\n\n          // Once we're done validating all fields, check status of form\n          if(validatedFields === $validationFields.length) {\n            if(validatedResults === $validationFields.length) {\n              // we've validated all that can be validated\n              Events.publish(\"Validation:Submitted\", $(this).attr(\"id\") );\n              $form.trigger(\"submit\", true);\n            } else {\n              Events.publish(\"Validation:SubmitError\", $(this).attr(\"id\") );\n              enableFormSubmit($form);\n            }\n          }\n        });\n      });\n\n      return false; // don't submit form, wait for callback with `true` parameter\n    }\n  });\n\n  // Register the \"match\" validation.\n  registerValidationFunction(\"match\", function(string, secondString, done) {\n    if(string === secondString && string !== \"\") {\n      return done({\n        success: true,\n        message: \"Looks good!\"\n      });\n    } else {\n      return done({\n        success: false,\n        message: \"That doesn't match.\"\n      });\n    }\n  });\n\n  $(function() {\n    // Prepare the labels on any `[data-validate]` fields in the DOM at load\n    prepareFields( $(\"body\").find(\"[data-validate]\") );\n  });\n\n  // Attach to namespaced window object\n  window.DS = window.DS || {};\n  window.DS.Validation = {\n    prepareFields: prepareFields,\n    registerValidation: registerValidation,\n    registerValidationFunction: registerValidationFunction,\n    validateField: validateField,\n    showValidationMessage: showValidationMessage,\n    Validations: validations,\n    Events: Events\n  };\n\n  return window.DS.Validation;\n});\n\ndefine('validation', ['validation/validation'], function (main) { return main; });\n\n","define('images/ImageCrop',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n\n  // Initialize variables.\n  var xInitPos;\n  var yInitPos;\n  var offsetLeft;\n  var offsetTop;\n  var initialCropBoxHeight;\n  var initialCropBoxWidth;\n  var previewImageWidth;\n  var previewImageHeight;\n  var $previewImage;\n  var origImage;\n  var resizeState          = false;\n  var dragState            = false;\n  var moveRight;\n  var moveDown;\n  var resizeHorizontal;\n  var resizeVertical;\n  var minScaled;\n  var minimum              = 480;\n  var $cropBox             = $(\"<div class='cropbox'><div class='resize-handle'></div></div>\");\n  var resizeClickPositionX = 0;\n  var resizeClickPositionY = 0;\n  var scale                = 1;\n  var degrees              = 0;\n\n\n  /**\n   * Returns the coordinates of a touch or mouse event.\n   */\n  var getCoords = function(e) {\n    var coords = {};\n    var eventType = e.originalEvent.type;\n\n    // Get the coordinates of a touchevent.\n    if (eventType === \"touchstart\" || eventType === \"touchmove\" || eventType === \"touchend\") {\n      coords = e.originalEvent.targetTouches[0];\n    }\n    // Get coordinates of mouse event.\n    else {\n      coords = {\n        pageX: e.pageX,\n        pageY: e.pageY,\n      };\n    }\n\n    return coords;\n  };\n\n  /**\n   * Returns a value equal to the minimum allowed crop size scaled down to fit the image.\n   */\n  var getMinimumSize = function(minimum, scale) {\n    return minimum / scale;\n  };\n\n  /**\n   * Calculates the initial size of the cropbox. The initial\n   * size of the cropbox should be 50% of the size of the image,\n   * but have a minimum equal to the minimum allowed crop size.\n   *\n   * @param {number} width      width of the image.\n   * @param {number} height     height of the image.\n   * @param {number} minimum    minimum size of the cropbox\n   */\n  var getCropBoxSize = function(width, height, minimum) {\n    var cropBoxSize;\n    var orientation = (width > height) ? \"landscape\" : \"portrait\";\n\n    // Make the cropbox half the size of the largest dimension.\n    // But, make sure the cropbox will fit in the image by\n    // checking that it isn't ever greater than smallest dimension.\n    if (orientation === \"landscape\") {\n      var halfWidth = width / 2;\n\n      if (halfWidth > height) {\n        cropBoxSize = height;\n      }\n      else {\n        cropBoxSize = halfWidth;\n      }\n    }\n    else {\n      var halfHeight = height / 2;\n\n      if (halfHeight > width) {\n        cropBoxSize = width;\n      }\n      else {\n        cropBoxSize = halfHeight;\n      }\n    }\n\n    return (cropBoxSize > minimum) ? cropBoxSize : minimum;\n  };\n\n  /**\n   * This returns the amount to translate an image after it has been rotated so\n   * so that it stays center in it's container.\n   *\n   * @param {number} width      Width of the image.\n   * @param {number} height     height of the image.\n   * @param {number} degrees    How many degrees the image has been rotated.\n   */\n  var getTranslateDifference = function(width, height, degrees) {\n    var translateDiff = (width / 2) - (height / 2);\n\n    if (degrees === 90 || degrees === 270) {\n      return (degrees === 270) ? -(translateDiff) : translateDiff;\n    }\n    else {\n      return 0;\n    }\n  };\n\n  /**\n   * When the user clicks down, grab initial information.\n   */\n  var onMouseDown = function(event) {\n    var coords = getCoords(event);\n\n    if (dragState) {\n      // Set the initial position of the mouse.\n      xInitPos = coords.pageX;\n      yInitPos = coords.pageY;\n\n      // Sets the initial positioning of the crop box.\n      if ($cropBox.length) {\n        offsetLeft = parseInt($cropBox.css(\"left\"), 10);\n        offsetTop  = parseInt($cropBox.css(\"top\"), 10);\n      }\n\n      // Animate the drag.\n      window.requestAnimationFrame(function() {\n        dragBox();\n      });\n    }\n\n    if (resizeState) {\n      // Set the initial size of the crop box.\n      if ($cropBox.length) {\n        initialCropBoxHeight = parseInt($cropBox.css(\"height\"), 10);\n        initialCropBoxWidth  = parseInt($cropBox.css(\"width\"), 10);\n      }\n\n      // Set the position of the mouse.\n      resizeClickPositionX = coords.pageX;\n      resizeClickPositionY = coords.pageY;\n\n      // Animate the resizing.\n      window.requestAnimationFrame(function() {\n        resizeBox();\n      });\n    }\n  };\n\n  /**\n   * Turn off the dragging and resizing when the user releases.\n   */\n  var onMouseUp = function() {\n    dragState = false;\n    resizeState = false;\n  };\n\n  /**\n   * As the user moves the mouse, handle all the calculations needed to determine\n   * how to redraw the cropbox. This doesn't do the actual animation, just the math!\n   */\n  var onMouseMove = function(width, height, event) {\n    var coords        = getCoords(event);\n    var cropBoxHeight = parseInt($cropBox.css(\"height\"),10);\n    var cropBoxWidth  = parseInt($cropBox.css(\"width\"),10);\n    var cropBoxTop    = parseInt($cropBox.css(\"top\"), 10);\n    var cropBoxLeft   = parseInt($cropBox.css(\"left\"), 10);\n\n    if (dragState) {\n      // Calculate how far to move the box down and right based on the mouse position.\n      moveRight = offsetLeft + (coords.pageX - xInitPos);\n      moveDown  = offsetTop + (coords.pageY - yInitPos);\n\n      // Test if the box is being moved within the bounds of the image.\n      var withinLeftBounds = (width - cropBoxWidth) > moveRight ? true : false;\n      var withinTopBounds  = (height - cropBoxHeight) > moveDown ? true : false;\n\n      // Set the amount to move right or down base on if the box is within bounds.\n      if (withinLeftBounds) {\n        moveRight = (moveRight < 0) ? 0 : moveRight;\n      }\n      else {\n        moveRight = (width - cropBoxWidth);\n      }\n\n      if (withinTopBounds) {\n        moveDown = (moveDown < 0) ? 0 : moveDown;\n      }\n      else {\n        moveDown = (height - cropBoxHeight);\n      }\n    }\n\n    if (resizeState) {\n      dragState = false;\n\n      // Calculate the max amount the user can resize the box based on it's current position.\n      var widthMax = width - cropBoxLeft;\n      var heightMax = height - cropBoxTop;\n\n      // Test if the user is increasing or decreasing the size of the box.\n      var increasingSize     = (coords.pageX - resizeClickPositionX) > 0 ? true : false;\n      var decreasingSize     = (coords.pageX - resizeClickPositionX) < 0 ? true : false;\n\n      // How much to resize the box.\n      resizeHorizontal = initialCropBoxWidth + (coords.pageX - resizeClickPositionX);\n      resizeVertical   = initialCropBoxHeight + (coords.pageX - resizeClickPositionX);\n\n      // Set the bounding values based on the how much the box can be increased to\n      // and the minimum allowed size of the box.\n      if (increasingSize) {\n        if (resizeHorizontal >= widthMax) {\n          resizeHorizontal = widthMax;\n          resizeVertical = widthMax;\n        }\n\n        if (resizeVertical >= heightMax) {\n          resizeVertical = heightMax;\n          resizeHorizontal = heightMax;\n        }\n      }\n\n      if (decreasingSize) {\n        if (resizeHorizontal <= minScaled) {\n          resizeHorizontal = minScaled;\n          resizeVertical = minScaled;\n        }\n      }\n    }\n  };\n\n  /*\n   * Uses window.requestAnimationFrame to redraw the box in the DOM as the user drags the cropbox.\n   */\n  var dragBox = function() {\n    if(dragState) {\n      window.requestAnimationFrame(function() {\n        dragBox();\n      });\n    }\n\n    $cropBox.css(\"top\", moveDown);\n    $cropBox.css( \"left\", moveRight);\n  };\n\n  /*\n   * Uses window.requestAnimationFrame to redraw the box in the DOM as the user resizes the cropbox.\n   */\n  var resizeBox = function() {\n    if(resizeState) {\n      window.requestAnimationFrame(function() {\n        resizeBox();\n      });\n    }\n\n    $cropBox.css( \"height\", resizeVertical);\n    $cropBox.css( \"width\", resizeHorizontal);\n  };\n\n\n  /**\n   * Sets up the mouse events on the cropping interface using a give width and height.\n   *\n   * @param {number} width     Width of the crop area.\n   * @param {number} height    Height of the crop area.\n   */\n  var croppingReset = function (width, height) {\n\n    // Turn off any previously bound events so\n    // we can rebind them later using new settings.\n    $(document).off(\"touchmove mousemove\");\n    $(document).off(\"touchend mouseup\");\n\n    // Allow the user to drag the cropbox.\n    $cropBox.on(\"touchstart mousedown\", function(event) {\n      event.preventDefault();\n      dragState = true;\n      onMouseDown(event);\n    });\n\n    // Allow the user to resize the cropbox.\n    $(\".resize-handle\").on(\"touchstart mousedown\", function(event) {\n      event.preventDefault();\n      resizeState = true;\n      onMouseDown(event);\n    });\n\n    // Turn off any interaction when the user releases the mouse.\n    $(document).on(\"touchend mouseup\", function() {\n      onMouseUp();\n    });\n\n    // Calculate all the things needed to animate the box as the user moves the mouse.\n    $(document).on(\"touchmove mousemove\", function(event) {\n      onMouseMove(width, height, event);\n    });\n  };\n\n  /**\n   * This sets up the cropping interface with a given height and width.\n   *\n   * @param {number} width     Width of the crop area.\n   * @param {number} height    Height of the crop area.\n   */\n  var setupCrop = function(width, height) {\n    if (!$previewImage.length) {\n      return;\n    }\n\n    var $cropContainer = $previewImage.parent();\n    var cropBoxSize = getCropBoxSize(width, height, minScaled);\n    var left = Math.floor((width / 2) - (cropBoxSize / 2));\n    var top  = Math.floor((height / 2) - (cropBoxSize / 2))\n\n    // Expicitly set the dimensions of the crop area.\n    $cropContainer.width(width);\n    $cropContainer.height(height);\n\n    // Set the initial position of the cropbox in the center of the image\n    // and with a minimum value of 480px.\n    $cropBox.insertBefore($previewImage).css({\n      \"left\"   : left,\n      \"top\"    : top,\n      \"width\"  : cropBoxSize,\n      \"height\" : cropBoxSize\n    });\n\n    // Set the starting positions for the animations\n    moveDown         = top;\n    moveRight        = left;\n    resizeVertical   = cropBoxSize;\n    resizeHorizontal = cropBoxSize;\n\n    croppingReset(width, height);\n  };\n\n  /**\n   * Rotate an image in a container. When the image rotates, update the size\n   * of the container so it fits. Then, translate the image to the center of\n   * the new height of the container.\n   *\n   * @param {jQuery} $image     Image to be rotated.\n   * @param {number} degrees    How many degrees to rotate the image.\n   */\n  var rotateImage = function($image, degrees) {\n    var width          = $image.width();\n    var height         = $image.height();\n    var $cropContainer = $previewImage.parent();\n\n    // Calculate how much to translate the image by.\n    var translateDiff = getTranslateDifference(width, height, degrees);\n\n    if (degrees === 90 || degrees === 270) {\n      $cropContainer.css({\n        height: width\n      });\n\n      // reset cropping events with new dimensions of crop area.\n      setupCrop(height,width);\n    }\n    else {\n      $cropContainer.css({\n        height: height\n      });\n\n      setupCrop(width,height);\n    }\n\n    // Actually do the rotation and translation.\n    $image.css({\n      \"transform\" : \"rotate(\"+ degrees + \"deg) translate(\" + translateDiff + \"px, \" + translateDiff + \"px)\"\n    });\n  };\n\n  /**\n   * Populates fields in the main reportback form with values to use for cropping\n   * and rotating on the backend.\n   *\n   * @param {jQuery} form       The form to populate.\n   */\n  var populateFields = function($form) {\n    // Get the hidden form elements.\n    var $cropX        = $form.find(\"input[name='crop_x']\");\n    var $cropY        = $form.find(\"input[name='crop_y']\");\n    var $cropWidth    = $form.find(\"input[name='crop_width']\");\n    var $cropHeight   = $form.find(\"input[name='crop_height']\");\n    var $cropRotation = $form.find(\"input[name='crop_rotate']\");\n    var $captionField = $form.find(\"input[name='caption']\");\n    var caption       = $(\"#dosomething-reportback-image-form\").find(\"input[name='modal-caption']\").val();\n\n    // Calculate cropping information.\n    var cropValues = {\n      top     :  Math.round(($cropBox.offset().top - $previewImage.offset().top) * scale),\n      left    :  Math.round(($cropBox.offset().left - $previewImage.offset().left) * scale),\n      width   :  Math.round($cropBox.outerWidth() * scale),\n      height  :  Math.round($cropBox.outerHeight() * scale),\n      degrees :  degrees\n    };\n\n    // Populate fields.\n    $cropX.val(cropValues.left);\n    $cropY.val(cropValues.top);\n    $cropWidth.val(cropValues.width);\n    $cropHeight.val(cropValues.height);\n    $cropRotation.val(cropValues.degrees);\n    $captionField.val(caption);\n  };\n\n  /**\n   * Initiates cropping js.\n   *\n   * @param {Image} origImage  Image object to crop\n   */\n  var dsCropperInit = function(image) {\n    // Store the image;\n    origImage = image;\n\n    // Get the preview image.\n    $previewImage = $(\"#modal--crop\").find(\".preview\");\n\n    if (!$previewImage.length) {\n      return;\n    }\n\n    // Set global valuea.\n    previewImageWidth  = $previewImage.width();\n    previewImageHeight = $previewImage.height();\n    scale              = origImage.width / $previewImage.width();\n    minScaled          = getMinimumSize(minimum, scale);\n\n    // Create the crop area.\n    $previewImage.wrap($(\"<div class='crop-bounding-box'></div>\"));\n\n    // Turn on cropping.\n    setupCrop(previewImageWidth, previewImageHeight);\n\n    // Rotation\n    var $rotateButton = $(\".image-editor\").find(\".-rotate\");\n\n    // Turn off any previously bound events to this button.\n    $rotateButton.off(\"click\");\n    degrees = 0;\n\n    $rotateButton.on(\"click\", function(e) {\n      e.preventDefault();\n      degrees = (degrees === 360) ? 90 : degrees + 90;\n      rotateImage($previewImage, degrees);\n    });\n  };\n\n  return {\n    dsCropperInit  : dsCropperInit,\n    populateFields : populateFields\n  };\n});\n\n","  /**\n   * Creates a front-end preview of a reportback image given crop values.\n   */\ndefine('images/ImageCropPreview',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $                      = require(\"jquery\");\n  var $cropPreview           = $(\"<figure class='reportback__submission-cropped'></figure>\");\n  var $reportbackSubmissions = $(\".reportback__submissions\");\n  var $reportbackUploadBtn   = $(\".gigantor\");\n\n  /**\n   * Tests if this is the first reportback submission or not.\n   */\n  var firstSubmission = function() {\n    return ($(\".reportback__submission-latest\").length) ? false : true;\n  };\n\n  /**\n   * This returns the amount to translate an image after it has been rotated so\n   * so that it stays center in it's container.\n   * @TODO - this is a duplicate of a function used in ImageCrop.js. This needs to\n   * be made more DRY. Create a separate \"ImageCropUtilities.js\" file that can\n   * hold functions that pertain to calculations needed for cropping and rotation.\n   * This should also help clean up the cropping script for easier reading.\n   *\n   * @param {number} width      Width of the image.\n   * @param {number} height     height of the image.\n   * @param {number} degrees    How many degrees the image has been rotated.\n   */\n  var getTranslateDifference = function(width, height, degrees) {\n    var translateDiff = (width / 2) - (height / 2);\n\n    if (degrees === 90 || degrees === 270) {\n      return (degrees === 270) ? -(translateDiff) : translateDiff;\n    }\n    else {\n      return 0;\n    }\n  };\n\n  /**\n   * This function actually creates the crop preview image by calculating where to\n   * position the image within a square container so it looks like the crop the user chose.\n   * The positioning is based on crop and rotation that the user chose.\n   *\n   * @param {number} imageWidth      Width of the original image (not scaled).\n   * @param {number} imageHeight     height of the original image (not scaled).\n   * @param {object} cropValues      An object containing x, y, width, and height values describing the crop.\n   */\n  var getCropPreviewValues = function(imageWidth, imageHeight, cropValues) {\n    var cropPreviewSize = $cropPreview.width();\n    var horizontalScale = cropValues.width / cropPreviewSize;\n    var verticalScale   = cropValues.height / cropPreviewSize;\n    var newWidth        = imageWidth / horizontalScale;\n    var newHeight       = imageHeight / verticalScale;\n    var translateDiff   = getTranslateDifference(newWidth, newHeight, cropValues.degrees);\n\n    return {\n      \"left\"      : -(cropValues.x / horizontalScale) + \"px\",\n      \"top\"       : -(cropValues.y / verticalScale) + \"px\",\n      \"width\"     : newWidth,\n      \"height\"    : newHeight,\n      \"transform\" : \"rotate(\"+ cropValues.degrees + \"deg) translate(\" + translateDiff + \"px, \" + translateDiff + \"px)\",\n    };\n  };\n\n  /**\n   * This function handles DOM elements that are already on the page to make room for the crop preview image.\n   */\n  var setUpCropPreview = function() {\n    // If this is the first reportback submission, we need to hide the original button.\n    if (firstSubmission()) {\n      $reportbackUploadBtn.hide();\n    }\n    // Otherwise, move the current reportback into the thumbnail list of reportbacks\n    else {\n      var $lastestSubmission = $reportbackSubmissions.find(\".reportback__submission-latest img\");\n      var $reportbackSubmissionsList = $reportbackSubmissions.find(\".reportback__submissions-list\");\n\n      // Check if there is a list of reportbacks already on the page,\n      // if not, create one to put the old reportback in.\n      if (!$reportbackSubmissionsList.length) {\n        $reportbackSubmissionsList = $(\"<ul class='reportback__submissions-list gallery'></ul>\");\n        $reportbackSubmissions.append($reportbackSubmissionsList);\n      }\n\n      // If there are already 4 reportback submissions, then remove the last one\n      // and put the current one at the start of the list.\n      var submissionCount = $reportbackSubmissionsList.find(\"li\").length;\n      if (submissionCount === 4) {\n        $(\".reportback__submissions-list li:last-child\").remove();\n      }\n\n      $lastestSubmission.prependTo($reportbackSubmissionsList).wrap(\"<li></li>\");\n    }\n  };\n\n  // Create a preview of the crop.\n  var cropPreview = function(image, cropValues) {\n    // Save the original image dimensions.\n    var imageHeight   = image.height;\n    var imageWidth    = image.width;\n    var $previewImage = \"<img src='\" + image.src + \"'/>\";\n\n    // Add crop preview to the page.\n    setUpCropPreview();\n    $cropPreview.prependTo($reportbackSubmissions).empty().append($previewImage);\n\n    // Set heigth of the preview containter to be the sames as the computed width.\n    // This is so the preview container is always a square.\n    $cropPreview.css(\"height\", $cropPreview.width());\n\n    // Create the crop preview.\n    var cropPreviewValues = getCropPreviewValues(imageWidth, imageHeight, cropValues);\n    $cropPreview.find(\"img\").css(cropPreviewValues);\n\n    var $reportbackCaption = $(\".reportback__submission__copy\");\n\n    if ($(\".reportback__submission__copy\").length) {\n      $reportbackCaption.text(cropValues.caption);\n    }\n    else {\n      $reportbackCaption = $(\"<figcaption class=\\\"reportback__submission__copy\\\">\");\n      $cropPreview.after($reportbackCaption.text(cropValues.caption));\n    }\n  };\n\n  return {\n    cropPreview : cropPreview,\n  };\n});\n\n","define('images/ImageUpload',['require','jquery','modal','validation','images/ImageCrop','../images/ImageCropPreview'],function(require) {\n  \"use strict\";\n\n  var $                = require(\"jquery\");\n  var Modal            = require(\"modal\");\n  var Validation       = require(\"validation\");\n  var ImageCrop        = require(\"images/ImageCrop\");\n  var ImageCropPreview = require(\"../images/ImageCropPreview\");\n\n\n  /**\n   * Handles the modal interface for image upload buttons.\n   * Requires a modal to be on the page with an id '#modal--crop'\n   * The modal should have a form '#dosomething-reportback-image-form'\n   * and a div to place the image preview '.image-wrapper'.\n   *\n   * @param {jQuery} $button  The file upload button\n   */\n  var ImageUpload = function($button) {\n    this.$uploadButton          = $button;\n    this.$uploadButtonLabel     = this.$uploadButton.closest('label');\n    this.$cropModal             = $(\"#modal--crop\");\n    this.$reportbackForm        = $(\"#dosomething-reportback-form\");\n    this.$imageForm             = this.$cropModal.find(\"#dosomething-reportback-image-form\");\n    this.$imageCaption          = this.$imageForm.find(\"#modal-caption\");\n    this.$cropButton            = this.$imageForm.find(\".button\");\n    this.$imagePreview          = this.$cropModal.find(\".image-preview\");\n    this.$reportbackSubmissions = $(\".reportback__submissions\");\n    this.imageValues            = {};\n    this.readyToSave            = false;\n\n    // Validation\n    this.fileTypes              = [\"image/png\", \"image/gif\", \"image/jpeg\", \"image/pjpeg\"];\n    this.fileSizeLimit          = 10000000; // 10mb\n    this.typeError              = \"Only JPEG, PNG, and GIF images are allowed\";\n    this.dimensionsError        = \"Please upload a larger photo. Min. size is 480px by 480px.\";\n    this.sizeError              = \"Please upload an image under 10MB\";\n\n    this.init();\n  };\n\n  /**\n   * Initalizes event listeners\n   *\n   */\n  ImageUpload.prototype.init = function () {\n    var _this = this;\n\n    this.$uploadButton.on(\"change\", function(event) {\n      event.preventDefault();\n\n      var files = !!this.files ? this.files : [];\n\n      // If no file selected/no FileReader support, we're all done\n      if (!files.length || !window.FileReader) {\n        return;\n      }\n\n      // Validate image type and file size before proceeding.\n      if (!_this.validImageType(files)) {\n        _this.showError(_this.typeError);\n\n        return;\n      }\n\n      if (!_this.validFileSize(files)) {\n        _this.showError(_this.sizeError);\n\n        return;\n      }\n\n      var fr = new FileReader();\n\n      if (window.navigator.userAgent.match(/iPad/i) || window.navigator.userAgent.match(/iPhone/i)) {\n        fr.readAsArrayBuffer(this.files[0]);\n        fr.onload = function () {\n          var blob = _this.getStrippedBlob(this.result);\n          var urlCreator = window.URL || window.webkitURL;\n          var imageUrl = urlCreator.createObjectURL(blob);\n          _this.loadImage(imageUrl);\n        };\n      }\n      else {\n        fr.readAsDataURL(files[0]);\n\n        fr.onloadend = function() {\n          var result = this.result;\n          _this.loadImage(result);\n        };\n      }\n    });\n\n    Modal.Events.subscribe(\"Modal:Close\", function() {\n      _this.resetFileField();\n\n      // Move the upload button back into the form.\n      _this.moveUploadButton(_this.$uploadButtonLabel);\n\n      if (_this.readyToSave) {\n        // Add a button to edit the image.\n        _this.createEditButton();\n      }\n    });\n\n    // When the modal opens, move the upload button into the modal,\n    // so users can change their photo.\n    Modal.Events.subscribe(\"Modal:Open\", function() {\n      _this.moveUploadButton($(\".-change .button\"));\n    });\n  };\n\n  /**\n   * Detatches and moves the current upload button\n   * @param {jQuery}  $el  The element to move the button to.\n   */\n  ImageUpload.prototype.moveUploadButton = function($el) {\n    var $button = this.$uploadButton.detach();\n\n    $button.appendTo($el);\n  };\n\n  /**\n   * Validates the caption field in the modal.\n   * @param  {Function} callback  If validation passes, then lets rock on!\n   * @return {void}\n   */\n  ImageUpload.prototype.validateCaption = function(callback, image) {\n    var _this = this;\n\n    Validation.validateField(this.$imageCaption, true, function($field, result) {\n      Validation.showValidationMessage($field, result);\n\n      if (result.success) {\n        callback(_this, image);\n      }\n    });\n  };\n\n\n  /**\n   * Everything is set, engage in cropping the selected image.\n   * @param  {object} data  ImageUpload object.\n   * @param  {object} image  Image object.\n   * @return {void}\n   */\n  ImageUpload.prototype.engageImageCrop = function(data, image) {\n    var _this = data;\n\n    // Send crop information to the main reportback form\n    // so backend can use to crop.\n    ImageCrop.populateFields(_this.$reportbackForm);\n\n    // Create a crop preview on the client side.\n    ImageCropPreview.cropPreview(image, _this.getCropValues());\n\n    // The user clicked \"done\", so we can save this version of the crop\n    // and not reset the file field.\n    _this.readyToSave = true;\n\n    // Close the modal.\n    Modal.close();\n  };\n\n\n  /**\n   * Opens the modal making sure the done button is reset.\n   */\n  ImageUpload.prototype.openModal = function() {\n    this.enableSubmit();\n\n    Modal.open(this.$cropModal,\n      {\n        animated: false,\n        closeButton: \"closeButtonOnly\"\n      }\n    );\n  };\n\n  /**\n   * Clears the file field input and resets it globally,\n   * if the user accidentally closed out of the modal.\n   * Allows the user to re-upload an image and edit it.\n   */\n  ImageUpload.prototype.resetFileField = function() {\n    var $input = this.$uploadButton;\n\n    if (!this.readyToSave) {\n      $input.replaceWith(this.$uploadButton = $input.val(\"\").clone(true));\n    }\n  };\n\n  /**\n   * Creates a button the user can click to re-open the modal\n   * and edit the crop they selected.\n   */\n  ImageUpload.prototype.createEditButton = function() {\n    var _this = this;\n    if (!this.$reportbackSubmissions.find(\".button--edit\").length) {\n      var $editButton = $(\"<span class='button button--edit -tertiary'>edit photo</span>\");\n      this.$uploadButton.parent().hide().before($editButton);\n\n      $editButton.click(function() {\n        _this.openModal();\n      });\n    }\n  };\n\n  /**\n   * Gets crop values from form and returns an object.\n   */\n  ImageUpload.prototype.getCropValues = function() {\n    return {\n      x       : this.$reportbackForm.find(\"input[name='crop_x']\").val(),\n      y       : this.$reportbackForm.find(\"input[name='crop_y']\").val(),\n      width   : this.$reportbackForm.find(\"input[name='crop_width']\").val(),\n      height  : this.$reportbackForm.find(\"input[name='crop_height']\").val(),\n      degrees : parseInt(this.$reportbackForm.find(\"input[name='crop_rotate']\").val()),\n      caption : this.$reportbackForm.find(\"input[name='caption']\").val()\n    };\n  };\n\n  /**\n   * Enables submit button in modal when it opens.\n   */\n  ImageUpload.prototype.enableSubmit = function() {\n    var $submitButton = this.$cropModal.find(\".-done\");\n\n    if ($submitButton.prop(\"disabled\")) {\n      $submitButton.prop(\"disabled\", false);\n    }\n\n    if ($submitButton.hasClass(\"is-loading\")) {\n      $submitButton.removeClass(\"is-loading\");\n    }\n  };\n\n  /**\n   * Validates image size.\n   */\n  ImageUpload.prototype.validImageSize = function(image) {\n    return (image.width >= 480 && image.height >= 480);\n  };\n\n  /**\n   * Validates image type.\n   */\n  ImageUpload.prototype.validImageType = function(files) {\n    // Get the file extension.\n    var extension = files[0].type;\n\n    // Check that it is a valid file type.\n    return this.fileTypes.indexOf(extension) > -1;\n  };\n\n  /**\n   * Validates file size.\n   */\n  ImageUpload.prototype.validFileSize = function(files) {\n    // Get the file extension.\n    var size = files[0].size;\n\n    // Check that it is a valid file type.\n    return (size <= this.fileSizeLimit) ? true : false;\n  };\n\n\n  /**\n   * Remove any previously added error message.\n   */\n  ImageUpload.prototype.removeError = function() {\n    var $errorMsg = this.$uploadButton.parent().siblings(\".error\");\n\n    if ($errorMsg.length) {\n      $errorMsg.remove();\n    }\n  };\n\n  /**\n   * Show an error message.\n   *\n   * param {string}  Error message to be shown.\n   */\n  ImageUpload.prototype.showError = function(msg) {\n    this.removeError();\n\n    var $error = $(\"<div class='messages error'>\" + msg + \"</div>\");\n\n    // Check if the modal was open when they subitted the bad image.\n    if (Modal.isOpen()) {\n      Modal.close();\n    }\n\n    this.$reportbackSubmissions.prepend($error);\n  };\n\n  /**\n   * Resizes an image so that the dimensions of the scaled image.\n   * are never greater than it's container's maximum width (height of the container is variable).\n   *\n   * @param {jQuery} $image           The image to resize.\n   * @param {jQuery} $container       The container to resize within.\n   */\n  ImageUpload.prototype.resizeImage = function($image, $container) {\n    var imageWidth  = $image.width();\n    var imageHeight = $image.height();\n    var containerMaxWidth = $container.width();\n    var orientation = (imageWidth > imageHeight) ? \"landscape\" : \"portrait\";\n\n    if ((imageWidth > containerMaxWidth) || (imageHeight > containerMaxWidth)) {\n      if (orientation === \"portrait\") {\n        $image.height(containerMaxWidth);\n      }\n      else {\n        $image.width(containerMaxWidth);\n      }\n    }\n    else {\n      return;\n    }\n  };\n\n  /**\n   * Creates a preview image of an uploaded file and adds it to a container.\n   * If cropping is enabled, it initiates the cropping script.\n   *\n   * @param {jQuery} fileReaderResult   The result property of a file reader object.\n   * @param {jQuery} $imageContainer    The DOM element to put the preview image in.\n   */\n  ImageUpload.prototype.previewImage = function(image, $imageContainer) {\n    var _this = this;\n\n    var $preview = $(\"<img class='preview' src=''>\");\n    $imageContainer.html($preview);\n\n    $preview.attr(\"src\", image.src).load(function() {\n      var $this = $(this);\n\n      _this.resizeImage($this, $imageContainer);\n\n      ImageCrop.dsCropperInit(image);\n    });\n  };\n\n  ImageUpload.prototype.loadImage = function(imageUrl) {\n    var _this = this;\n    var image = new Image();\n    image.src = imageUrl;\n\n    image.onload = function() {\n      var isValidSize = _this.validImageSize(this);\n\n      _this.removeError();\n\n      if(isValidSize) {\n        // Open the modal.\n        _this.openModal();\n\n        // Add the preview image to the modal\n        _this.previewImage(image, _this.$imagePreview);\n\n        //Unbind before rebind so it doesnt fire twice.\n        _this.$cropButton.off(\"click\");\n\n        // When the user submits the modal form, send crop values to the form.\n        _this.$cropButton.on(\"click\", function(event) {\n          event.preventDefault();\n\n          // Validate the caption field and make sure we are good to proceed.\n          _this.validateCaption(_this.engageImageCrop, image);\n        });\n      }\n      // Show user an error if they upload an image that is too small.\n      else {\n        _this.showError(_this.dimensionsError);\n      }\n    };\n  };\n\n  /**\n   * This function strips out EXIF data from a file and recreates a\n   * FileReader Blob that we use to create the image object that is used\n   * in the modal. This way we only deal with the RAW image file on both\n   * mobile and desktop with out having to wory about it rendering differently\n   * and causing all of our image cropping/preview logic to be wrong.\n   *\n   * @TODO - try moving this into a web worker to enhance performance.\n   */\n  ImageUpload.prototype.getStrippedBlob = function(fileReaderResult) {\n    var dataView = new DataView(fileReaderResult);\n    var offset = 0;\n    var recess = 0;\n    var pieces = [];\n    var i = 0;\n    var generatedBlob;\n\n    if (dataView.getUint16(offset) === 0xffd8) {\n      offset   += 2;\n      var app1  = dataView.getUint16(offset);\n      offset   += 2;\n\n      // This loop doing the acutal reading of the data\n      // and creating an array with only the pieces we want.\n      while (offset < dataView.byteLength) {\n        if (app1 === 0xffe1) {\n          pieces[i] = {\n            recess : recess,\n            offset : offset - 2\n          };\n\n          recess = offset + dataView.getUint16(offset);\n\n          i++;\n        }\n        else if (app1 === 0xffda) {\n          break;\n        }\n\n        offset   += dataView.getUint16(offset);\n        app1  = dataView.getUint16(offset);\n        offset   += 2;\n      }\n\n      // If the file had EXIF data and it was removed,\n      // create a file blob with using the new array of file data.\n      if (pieces.length > 0) {\n        var newPieces = [];\n\n        pieces.forEach(function(v) {\n          newPieces.push(fileReaderResult.slice(v.recess, v.offset));\n        }, this);\n\n        newPieces.push(fileReaderResult.slice(recess));\n\n        generatedBlob = new Blob(newPieces, {type: \"image/jpeg\"});\n      }\n      // If no EXIF data existed on the file, then nothing was done to it.\n      // We can just create a blob with the original data.\n      else {\n        generatedBlob = new Blob([dataView], {type: \"image/jpeg\"});\n      }\n    }\n    // @TODO - If it is not a jpeg, create a png. We can work out a more\n    // robust fix for this that maybe only runs through the EXIF\n    // stuff if it is a jpeg in the first place.\n    else {\n      generatedBlob = new Blob([dataView], {type: \"image/png\"});\n    }\n    return generatedBlob;\n  };\n\n  return ImageUpload;\n\n});\n\n","\ndefine('text!images/templates/fallback-upload-interface.tpl.html',[],function () { return '<div class=\"file-selection\">\\n  <p class=\"file-selection__indicator\">\\n    <strong>Selected Photo:</strong> <span class=\"file-selection__name\"><%= file %></span>\\n  </p>\\n  <label class=\"<%= classes %>\">\\n    <span>Change photo</span>\\n  </label>\\n</div>\\n';});\n\n","/**\n * Provides a fallback for customized file input if the File API is not supported.\n */\ndefine('images/ImageUploadFallback',['require','jquery','lodash','text!images/templates/fallback-upload-interface.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $                    = require(\"jquery\");\n  var _                    = require(\"lodash\");\n  var fallbackUploadTplSrc = require(\"text!images/templates/fallback-upload-interface.tpl.html\");\n\n\n  var ImageUploadFallback = {\n\n    component: {\n      $container: null,\n      $fileInterface: null,\n      $indicator: null,\n      $input: null,\n      fileName: null,\n      id: null,\n      classes: [\n        'button',\n        'button--file',\n        '-tertiary'\n      ]\n    },\n\n\n    /**\n     * Initialize the fallback file input script.\n     * @param  {jQuery}  $input     Button input from form.\n     * @param  {string}  container  Container Class name for container that should house fallback components.\n     * @return void\n     */\n    init: function ($input, container) {\n      $input.attr('class', '');\n\n      this.component.$input = $input;\n      this.component.id = $input.attr('id');\n      this.component.$container = $(container);\n\n      this.activateInput(this.component.$input);\n    },\n\n\n    /**\n     * Activate the input to watch for file input change event.\n     * @param  {jQuery}  $input Specific file input.\n     * @return void\n     */\n    activateInput: function ($input) {\n      var _this = this;\n\n      $input.on('change', function (event) {\n        _this.component.fileName = _this.getFileName(event.target.value);\n\n        if (_this.component.$fileInterface) {\n          _this.updateFileSelection();\n        }\n        else {\n          _this.buildUpatedComponent();\n        }\n      });\n    },\n\n\n    /**\n     * Remove markup from the specified container.\n     * Clear it out to insert new interface.\n     * @return void\n     */\n    emptyContainer: function () {\n      this.component.$container.html('');\n    },\n\n\n    /**\n     * Get the file name for the uploaded file.\n     * @param  {string}  path  Full path string for uploaded image.\n     * @return string          Extracted file name from the full path.\n     */\n    getFileName: function (path) {\n      var start = path.indexOf(\"fakepath\\\\\");\n\n      if (start >= 0) {\n        return path.substring(start + 9, path.length); // 9 is length of \"fakepath\\\"\n      }\n\n      return path;\n    },\n\n\n    /**\n     * Construct the new interface component for the file api fallback.\n     * @return void\n     */\n    buildUpatedComponent: function () {\n      var data = {\n        \"id\": this.component.id,\n        \"classes\": this.component.classes.join(' '),\n        \"file\": this.component.fileName\n      };\n      var $markup = $(_.template(fallbackUploadTplSrc, data));\n\n      this.component.$input.detach();\n      $markup.find('.button--file').append(this.component.$input);\n\n      this.emptyContainer();\n      this.component.$indicator = $markup.find('.file-selection__name');\n      this.component.$fileInterface = $markup;\n      this.insertUpdatedComponent();\n    },\n\n\n    /**\n     * Insert the new interface into the specified container.\n     * @return void\n     */\n    insertUpdatedComponent: function () {\n      this.component.$container.prepend(this.component.$fileInterface);\n    },\n\n\n    /**\n     * Update just the file name displayed in the new file api interface.\n     * @return void\n     */\n    updateFileSelection: function () {\n      this.component.$indicator.text(this.component.fileName);\n    }\n  };\n\n\n  return ImageUploadFallback;\n});\n\n","\ndefine('text!reportback/templates/reportback.tpl.html',[],function () { return '<% if (isListItem) { %><li><% } %>\\n<figure class=\"photo -stacked -framed\">\\n  <img src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=\" alt=\"<%= caption %>\" data-src=\"<%= image %>\" />\\n  <figcaption class=\"__copy\"><%= caption %></figcaption>\\n</figure>\\n<% if (isListItem) { %></li><% } %>\\n';});\n\n","define('reportback/Reportback',['require','jquery','lodash','modal','../images/ImageUpload','../images/ImageUploadFallback','text!reportback/templates/reportback.tpl.html'],function(require) {\n  \"use strict\";\n\n  var $                   = require(\"jquery\");\n  var _                   = require(\"lodash\");\n  var Modal               = require(\"modal\");\n  var ImageUpload         = require(\"../images/ImageUpload\");\n  var ImageUploadFallback = require(\"../images/ImageUploadFallback\");\n  var reportbackTplSrc    = require(\"text!reportback/templates/reportback.tpl.html\");\n\n\n  var Reportback = {\n\n    $initialGallery: null,\n    $extendedGallery: null,\n    $viewMoreContainer: null,\n    $viewMoreButton: null,\n    $spinner: null,\n\n    apiUrl: \"/api/v1/campaigns\",\n\n    nid: null,\n\n    offset: 0,\n\n    itemsPrefetched: 0,\n\n    itemsTotal: null,\n\n    bundleSize: 12,\n\n    requestSize: 60,\n\n    inventory: [],\n\n    currentIndex: 0,\n\n    galleryInDom: false,\n\n\n    /**\n     * Initialize the Reportback interface.\n     *\n     * @param  {jQuery} $container  Reportback container object.\n     */\n    init: function ($container) {\n      this.reportbackContainer = $container;\n      this.$reportbackWrapper  = this.reportbackContainer.find(\".wrapper\");\n      this.$reportbackForm     = this.reportbackContainer.find(\"#dosomething-reportback-form\");\n      this.$uploadButton       = this.reportbackContainer.find(\".js-image-upload\");\n      this.$captionField       = this.$reportbackForm.find(\".form-item-caption\");\n      this.$initialGallery     = $container.find(\".gallery--reportback\");\n\n      // Number of Approved Reportbacks obtained to help fill initial gallery.\n      this.itemsPrefetched = $container.data(\"prefetched\");\n      // Total number of Approved Reportbacks discounting any that were already prefetched.\n      this.itemsTotal      = $container.data(\"total\") - this.itemsPrefetched;\n      this.nid             = $container.data(\"nid\");\n      this.offset          = this.itemsPrefetched;\n\n      if (this.itemsPrefetched < this.itemsTotal) {\n        this.apiUrl = this.buildApiUrl();\n        this.enableViewMore();\n        this.enableResponsive();\n      }\n\n      if (Modernizr.filereader) {\n        this.imageUploadInit();\n      }\n      else {\n        ImageUploadFallback.init(this.$uploadButton, '.reportback__submissions');\n      }\n    },\n\n\n    imageUploadInit: function () {\n      var _this = this;\n      var imageUpload = new ImageUpload(this.$uploadButton);\n\n      this.$captionField.hide();\n    },\n\n\n    /**\n     * Add the reportback entries to the DOM.\n     * Adds the entire extended gallery if it does not exist already,\n     * otherwise just appends the additional entries.\n     *\n     * @param {Integer} inventoryIndex Index to start appending the next Reportback in gallery.\n     */\n    appendEntries: function (inventoryIndex) {\n      var start    = inventoryIndex;\n      var end      = start + this.bundleSize;\n      var $cluster = $();\n      var $images  = null;\n\n      if (this.outOfStock(end)) {\n        end = this.itemsTotal;\n      }\n\n      for (var i = start; i < end; i++) {\n        if (this.inventory[i] !== undefined) {\n          $cluster = $cluster.add(this.inventory[i]);\n        }\n      }\n\n      $images = $cluster.find(\"img\");\n\n      $images.unveil(100, function () {\n        var $this = $(this);\n\n        $this.load(function () {\n          $this.parent(\".photo\").addClass(\"-unveiled\");\n        });\n      });\n\n      if (!this.galleryInDom) {\n        this.insertGallery($cluster);\n      }\n      else {\n        this.$extendedGallery.append($cluster);\n      }\n\n      // @TODO: There has to be a better way to trigger unveil to execute and not require a scroll.\n      $(window).trigger(\"scroll\");\n    },\n\n\n    /**\n     * Build out the API URL with the campaign node id.\n     *\n     * @return {string}  API base url.\n     */\n    buildApiUrl: function () {\n      return this.apiUrl + \"/\" + this.nid + \"/gallery.json\";\n    },\n\n\n    /**\n     * Remove the View More button.\n     */\n    disableViewMore: function () {\n      this.$viewMoreButton.remove();\n    },\n\n\n    /**\n     * Add the View More button if there are additional reportbacks.\n     */\n    enableViewMore: function () {\n      var _this = this;\n\n      this.$viewMoreContainer = $(\"<div class=\\\"reportback__view-more\\\"></div>\");\n      this.$viewMoreButton = $(\"<button id=\\\"view-more-button\\\" class=\\\"button button--view-more -tertiary inline-alt-text-color\\\">View more</button>\");\n\n      this.$viewMoreContainer.append(this.$viewMoreButton);\n\n      if (this.isLargerMedia()) {\n        this.$viewMoreContainer.insertAfter(this.$reportbackWrapper);\n      }\n      else {\n        this.$viewMoreContainer.insertAfter(this.$initialGallery);\n      }\n\n\n      this.$viewMoreButton.on(\"click\", function () {\n        _this.evaluateInventory();\n      });\n    },\n\n\n    /**\n     * Enable Media Query check to shift around markup.\n     */\n    enableResponsive: function () {\n      var _this = this;\n\n      $(window).on(\"resize\", _.debounce(function () {\n        if (_this.isLargerMedia()) {\n          if (_this.$viewMoreContainer) {\n            _this.$viewMoreContainer.detach();\n            _this.$viewMoreContainer.insertAfter(_this.$reportbackWrapper);\n          }\n        } else {\n          if (_this.$viewMoreContainer) {\n            _this.$viewMoreContainer.detach();\n            _this.$viewMoreContainer.insertAfter(_this.$initialGallery);\n          }\n        }\n      }, 300));\n    },\n\n\n    /**\n     * Check to see if there are any reportback items currently in the\n     * inventory after each click of the View More button.\n     * If there are items already, then append them, otherwise if there are\n     * more in storage then request them to add to the inventory.\n     * If there's low inventory and no more in storage then remove the button.\n     */\n    evaluateInventory: function () {\n      if (this.inventory.length) {\n        if (this.lowInventory()) {\n          this.request(this.currentIndex);\n\n          if ((this.currentIndex += this.bundleSize) >= this.itemsTotal) {\n            this.currentIndex = this.itemsTotal;\n          }\n        }\n        else {\n          this.appendEntries(this.currentIndex);\n          this.currentIndex += this.bundleSize;\n        }\n      }\n      else {\n        this.request(this.currentIndex);\n        this.currentIndex += this.bundleSize;\n      }\n\n      if (this.outOfStock(this.currentIndex)) {\n        this.disableViewMore();\n      }\n    },\n\n\n    /**\n     * Insert the extended gallery into the DOM.\n     *\n     * @param  {string} data  Markup of list items.\n     */\n    insertGallery: function (data) {\n      var content = data || null;\n\n      this.$extendedGallery = $(\"<ul class=\\\"gallery gallery--extended\\\"></ul>\");\n\n      if (content) {\n        this.$extendedGallery.html(content);\n      }\n\n      this.$viewMoreContainer.prepend(this.$extendedGallery);\n\n      this.galleryInDom = true;\n    },\n\n\n    /**\n     * Check to see if media size is large.\n     * @return {boolean}\n     */\n    isLargerMedia: function () {\n      return ($(window).outerWidth() >= 760);\n    },\n\n\n    /**\n     * Check to see if the stock is running low and will need to retrieve\n     * more based on the current index item we are on in the stock list.\n     *\n     * @return {boolean}\n     */\n    lowInventory: function () {\n      if ((this.currentIndex + this.bundleSize) > this.inventory.length ) {\n        return true;\n      }\n\n      return false;\n    },\n\n\n    /**\n     * Check to see if we are completely out of reportback item stock,\n     * and can not request more.\n     *\n     * @return {boolean}\n     */\n    outOfStock: function (quantity) {\n      if (quantity >= this.itemsTotal) {\n        return true;\n      }\n\n      return false;\n    },\n\n\n    /**\n     * Ajax request to retrieve more reportback entries.\n     *\n     * @param {int} inventoryIndex  Value to indicate what index to start appending items from.\n     */\n    request: function (inventoryIndex) {\n      var _this = this;\n\n      $.ajax({\n        url: this.apiUrl,\n        dataType: \"json\",\n        data: {\n          offset: this.offset,\n          count: this.requestSize\n        },\n        beforeSend: function () {\n          if (_this.$spinner) {\n            _this.$spinner.show();\n          } else {\n            _this.$spinner = $(\"<div class=\\\"spinner\\\"></div>\");\n            _this.$viewMoreContainer.append(_this.$spinner);\n          }\n        }\n      }).done(function (response) {\n        _this.templatize(response);\n        _this.$spinner.hide();\n        _this.appendEntries(inventoryIndex);\n      }).fail(function () {\n        // @TODO: handle error here!\n\n      }).always(function () {\n        _this.offset = _this.inventory.length + _this.itemsPrefetched;\n      });\n    },\n\n\n    /**\n     * Use specified template to markup each reportback entry list item.\n     *\n     * @param {array} items Array of JSON objects containing reportback items.\n     */\n    templatize: function (items) {\n      for (var i = 0, count = items.length; i < count; i++) {\n        var data = {\n          \"id\": items[i].rbid,\n          \"image\": items[i].src,\n          \"caption\": items[i].caption,\n          \"status\": items[i].status,\n          \"isListItem\": true  // @TODO: probably a better way to address this... :insert shrug emoji here:\n        };\n\n        var markup = _.template(reportbackTplSrc, data);\n\n        this.inventory.push(markup);\n      }\n    }\n\n  };\n\n\n  return Reportback;\n});\n\n","/**\n * Enables \"toggle\" functionality on Footnote pattern.\n */\n\ndefine('neue/footnote',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  $(function() {\n\n    $(\".js-footnote-toggle\").each(function() {\n      var $content = $(this).closest(\".footnote\").find(\".js-footnote-hidden\");\n\n      // Hide content in a footnote if there's a toggle link.\n      $content.hide();\n\n      // Make toggle into a link\n      $(this).wrapInner(\"<a href='#'></a>\").on(\"click\", function(event) {\n        event.preventDefault();\n\n        $content.slideToggle();\n      });\n\n    });\n\n\n  });\n});\n\n","/**\n * Applies a smooth-scroll animation on links with the `.js-jump-scroll` class.\n */\n\ndefine('neue/jump-scroll',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  $(function() {\n    $(\".js-jump-scroll\").on(\"click\", function(event) {\n      event.preventDefault();\n\n      var href = $(this).attr(\"href\");\n\n      // Animate scroll position to the target of the link:\n      $(\"html,body\").animate({scrollTop: $(event.target.hash).offset().top}, \"slow\", function() {\n        // Finally, set the correct hash in the address bar.\n        window.location.hash = href;\n      });\n    });\n  });\n});\n\n","/**\n * Initializes site-wide menu chrome functionality.\n */\n\ndefine('neue/menu',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  $(function() {\n    // Toggle dropdown menu navigation on mobile:\n    $(\".js-navigation-toggle\").on(\"touchstart mousedown\", function(e) {\n      e.preventDefault();\n\n      $(\".chrome\").toggleClass(\"has-mobile-menu\");\n      $(\".navigation\").toggleClass(\"is-visible\");\n    });\n\n    // Hide footer on mobile until clicked\n    var $collapsible = $(\".js-toggle-collapsed\");\n    $collapsible.addClass(\"is-collapsed is-toggleable\");\n    $collapsible.on(\"click\", function() {\n      if( window.matchMedia(\"screen and (max-width: 768px)\").matches ) {\n        $(this).toggleClass(\"is-collapsed\");\n      }\n    });\n\n    // Toggle menu on dekstop\n    $(\".navigation__dropdown-toggle\").on(\"click\", function(e) {\n      e.preventDefault();\n      $(\".navigation__dropdown\").toggleClass(\"is-visible\");\n    });\n  });\n});\n\n","/**\n * @module neue/messages\n * System Messages. Will create a close (\"X\") button\n * for users with JavaScript enabled that uses the following\n * syntax to hook into this function:\n *\n * @example\n * //  <div class=\"js-message\">Alert! You win.</div>\n *\n * @returns\n * // <div class=\"js-message\">Alert! You win.\n * //   <a href=\"#\" class=\"js-close-message\">x</a>\n * // </div>\n */\n\ndefine('neue/messages',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  var messageClose = \"<a href=\\\"#\\\" class=\\\"js-close-message messages__close\\\"><span>Close</span></a>\";\n\n  /**\n  * Adds a close button to system message banner, with optional callback.\n  *\n  * @param {jQuery}   $messages  Object containing message divs to be modified.\n  * @param {function} callback   Callback fired after message is closed.\n  */\n  var attachCloseButton = function($messages, callback) {\n    // Create message close button\n    $messages.append(messageClose);\n\n    // Close message when \"x\" is clicked:\n    $messages.on(\"click\", \".js-close-message\", function(event) {\n      event.preventDefault();\n      $(this).parent(\".messages\").slideUp();\n\n      if(callback && typeof callback === \"function\") {\n        callback();\n      }\n    });\n  };\n\n  // Prepare any messages in the DOM on load\n  $(function() {\n    attachCloseButton( $(\".messages\") );\n  });\n\n  return {\n    attachCloseButton: attachCloseButton\n  };\n});\n\n","/**\n * Indicates current section in nav on scroll. Applies an `.is-active`\n * class when the specified `href` reaches the top of the viewport.\n *\n * Triggered by a `.js-scroll-indicator` on a link.\n */\n\ndefine('neue/scroll-indicator',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n  var links = [];\n\n  /**\n   * @see _.throttle\n   */\n  var throttle = function(func, wait, options) {\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n\n    options || (options = {});\n\n    var later = function() {\n      previous = new Date();\n      timeout = null;\n      result = func.apply(context, args);\n    };\n\n    return function() {\n      var now = new Date();\n      if (!previous && options.leading === false) previous = now;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n\n      if (remaining <= 0) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n\n      return result;\n    };\n  };\n\n  /**\n   * @see _.sortedIndex\n   */\n  function sortedIndex(array, value, key) {\n    var low = 0,\n    high = array ? array.length : low;\n\n    while (low < high) {\n      var mid = (low + high) >>> 1; // jshint ignore:line\n      (array[mid][key] < value) ? low = mid + 1 : high = mid;\n    }\n\n    return low ? low - 1 : low;\n  }\n\n  /**\n   * Modified binary search. Finds target key, or next lowest if\n   * it doesn't exist.\n   * @see _.binarySearch\n   */\n  function binarySearch(array, value) {\n    var index = sortedIndex(array, value, \"offset\");\n    return array[index];\n  }\n\n  // Registers links and their targets with scroll handler\n  function prepareIndicator($link) {\n    // Calculate the element's offset from the top of the page while anchored\n    var $linkTarget = $( $link.attr(\"href\") );\n    if( $linkTarget.length ) {\n      // Add jQuery object and offset value to link map\n      links.push({ offset: $linkTarget.offset().top, link: $link });\n    }\n  }\n\n  // Prepare all `.js-scroll-indicator` links on the page.\n  function preparePage() {\n    links = [];\n\n    $(\".js-scroll-indicator\").find(\"a\").each(function(index, link) {\n      prepareIndicator( $(link) );\n    });\n  }\n\n  var oldIndicator;\n  // Scroll handler: highlights the furthest link the user has passed\n  function updateScrollIndicators() {\n    var newIndicator = binarySearch(links, $(window).scrollTop() + 40);\n    // @NOTE: We use a 40px offset to trigger indicator slightly after scroll position\n    // (so that nav switches closer to where a user will likely be reading the text)\n\n    if(newIndicator && newIndicator.link) {\n      var newIndicatorParents = newIndicator.link.parentsUntil(\".js-scroll-indicator\");\n      var oldIndicatorParents = $();\n\n      if(oldIndicator && oldIndicator !== newIndicator) {\n        oldIndicator.link.removeClass(\"is-active\");\n        oldIndicatorParents = oldIndicator.link.parentsUntil(\".js-scroll-indicator\");\n      }\n\n      newIndicator.link.addClass(\"is-active\");\n      newIndicatorParents.addClass(\"is-active\");\n      oldIndicatorParents.not(newIndicatorParents).removeClass(\"is-active\");\n\n      oldIndicator = newIndicator;\n    }\n  }\n\n  // Attach our functions to their respective events.\n  $(function() {\n    preparePage();\n\n    var throttledScroll = throttle(updateScrollIndicators, 60);\n\n    $(window).on(\"scroll\", throttledScroll);\n    $(window).on(\"resize\", preparePage);\n  });\n\n});\n\n\n","define('neue/tabs',[],function() {\n  \"use strict\";\n\n  var $ = window.jQuery;\n\n  var $tabs = $(\".js-tabs\"),\n      $tabMenuLinks = $tabs.find(\".tabs__menu a\");\n\n  // Show the first tab in any \"js-tabs\" collection.\n  $tabs.each(function() {\n    $(this).find(\".tabs__tab\").first().addClass(\"is-active\");\n  });\n\n  // View other tabs on click.\n  $tabMenuLinks.on(\"click\", function(event) {\n    event.preventDefault();\n\n    var $this = $(this),\n        $siblings = $this.parent().siblings(),\n        selection = $this.data(\"tab\") - 1,\n        $tabs = $this.closest(\".js-tabs\").find(\".tabs__tab\"),\n        tab = $tabs.get(selection);\n\n    $siblings.removeClass(\"is-active\");\n    $this.parent().addClass(\"is-active\");\n\n    // Show selected tab.\n    $tabs.removeClass(\"is-active\");\n    $(tab).addClass(\"is-active\");\n\n  });\n\n});\n\n","/**\n * Main build script. This will compile modules into `neue.js`\n * and `neue.min.js` in dist package, and attach each module to\n * a NEUE global variable attached to the window.\n */\n\ndefine('neue/main',['require','./footnote','./jump-scroll','./menu','./messages','./scroll-indicator','./tabs'],function(require) {\n  \"use strict\";\n\n  // Attach modules to window\n  window.NEUE = {\n    Footnote: require(\"./footnote\"),\n    JumpScroll: require(\"./jump-scroll\"),\n    Menu: require(\"./menu\"),\n    Messages: require(\"./messages\"),\n    ScrollIndicator: require(\"./scroll-indicator\"),\n    Tabs: require(\"./tabs\")\n  };\n\n  return window.NEUE;\n});\n\ndefine('neue', ['neue/main'], function (main) { return main; });\n\n","define('campaign/SchoolFinder',['require','jquery','lodash','validation'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var _ = require(\"lodash\");\n  var Validation = require(\"validation\");\n\n  var shouldValidateForm = true;\n  var resultTpl = _.template(\"<li><a class='js-schoolfinder-result' data-gsid='<%- gsid %>' href='#'><span><%- name %></span> <em><%- city %>, <%- state %></em></a></li>\");\n\n  var getResults = function(state, query, limit, callback) {\n    var endpoint;\n    if(_.isEmpty(query) || _.isEmpty(state)) return callback([]);\n\n    try {\n      // Use Drupal dateFormat validation format if available\n      endpoint = Drupal.settings.dosomethingUser.schoolFinderAPIEndpoint;\n    } catch(e) {\n      endpoint = \"http://lofischools.herokuapp.com/search\";\n    }\n\n    $.ajax({\n      dataType: \"json\",\n      url: endpoint + \"?state=\" + state + \"&query=\" + query + \"&limit=\" + limit\n    }).done(function(data) {\n      callback(data.results, data.meta.more_results); // jshint ignore:line\n    }).fail(function() {\n      callback(false);\n    });\n  };\n\n  var displayResults = function($el, results, canShowMore) {\n    $el.empty();\n\n    if(!results) {\n      $el.append(\"<div class='messages error'>We couldn't load schools. Check your internet connection, or try refreshing the page.</div>\");\n      $el.show();\n      return;\n    }\n\n    _.each(results, function(result) {\n      $el.append(resultTpl(result));\n    });\n\n    if(results.length === 0) {\n      $el.append(\"<div class='messages error'>Hmm, we couldn't find your school based on how the name was entered. But it may still be there! Click on the link below for tips on finding your school.</div>\");\n    }\n\n    if(canShowMore) {\n      $el.append(\"<p class='schoolfinder-showmore'><a href='#' class='secondary js-schoolfinder-showmore'>Show More Results</a></p>\");\n    }\n\n    $el.show();\n  };\n\n  var initializeSchoolFinder = function($schoolSignupForm) {\n    var $stateField = $(\"#edit-school-administrative-area\");\n    var $schoolIDField = $schoolSignupForm.find(\"[name='school_id']\");\n    var $schoolSearchField = $schoolSignupForm.find(\".js-schoolfinder-search\");\n    var $schoolSearchResults = $schoolSignupForm.find(\".js-schoolfinder-results\");\n    var $notAffiliatedField = $(\"#edit-school-not-affiliated\");\n    var $notAffiliatedConfirmationMessage = $schoolSignupForm.find(\".js-school-not-affiliated-confirmation\");\n\n    var savedStateFieldState = \"\";\n    var getResultsThrottled = _.throttle(getResults, 1000);\n\n    // Set the form to default state.\n    $schoolSearchField.hide();\n    $schoolSearchResults.hide();\n\n    /**\n     * Event handler for the state select field.\n     */\n    $stateField.on(\"change\", function() {\n      // Show the school name field once user has chosen a state.\n      var stateSelected = $(this).val() !== \"\";\n      $schoolSignupForm.find(\".messages\").hide();\n      $schoolSearchField.val(\"\");\n      $schoolSearchField.trigger(\"keyup\");\n      $schoolSearchField.toggle(stateSelected);\n\n      if(stateSelected) {\n        $schoolSearchField.focus();\n      }\n    });\n\n    /**\n     * Event handler for school search field text input.\n     */\n    $schoolSearchField.on(\"keyup\", function() {\n      $schoolSignupForm.find(\".messages\").hide();\n      var val = $(this).val();\n\n      if(val !== \"\") {\n        $schoolSearchField.addClass(\"loading\");\n        getResultsThrottled( $stateField.val(), val, 10, function(res, moreAvailable) {\n          displayResults($schoolSearchResults, res, moreAvailable);\n          $schoolSearchField.removeClass(\"loading\");\n        });\n      } else {\n        $schoolSearchResults.hide();\n        $schoolIDField.val(\"\");\n      }\n    });\n\n    /**\n     * Event handler for clicking a result.\n     */\n    $schoolSearchResults.on(\"click\", \".js-schoolfinder-result\", function(e) {\n      e.preventDefault();\n\n      var $this = $(this);\n      $schoolIDField.val( $this.data(\"gsid\") );\n      $schoolSearchField.val( $this.find(\"span\").text() );\n\n      $this.addClass(\"is-selected\");\n      $this.parent(\"li\").siblings().hide();\n    });\n\n    /**\n     * Event handler for \"Show More\" link.\n     */\n    $schoolSignupForm.on(\"click\", \".js-schoolfinder-showmore\", function(e) {\n      e.preventDefault();\n\n      $(this).remove();\n\n      $schoolSearchField.addClass(\"loading\");\n      getResultsThrottled( $stateField.val(), $schoolSearchField.val(), 50, function(res) {\n        displayResults($schoolSearchResults, res, false);\n        $schoolSearchField.removeClass(\"loading\");\n      });\n    });\n\n    /**\n     * Event handler for the \"I'm not affiliated with a school\" checkbox.\n     */\n    $notAffiliatedField.on(\"change\", function() {\n      // If user is not entering a school, don't validate form.\n      shouldValidateForm = !this.checked;\n      $notAffiliatedConfirmationMessage.toggle(this.checked);\n\n      if(this.checked) {\n        savedStateFieldState = $stateField.val();\n        $stateField.val(\"\");\n        $schoolSearchField.val(\"\");\n        $schoolSearchField.trigger(\"keyup\");\n      } else {\n        $stateField.val(savedStateFieldState);\n        $notAffiliatedConfirmationMessage.hide();\n      }\n\n      $stateField.trigger(\"change\");\n    });\n\n    $schoolSignupForm.find(\".js-schoolfinder-help\").on(\"click\", function(event) {\n      event.preventDefault();\n      $(\".js-schoolfinder-help-content\").toggle();\n    });\n  };\n\n  $(document).ready(function() {\n    var $schoolSignupForm = $(\"#dosomething-signup-user-signup-data-form\");\n    if( $schoolSignupForm ) {\n      initializeSchoolFinder($schoolSignupForm);\n    }\n  });\n\n  /**\n   * Custom validation for the School Finder.\n   */\n  Validation.registerValidationFunction(\"school_finder\", function($el, done) {\n    var $schoolID = $el.find(\"[name='school_id']\");\n\n    if(!shouldValidateForm) {\n      // User has selected \"I'm not affiliated\" checkbox. Skip validation.\n      return done({ success: true });\n    }\n\n    if($schoolID.val() === \"\") {\n      // User has not selected a school.\n      $el.addClass(\"shake\");\n\n      // Remove any existing error messages.\n      $el.find(\".messages.error\").remove();\n\n      $el.append(\"<div class='messages error'>You haven't entered your school. Find your school by entering your state and then selecting a school from the search results.</div>\");\n\n      return done({ success: false });\n    }\n\n    // User has selected a school.\n    return done({ success: true });\n  });\n\n});\n\n","define('validators/auth',['require','validation','mailcheck'],function(require) {\n  \"use strict\";\n\n  var Validation= require(\"validation\");\n  var mailcheck = require(\"mailcheck\");\n\n  // # Helpers\n  // Basic sanity check used by email validation.\n  // This won't catch everything, but should prevent validating some simple mistakes\n  function isValidEmailSyntax(string) {\n    var email = string.toUpperCase();\n    if( email.match(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]+$/) ) {\n      var lastChar = \"\";\n      for(var i = 0, len = email.length; i < len; i++) {\n        // fail if we see two dots in a row\n        if(lastChar === \".\"  && email[i] === \".\") {\n          return false;\n        }\n\n        lastChar = email[i];\n      }\n\n      return true;\n    }\n\n    return false;\n  }\n\n  // @TODO: This will be removed when Neue's validation gets refactored.\n  function validateNotBlank(string, done, success, failure) {\n    if( string !== \"\" ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  // # Add validation functions...\n\n  // ## Name\n  // Greets the user when they enter their name.\n  Validation.registerValidationFunction(\"name\", function(string, done) {\n    validateNotBlank(string, done,\n      Drupal.t(\"Hey, @name!\", {\"@name\": string}),\n      Drupal.t(\"We need your first name.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"last_name\", function(string, done) {\n    validateNotBlank(string, done,\n      Drupal.t(\"Got it, @name!\", {\"@name\": string}),\n      Drupal.t(\"We need your last name.\")\n    );\n  });\n\n  // ## Birthday\n  // Validates correct date input, reasonable birthdate, and says a nice message.\n  Validation.registerValidationFunction(\"birthday\", function(string, done) {\n    var birthday, birthMonth, birthDay, birthYear, format;\n\n    try {\n      // Use Drupal dateFormat validation format if available\n      format = Drupal.settings.dsValidation.dateFormat;\n    } catch(e) {\n      format = \"MM/DD/YYYY\";\n    }\n\n    // parse date from string\n    if( format === \"MM/DD/YYYY\" && /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/.test(string) ) {\n      // US formatting\n      birthday = string.split(\"/\");\n      birthMonth = parseInt(birthday[0]);\n      birthDay = parseInt(birthday[1]);\n      birthYear = parseInt(birthday[2]);\n    } else if( format === \"DD/MM/YYYY\" && /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/.test(string) ) {\n      // UK formatting\n      birthday = string.split(\"/\");\n      birthDay = parseInt(birthday[0]);\n      birthMonth = parseInt(birthday[1]);\n      birthYear = parseInt(birthday[2]);\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Enter your birthday \" + format + \"!\")\n      });\n    }\n\n    // fail if incorrect month\n    if (birthMonth > 12 || birthMonth === 0) {\n      return done({\n        success: false,\n        message: Drupal.t(\"That doesn't seem right.\")\n      });\n    }\n\n    //list of last days in months and check for leap year\n    var endDates = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n    if(((birthYear % 4 === 0) && (birthYear % 100 !== 0)) || (birthYear % 400 === 0)){\n      endDates[2] = 29;\n    }\n\n    // fail if incorrect day\n    if (birthDay > endDates[birthMonth]) {\n      return done({\n        success: false,\n        message: Drupal.t(\"That doesn't seem right.\")\n      });\n    }\n\n    // calculate age\n    // Source: http://stackoverflow.com/questions/4060004/calculate-age-in-javascript#answer-7091965\n    var birthDate = new Date(birthYear, birthMonth - 1, birthDay);\n    var now = new Date();\n    var age = now.getFullYear() - birthDate.getFullYear();\n    var m = now.getMonth() - birthDate.getMonth();\n    if (m < 0 || (m === 0 && now.getDate() < birthDate.getDate())) {\n      age--;\n    }\n\n    if (age < 0)  {\n      return done({\n        success: false,\n        message: Drupal.t(\"Are you a time traveller?\")\n      });\n    } else if( age > 0 && age <= 25  ) {\n\n      if (birthDate.getMonth() === now.getMonth() && now.getDate() === birthDate.getDate() ) {\n        return done({\n          success: true,\n          message: Drupal.t(\"Wow, happy birthday!\")\n        });\n      } else if ( age < 10) {\n        return done({\n          success: true,\n          message: Drupal.t(\"Wow, you're @age!\", {\"@age\": age})\n        });\n      } else {\n        return done({\n          success: true,\n          message: Drupal.t(\"Cool, @age!\", {\"@age\": age})\n        });\n      }\n\n    } else if (age > 25 && age < 130) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Got it!\")\n      });\n    } else if (string === \"\") {\n      return done({\n        success: false,\n        message: Drupal.t(\"We need your birthday.\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"That doesn't seem right.\")\n      });\n    }\n  });\n\n  // ## Email\n  // Performs some basic sanity checks on email format (see helper method), and\n  // uses Kicksend's mailcheck library to offer suggestions for misspellings.\n  Validation.registerValidationFunction(\"email\", function(string, done) {\n    if ( isValidEmailSyntax(string) ) {\n      // we use mailcheck.js to find some common email mispellings\n      mailcheck.run({\n        email: string,\n        domains: [\"yahoo.com\", \"google.com\", \"hotmail.com\", \"gmail.com\", \"me.com\", \"aol.com\", \"mac.com\",\n                  \"live.com\", \"comcast.net\", \"googlemail.com\", \"msn.com\", \"hotmail.co.uk\", \"yahoo.co.uk\",\n                  \"facebook.com\", \"verizon.net\", \"sbcglobal.net\", \"att.net\", \"gmx.com\", \"mail.com\", \"outlook.com\",\n                  \"aim.com\", \"ymail.com\", \"rocketmail.com\", \"bellsouth.net\", \"cox.net\", \"charter.net\", \"me.com\",\n                  \"earthlink.net\", \"optonline.net\", \"dosomething.org\"],\n        suggested: function(s) {\n          return done({\n            success: true,\n            suggestion: s\n          });\n        },\n        empty: function() {\n          return done({\n            success: true,\n            message: Drupal.t(\"Great, thanks!\")\n          });\n        }\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"We need a valid email.\")\n      });\n    }\n  });\n\n  // ## Password\n  // Checks that password is 6 or more characters long.\n  // Matches validation performed in dosomething_user.module.\n  Validation.registerValidationFunction(\"password\", function(string, done) {\n    if(string.length >= 6) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Keep it secret, keep it safe!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Must be 6+ characters.\")\n      });\n    }\n  });\n\n  // ## Phone\n  // Matches validation performed in dosomething_user.module.\n  Validation.registerValidationFunction(\"phone\", function(string, done) {\n    // Matches server-side validation from `dosomething_user_valid_cell()` in `dosomething_user.module`.\n    var numberWithoutFormatting = string.replace(/[\\-\\s\\.]/g, \"\");\n    var isValidFormat = /^(?:\\+?([0-9]{1,3})([\\-\\s\\.]{1})?)?\\(?([0-9]{3})\\)?(?:[\\-\\s\\.]{1})?([0-9]{3})(?:[\\-\\s\\.]{1})?([0-9]{4})/.test(numberWithoutFormatting);\n\n    var sanitizedNumber = string.replace(/[^0-9]/g, \"\");\n    var allRepeatingDigits = /([0-9]{1})\\1{9,}/.test(sanitizedNumber);\n\n    if(isValidFormat && !allRepeatingDigits) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Thanks!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Enter a valid telephone number.\")\n      });\n    }\n  });\n});\n\n","define('validators/reportback',['require','validation','jquery'],function(require) {\n  \"use strict\";\n\n  var Validation = require(\"validation\");\n  var $          = require(\"jquery\");\n\n  // validate number of items\n  Validation.registerValidationFunction(\"positiveInteger\", function(string, done) {\n    var trimmedString = string.replace(\" \", \"\");\n    if( trimmedString !== \"\" && /^[1-9]\\d*$/.test(trimmedString) ) {\n      return done({\n        success: true,\n        message: Drupal.t(\"That's great!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Enter a valid number!\")\n      });\n    }\n  });\n\n  // validate that string isn't blank\n  Validation.registerValidationFunction(\"reportbackReason\", function(string, done) {\n    if( string !== \"\" ) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Thanks for caring!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Tell us why you cared!\")\n      });\n    }\n  });\n\n  // validate that string isn't blank and less than or equal to 60 characters\n  Validation.registerValidationFunction(\"caption\", function(string, done) {\n    if( string !== \"\" && string.length <= 60 ) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Sounds great!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"Tell us about your photo in 60 characters or less!\")\n      });\n    }\n  });\n});\n\n","define('validators/address',['require','jquery','validation'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n  var Validation= require(\"validation\");\n\n  /** @NOTE: Temporary, testing out some new ideas. */\n  var requiredValidator = function(string, done, args) {\n    if( string !== \"\" ) {\n      return done({\n        success: true,\n        message: args.success\n      });\n    } else {\n      return done({\n        success: false,\n        message: args.failure\n      });\n    }\n  };\n\n  /**\n   * Validators for individual address form fields:\n   */\n  Validation.registerValidationFunction(\"fname\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Oh hey, @fname!\", {\"@fname\": string}),\n      failure: Drupal.t(\"We need your name. Were on a first-name basis, right?\")\n    });\n  });\n\n  Validation.registerValidationFunction(\"lname\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"The @lname-inator! People call you that, right?\", {\"@lname\": string}),\n      failure: Drupal.t(\"We need your last name.\")\n\n    });\n  });\n\n  Validation.registerValidationFunction(\"address1\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Got it!\"),\n      failure: Drupal.t(\"We need your street name and number.\")\n    });\n  });\n\n  Validation.registerValidationFunction(\"address2\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Got that too!\"),\n      failure: \"\"\n    });\n  });\n\n  Validation.registerValidationFunction(\"city\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Sweet, thanks!\"),\n      failure: Drupal.t(\"We need your city.\")\n    });\n  });\n\n  Validation.registerValidationFunction(\"state\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"I \\u2764 @state\", {\"@state\": string}),\n      failure: Drupal.t(\"We need your state.\")\n    });\n  });\n\n  Validation.registerValidationFunction(\"zipcode\", function(string, done) {\n    if( string.match(/^\\d{5}(?:[-\\s]\\d{4})?$/) ) {\n      return done({\n        success: true,\n        message: Drupal.t(\"Almost done!\")\n      });\n    } else {\n      return done({\n        success: false,\n        message: Drupal.t(\"We need your zip code.\")\n      });\n    }\n  });\n\n  Validation.registerValidationFunction(\"why_signedup\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"Thanks for caring!\"),\n      failure: Drupal.t(\"Oops! Can't leave this one blank.\")\n    });\n  });\n\n\n  /**\n   * Custom validation for UPS address fieldset.\n   */\n  Validation.registerValidationFunction(\"ups_address\", function($el, done) {\n    var $sorryError = $(\n      \"<div class='messages error'>\" +\n        \"<strong>\" + Drupal.t(\"We couldn't find that address.\") + \"</strong>\" +\n        Drupal.t(\"Double check for typos and try submitting again.\") +\n      \"</div>\"\n    );\n\n    var $networkError= $(\n      \"<div class='messages error'>\" +\n        Drupal.t(\"We're having trouble submitting the form, are you sure your internet connection is working? Email us if you continue having problems.\") +\n      \"</div>\"\n    );\n\n    var addressFieldData = $el.find(\"select, input\").serializeArray();\n\n    // Remove previous messages.\n    $el.find(\".messages\").slideUp(function() { $(this).remove(); });\n\n    // Once we know we have, submit them to the AJAX endpoint\n    $.ajax({\n      type: \"POST\",\n      url: \"/user/validate/address\",\n      dataType: \"json\",\n      data: addressFieldData,\n      success: function(data) {\n\n        if(data.sorry) {\n          // Address is invalid and we don't have any suggestions\n          $el.append($sorryError).hide().slideDown();\n          return done({ success: false });\n        }\n\n        var hasFieldErrors = false;\n        for(var field in data) {\n          if(data.hasOwnProperty(field) && field !== \"ambiguous\") {\n            var suggestion = data[field];\n            var $fieldEl = $el.find(\"[name='user_address[\" + field + \"]']\");\n\n            // If just capitalizing or adding extra 4-digit to zip, don't show an error\n            if(  (field === \"postal_code\" && $fieldEl.val().slice(0,4) === suggestion.slice(0,4)) || (suggestion === $fieldEl.val().toUpperCase() ) ) {\n              $fieldEl.val( suggestion  );\n            } else {\n              // Otherwise, mark errors and ask user to correct them\n              hasFieldErrors = true;\n\n              Validation.showValidationMessage($fieldEl, {\n                success: false,\n                suggestion: {\n                  full: suggestion,\n                  domain: \"zip\"\n                }\n              });\n            }\n          }\n        }\n\n        if(hasFieldErrors) {\n          done({ success: false });\n        } else {\n          done({ success: true });\n        }\n\n      },\n      error: function() {\n        // We're having trouble getting the validation over AJAX, let's mark as\n        // validated and leave it up to the server just to be safe.\n        $el.append($networkError).hide().slideDown();\n        done({ success: false });\n      }\n    });\n  });\n\n\n  /**\n   * Validators for shirt reward fields:\n   */\n  Validation.registerValidationFunction(\"shirt_size\", function(string, done) {\n    return requiredValidator(string, done, {\n      success: Drupal.t(\"It'll fit great!\"),\n      failure: Drupal.t(\"We need a shirt size!\")\n    });\n  });\n\n  // Shirt style validor\n  // @TODO: add support to radio button validation in Neue\n  Validation.registerValidationFunction(\"shirt_style\", function($el, done) {\n    // collected checked radio's\n    var $checked = $el.find(\"input[type='radio']:checked\");\n\n    // message that will be injected upon error\n    var $errorMsg = $(\n      \"<div class='message error'>\" + Drupal.t(\"We need a shirt style!\") + \"</div>\"\n    );\n\n    // remove the error message before validation\n    $el.find(\".message\").remove();\n\n    if ($checked.length === 1) {\n      done({ success: true });\n    } else {\n      $el.find(\"label:first\").append($errorMsg);\n      done({ success: false });\n    }\n  });\n\n});\n\n","define('validators/donate',['require','validation'],function(require) {\n  \"use strict\";\n\n  var Validation= require(\"validation\");\n\n  // Credit card types\n  var cardTypes = {\n    Visa: {\n      name: \"Visa\",\n      numberPattern: /^4[0-9]{12}(?:[0-9]{3})?$/\n    },\n    Mastercard: {\n      name: \"MasterCard\",\n      numberPattern: /^5[1-5][0-9]{14}$/\n    },\n    AmericanExpress: {\n      name: \"American Express\",\n      numberPattern: /^3[47][0-9]{13}$/\n    },\n    DinersClub: {\n      name: \"Diners Club\",\n      numberPattern: /^3(?:0[0-5]|[68][0-9])[0-9]{11}$/\n    },\n    Discover: {\n      name: \"Discover\",\n      numberPattern: /^6(?:011|5[0-9]{2})[0-9]{12}$/\n    },\n    JCB: {\n      name: \"JCB\",\n      numberPattern: /^(?:2131|1800|35\\d{3})\\d{11}$/\n    }\n  };\n\n  /**\n  * Validates string for a number\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function isDigit(string) {\n    return (/^\\d+$/).test(string);\n  }\n\n  /**\n  * Validates string for credit card cvv\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function isValidCVV(string) {\n    return (/^\\d{3,4}$/).test(string);\n  }\n\n  /**\n  * Validates string for a valid month [MM]\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function isValidMonth(string) {\n    return (/^(0?[1-9]|1[0-2])$/).test(string);\n  }\n\n  /**\n  * Validates string for a valid year [YYYY]\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function isValidYear(string) {\n    return (/^[1-9]\\d{3,}$/).test(string);\n  }\n\n\n  // @TODO: This will be removed when Neue's validation gets refactored.\n  function validateNotBlank(string, done, success, failure) {\n    if( string !== \"\" ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  // @TODO: This will be removed when Neue's validation gets refactored.\n  function validateDigit(string, done, success, failure) {\n    if( isDigit(string) ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  /**\n  * Validates string for a valid credit card number\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function validateCreditCardNumber(string, done, success, failure) {\n    var found = null;\n    for (var key in cardTypes) {\n      var card = cardTypes[key];\n      if (card.numberPattern.test(string)) {\n        found = card;\n      }\n    }\n    if (found) {\n      return done({\n        success: true,\n        message: found.name + \" \" + success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  /**\n  * Validates string for a valid cvv\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function validateCvv(string, done, success, failure) {\n    if ( isValidCVV(string) ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  /**\n  * Validates string for a valid expiration month\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function validateExpMonth(string, done, success, failure) {\n    if ( isValidMonth(string)) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  /**\n  * Validates string for a valid expiration year\n  *\n  * @param {String}   string  String to be test against regex\n  * @return {boolean}\n  */\n  function validateExpYear(string, done, success, failure) {\n    if ( isValidYear(string) ) {\n      return done({\n        success: true,\n        message: success\n      });\n    } else {\n      return done({\n        success: false,\n        message: failure\n      });\n    }\n  }\n\n  // # Add validation functions...\n\n  Validation.registerValidationFunction(\"full_name\", function(string, done) {\n    validateNotBlank(string, done,\n      Drupal.t(\"Hey, @name!\", {\"@name\": string}),\n      Drupal.t(\"We need your full name.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"cc_num\", function(string, done) {\n    validateCreditCardNumber(string, done,\n      Drupal.t(\"number looks good!\"),\n      Drupal.t(\"Invalid credit card number.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"cvv\", function(string, done) {\n    validateCvv(string, done,\n      Drupal.t(\"CVV looks good!\"),\n      Drupal.t(\"Invalid CVV.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"exp_month\", function(string, done) {\n    validateExpMonth(string, done,\n      Drupal.t(\"Good Month!\"),\n      Drupal.t(\"Invalid Month.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"exp_year\", function(string, done) {\n    validateExpYear(string, done,\n      Drupal.t(\"Good Year!\"),\n      Drupal.t(\"Invalid Year.\")\n    );\n  });\n\n  Validation.registerValidationFunction(\"amount\", function(string, done) {\n    validateDigit(string, done,\n      Drupal.t(\"So Generous!\"),\n      Drupal.t(\"Invalid Amount.\")\n    );\n  });\n\n});\n\n","/**\n * @module Analytics\n * Uses Google Analytics custom events API to fire events for client-side\n * Modal and Form Validation flows.\n */\ndefine('Analytics',[\"validation\", \"modal\"], function(Validation, Modal) {\n  \"use strict\";\n\n  // We'll only fire GA Custom Events if the GA object exists\n  if(typeof(ga) !== \"undefined\" && ga !== null) {\n    // Validation\n    Validation.Events.subscribe(\"Validation:InlineError\", function(topic, args) {\n      ga(\"send\", \"event\", \"Form\", \"Inline Validation Error\", args);\n    });\n\n    Validation.Events.subscribe(\"Validation:Suggestion\", function(topic, args) {\n      ga(\"send\", \"event\", \"Form\", \"Suggestion\", args);\n    });\n\n    Validation.Events.subscribe(\"Validation:SuggestionUsed\", function(topic, args) {\n      ga(\"send\", \"event\", \"Form\", \"Suggestion Used\", args);\n    });\n\n    Validation.Events.subscribe(\"Validation:Submitted\", function(topic, args) {\n      ga(\"send\", \"event\", \"Form\", \"Submitted\", args);\n    });\n\n    Validation.Events.subscribe(\"Validation:SubmitError\", function(topic, args) {\n      ga(\"send\", \"event\", \"Form\", \"Validation Error on submit\", args);\n    });\n\n    // Modals\n    Modal.Events.subscribe(\"Modal:Open\", function(topic, args) {\n      var label = args !== null ? \"#\" + args.attr(\"id\") : \"\";\n      ga(\"send\", \"event\", \"Modal\", \"Open\", label);\n    });\n\n    Modal.Events.subscribe(\"Modal:Close\", function(topic, args) {\n      var label = args !== null ? \"#\" + args.attr(\"id\") : \"\";\n      ga(\"send\", \"event\", \"Modal\", \"Close\", label);\n    });\n  }\n\n});\n\n","define('tiles',['require','jquery'],function(require) {\n  \"use strict\";\n\n  var $ = require(\"jquery\");\n\n  // Lazy-load in tile images\n  $(\".tile\").find(\"img\").unveil(200, function() {\n    $(this).load(function() {\n      this.style.opacity = 1;\n    });\n  });\n\n\n  /**\n   * This is a temporary fix until the next Neue release!\n   * @TODO: Remove when Neue 6.0.0-beta5 is merged in!\n   *\n   * Replace the `video` tag in a tile with a static image, based on either the `poster`\n   * attribute of the video, or an included `img` fallback source.\n   */\n  function replaceVideoWithImage() {\n    var poster = $(this).find('img').attr('src') || $(this).attr('poster');\n    $(this).replaceWith($(\"<img>\").attr('src', poster));\n  }\n\n  // On Mobile Safari, we need to replace `<video>` with a static image so the \"play\" control does not appear.\n  // Yes, this is browser sniffing - but we're fixing a browser-specific quirk so I don't think it's evil.\n  if (window.navigator.userAgent.match(/iPad/i) || window.navigator.userAgent.match(/iPhone/i)) {\n    $(function() {\n      $(\".tile video\").each(replaceVideoWithImage);\n    });\n  }\n\n});\n\n"]}